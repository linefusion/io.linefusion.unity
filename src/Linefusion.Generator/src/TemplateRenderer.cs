using Linefusion.Generator.IO;

using Microsoft.CodeAnalysis;
using Microsoft.CodeAnalysis.CSharp.Syntax;

using Scriban;
using Scriban.Runtime;

namespace Linefusion.Generator
{
    public class TemplateRenderer
    {
        private string liquid = "IWZ1bmN0aW9uKGUsdCl7Im9iamVjdCI9PXR5cGVvZiBleHBvcnRzJiYidW5kZWZpbmVkIiE9dHlwZW9mIG1vZHVsZT90KGV4cG9ydHMpOiJmdW5jdGlvbiI9PXR5cGVvZiBkZWZpbmUmJmRlZmluZS5hbWQ/ZGVmaW5lKFsiZXhwb3J0cyJdLHQpOnQoKGU9ZXx8c2VsZikubGlxdWlkanM9e30pfSh0aGlzLGZ1bmN0aW9uKGwpeyJ1c2Ugc3RyaWN0Ijt2YXIgTT1mdW5jdGlvbihlLHQpe3JldHVybihNPU9iamVjdC5zZXRQcm90b3R5cGVPZnx8KHtfX3Byb3RvX186W119aW5zdGFuY2VvZiBBcnJheT9mdW5jdGlvbihlLHQpe2UuX19wcm90b19fPXR9OmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciByIGluIHQpT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHQscikmJihlW3JdPXRbcl0pfSkpKGUsdCl9O2Z1bmN0aW9uIHMoZSx0KXtpZigiZnVuY3Rpb24iIT10eXBlb2YgdCYmbnVsbCE9PXQpdGhyb3cgbmV3IFR5cGVFcnJvcigiQ2xhc3MgZXh0ZW5kcyB2YWx1ZSAiK1N0cmluZyh0KSsiIGlzIG5vdCBhIGNvbnN0cnVjdG9yIG9yIG51bGwiKTtmdW5jdGlvbiByKCl7dGhpcy5jb25zdHJ1Y3Rvcj1lfU0oZSx0KSxlLnByb3RvdHlwZT1udWxsPT09dD9PYmplY3QuY3JlYXRlKHQpOihyLnByb3RvdHlwZT10LnByb3RvdHlwZSxuZXcgcil9dmFyIFQ9ZnVuY3Rpb24oKXtyZXR1cm4oVD1PYmplY3QuYXNzaWdufHxmdW5jdGlvbihlKXtmb3IodmFyIHQscj0xLG49YXJndW1lbnRzLmxlbmd0aDtyPG47cisrKWZvcih2YXIgaSBpbiB0PWFyZ3VtZW50c1tyXSlPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxpKSYmKGVbaV09dFtpXSk7cmV0dXJuIGV9KS5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2Z1bmN0aW9uIGEoZSxvLGEsdSl7cmV0dXJuIG5ldyhhPWF8fFByb21pc2UpKGZ1bmN0aW9uKHIsdCl7ZnVuY3Rpb24gbihlKXt0cnl7cyh1Lm5leHQoZSkpfWNhdGNoKGUpe3QoZSl9fWZ1bmN0aW9uIGkoZSl7dHJ5e3ModS50aHJvdyhlKSl9Y2F0Y2goZSl7dChlKX19ZnVuY3Rpb24gcyhlKXt2YXIgdDtlLmRvbmU/cihlLnZhbHVlKTooKHQ9ZS52YWx1ZSlpbnN0YW5jZW9mIGE/dDpuZXcgYShmdW5jdGlvbihlKXtlKHQpfSkpLnRoZW4obixpKX1zKCh1PXUuYXBwbHkoZSxvfHxbXSkpLm5leHQoKSl9KX1mdW5jdGlvbiB4KG4saSl7dmFyIHMsbyxhLHU9e2xhYmVsOjAsc2VudDpmdW5jdGlvbigpe2lmKDEmYVswXSl0aHJvdyBhWzFdO3JldHVybiBhWzFdfSx0cnlzOltdLG9wczpbXX0sYz17bmV4dDplKDApLHRocm93OmUoMSkscmV0dXJuOmUoMil9O3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJihjW1N5bWJvbC5pdGVyYXRvcl09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpc30pLGM7ZnVuY3Rpb24gZShyKXtyZXR1cm4gZnVuY3Rpb24oZSl7dmFyIHQ9W3IsZV07aWYocyl0aHJvdyBuZXcgVHlwZUVycm9yKCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuIik7Zm9yKDt1PWMmJnRbYz0wXT8wOnU7KXRyeXtpZihzPTEsbyYmKGE9MiZ0WzBdP28ucmV0dXJuOnRbMF0/by50aHJvd3x8KChhPW8ucmV0dXJuKSYmYS5jYWxsKG8pLDApOm8ubmV4dCkmJiEoYT1hLmNhbGwobyx0WzFdKSkuZG9uZSlyZXR1cm4gYTtzd2l0Y2gobz0wLCh0PWE/WzImdFswXSxhLnZhbHVlXTp0KVswXSl7Y2FzZSAwOmNhc2UgMTphPXQ7YnJlYWs7Y2FzZSA0OnJldHVybiB1LmxhYmVsKysse3ZhbHVlOnRbMV0sZG9uZTohMX07Y2FzZSA1OnUubGFiZWwrKyxvPXRbMV0sdD1bMF07Y29udGludWU7Y2FzZSA3OnQ9dS5vcHMucG9wKCksdS50cnlzLnBvcCgpO2NvbnRpbnVlO2RlZmF1bHQ6aWYoIShhPTA8KGE9dS50cnlzKS5sZW5ndGgmJmFbYS5sZW5ndGgtMV0pJiYoNj09PXRbMF18fDI9PT10WzBdKSl7dT0wO2NvbnRpbnVlfWlmKDM9PT10WzBdJiYoIWF8fHRbMV0+YVswXSYmdFsxXTxhWzNdKSl1LmxhYmVsPXRbMV07ZWxzZSBpZig2PT09dFswXSYmdS5sYWJlbDxhWzFdKXUubGFiZWw9YVsxXSxhPXQ7ZWxzZXtpZighKGEmJnUubGFiZWw8YVsyXSkpe2FbMl0mJnUub3BzLnBvcCgpLHUudHJ5cy5wb3AoKTtjb250aW51ZX11LmxhYmVsPWFbMl0sdS5vcHMucHVzaCh0KX19dD1pLmNhbGwobix1KX1jYXRjaChlKXt0PVs2LGVdLG89MH1maW5hbGx5e3M9YT0wfWlmKDUmdFswXSl0aHJvdyB0WzFdO3JldHVybnt2YWx1ZTp0WzBdP3RbMV06dm9pZCAwLGRvbmU6ITB9fX19ZnVuY3Rpb24gTyhlKXt2YXIgdD0iZnVuY3Rpb24iPT10eXBlb2YgU3ltYm9sJiZTeW1ib2wuaXRlcmF0b3Iscj10JiZlW3RdLG49MDtpZihyKXJldHVybiByLmNhbGwoZSk7aWYoZSYmIm51bWJlciI9PXR5cGVvZiBlLmxlbmd0aClyZXR1cm57bmV4dDpmdW5jdGlvbigpe3JldHVybnt2YWx1ZTooZT1lJiZuPj1lLmxlbmd0aD92b2lkIDA6ZSkmJmVbbisrXSxkb25lOiFlfX19O3Rocm93IG5ldyBUeXBlRXJyb3IodD8iT2JqZWN0IGlzIG5vdCBpdGVyYWJsZS4iOiJTeW1ib2wuaXRlcmF0b3IgaXMgbm90IGRlZmluZWQuIil9ZnVuY3Rpb24gZChlLHQpe3ZhciByPSJmdW5jdGlvbiI9PXR5cGVvZiBTeW1ib2wmJmVbU3ltYm9sLml0ZXJhdG9yXTtpZighcilyZXR1cm4gZTt2YXIgbixpLHM9ci5jYWxsKGUpLG89W107dHJ5e2Zvcig7KHZvaWQgMD09PXR8fDA8dC0tKSYmIShuPXMubmV4dCgpKS5kb25lOylvLnB1c2gobi52YWx1ZSl9Y2F0Y2goZSl7aT17ZXJyb3I6ZX19ZmluYWxseXt0cnl7biYmIW4uZG9uZSYmKHI9cy5yZXR1cm4pJiZyLmNhbGwocyl9ZmluYWxseXtpZihpKXRocm93IGkuZXJyb3J9fXJldHVybiBvfWZ1bmN0aW9uIHYoZSx0LHIpe2lmKHJ8fDI9PT1hcmd1bWVudHMubGVuZ3RoKWZvcih2YXIgbixpPTAscz10Lmxlbmd0aDtpPHM7aSsrKSFuJiZpIGluIHR8fCgobj1ufHxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0LDAsaSkpW2ldPXRbaV0pO3JldHVybiBlLmNvbmNhdChufHxBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCh0KSl9UC5wcm90b3R5cGUuZ2V0VGV4dD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmlucHV0LnNsaWNlKHRoaXMuYmVnaW4sdGhpcy5lbmQpfSxQLnByb3RvdHlwZS5nZXRQb3NpdGlvbj1mdW5jdGlvbigpe2Zvcih2YXIgZT1kKFsxLDFdLDIpLHQ9ZVswXSxyPWVbMV0sbj0wO248dGhpcy5iZWdpbjtuKyspIlxuIj09PXRoaXMuaW5wdXRbbl0/KHQrKyxyPTEpOnIrKztyZXR1cm5bdCxyXX0sUC5wcm90b3R5cGUuc2l6ZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmVuZC10aGlzLmJlZ2lufTt2YXIgZT1QO2Z1bmN0aW9uIFAoZSx0LHIsbixpKXt0aGlzLmtpbmQ9ZSx0aGlzLmlucHV0PXQsdGhpcy5iZWdpbj1yLHRoaXMuZW5kPW4sdGhpcy5maWxlPWl9Vi5wcm90b3R5cGUubGlxdWlkTWV0aG9kTWlzc2luZz1mdW5jdGlvbihlKXt9O3ZhciBvPVY7ZnVuY3Rpb24gVigpe312YXIgQT1PYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLEk9U3RyaW5nLnByb3RvdHlwZS50b0xvd2VyQ2FzZSxCPU9iamVjdC5oYXNPd25Qcm9wZXJ0eTtmdW5jdGlvbiB1KGUpe3JldHVybiJzdHJpbmciPT10eXBlb2YgZX1mdW5jdGlvbiBjKGUpe3JldHVybiJmdW5jdGlvbiI9PXR5cGVvZiBlfWZ1bmN0aW9uIEMoZSl7cmV0dXJuIGUmJmMoZS5uZXh0KSYmYyhlLnRocm93KSYmYyhlLnJldHVybil9ZnVuY3Rpb24gZihlKXtyZXR1cm4gdShlPXkoZSkpP2U6aChlKT8iIjpnKGUpP2UubWFwKGYpLmpvaW4oIiIpOlN0cmluZyhlKX1mdW5jdGlvbiB5KGUpe3JldHVybiBlIGluc3RhbmNlb2YgbyYmYyhlLnZhbHVlT2YpP2UudmFsdWVPZigpOmV9ZnVuY3Rpb24gSChlKXtyZXR1cm4ibnVtYmVyIj09dHlwZW9mIGV9ZnVuY3Rpb24gaChlKXtyZXR1cm4gbnVsbD09ZX1mdW5jdGlvbiBnKGUpe3JldHVybiJbb2JqZWN0IEFycmF5XSI9PT1BLmNhbGwoZSl9ZnVuY3Rpb24gSyhlLHQpe2Zvcih2YXIgciBpbiBlPWV8fHt9KWlmKEIuY2FsbChlLHIpJiYhMT09PXQoZVtyXSxyLGUpKWJyZWFrfWZ1bmN0aW9uIFUoZSl7cmV0dXJuIGVbZS5sZW5ndGgtMV19ZnVuY3Rpb24gJChlKXt2YXIgdD10eXBlb2YgZTtyZXR1cm4gbnVsbCE9PWUmJigib2JqZWN0Ij09dHx8ImZ1bmN0aW9uIj09dCl9ZnVuY3Rpb24gUShlLHQscil7dm9pZCAwPT09ciYmKHI9MSk7Zm9yKHZhciBuPVtdLGk9ZTtpPHQ7aSs9ciluLnB1c2goaSk7cmV0dXJuIG59ZnVuY3Rpb24gVyhlLHQscil7cmV0dXJuIFkoZSx0LHI9dm9pZCAwPT09cj8iICI6cixmdW5jdGlvbihlLHQpe3JldHVybiB0K2V9KX1mdW5jdGlvbiBZKGUsdCxyLG4pe2Zvcih2YXIgaT10LShlPVN0cmluZyhlKSkubGVuZ3RoOzA8aS0tOyllPW4oZSxyKTtyZXR1cm4gZX1mdW5jdGlvbiBKKGUpe3JldHVybiBlfWZ1bmN0aW9uIFooZSx0KXtyZXR1cm4gbnVsbD09ZSYmbnVsbD09dD8wOm51bGw9PWU/MTpudWxsPT10fHwoZT1JLmNhbGwoZSkpPCh0PUkuY2FsbCh0KSk/LTE6dDxlPzE6MH1mdW5jdGlvbiB0KHIpe3JldHVybiBmdW5jdGlvbigpe2Zvcih2YXIgZT1bXSx0PTA7dDxhcmd1bWVudHMubGVuZ3RoO3QrKyllW3RdPWFyZ3VtZW50c1t0XTtyZXR1cm4gci5hcHBseSh2b2lkIDAsdihbXSxkKGUubWFwKHkpKSwhMSkpfX1mdW5jdGlvbiBHKGUpe3JldHVybiBlLnJlcGxhY2UoL1stW1xde30oKSorPy4sXFxeJHwjXHNdL2csIlxcJCYiKX12YXIgWCxlZT0iX19saXF1aWRDbGFzc19fIix0ZT0ocyhyZSxYPUVycm9yKSxyZS5wcm90b3R5cGUudXBkYXRlPWZ1bmN0aW9uKCl7dmFyIG4saSxzLG8sZSx0LHI7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsImNvbnRleHQiLHt2YWx1ZTooZT10aGlzLnRva2VuLHQ9ZChlLmdldFBvc2l0aW9uKCksMiksbj10WzBdLGk9dFsxXSxzPWUuaW5wdXQuc3BsaXQoIlxuIiksdD1NYXRoLm1heChuLTIsMSksbz1NYXRoLm1pbihuKzMscy5sZW5ndGgpLFEodCxvKzEpLm1hcChmdW5jdGlvbihlKXt2YXIgdD1lPT09bj8iPj4gIjoiICAgIixyPVcoU3RyaW5nKGUpLFN0cmluZyhvKS5sZW5ndGgpLHQ9IiIuY29uY2F0KHQpLmNvbmNhdChyLCJ8ICIpLHI9ZT09PW4/IlxuIitXKCJeIixpK3QubGVuZ3RoKToiIjtyZXR1cm4gdCtzW2UtMV0rcn0pLmpvaW4oIlxuIikpLGVudW1lcmFibGU6ITF9KSx0aGlzLm1lc3NhZ2U9KGU9dGhpcy5tZXNzYWdlLCh0PXRoaXMudG9rZW4pLmZpbGUmJihlKz0iLCBmaWxlOiIuY29uY2F0KHQuZmlsZSkpLHQ9ZCh0LmdldFBvc2l0aW9uKCksMikscj10WzBdLHQ9dFsxXSxlKz0iLCBsaW5lOiIuY29uY2F0KHIsIiwgY29sOiIpLmNvbmNhdCh0KSksdGhpcy5zdGFjaz10aGlzLm1lc3NhZ2UrIlxuIit0aGlzLmNvbnRleHQrIlxuIit0aGlzLnN0YWNrLHRoaXMub3JpZ2luYWxFcnJvciYmKHRoaXMuc3RhY2srPSJcbkZyb20gIit0aGlzLm9yaWdpbmFsRXJyb3Iuc3RhY2spfSxyZS5pcz1mdW5jdGlvbihlKXtyZXR1cm4iTGlxdWlkRXJyb3IiPT09KG51bGw9PWU/dm9pZCAwOmVbZWVdKX0scmUpO2Z1bmN0aW9uIHJlKGUsdCl7dmFyIHI9WC5jYWxsKHRoaXMsInN0cmluZyI9PXR5cGVvZiBlP2U6ZS5tZXNzYWdlKXx8dGhpcztyZXR1cm4gci5jb250ZXh0PSIiLCJzdHJpbmciIT10eXBlb2YgZSYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHIsIm9yaWdpbmFsRXJyb3IiLHt2YWx1ZTplLGVudW1lcmFibGU6ITF9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkociwidG9rZW4iLHt2YWx1ZTp0LGVudW1lcmFibGU6ITF9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkocixlZSx7dmFsdWU6IkxpcXVpZEVycm9yIixlbnVtZXJhYmxlOiExfSkscn1zKHNlLG5lPXRlKTt2YXIgbmUsaWU9c2U7ZnVuY3Rpb24gc2UoZSx0KXtlPW5lLmNhbGwodGhpcyxlLHQpfHx0aGlzO3JldHVybiBlLm5hbWU9IlRva2VuaXphdGlvbkVycm9yIixuZS5wcm90b3R5cGUudXBkYXRlLmNhbGwoZSksZX1zKHVlLG9lPXRlKTt2YXIgb2UsYWU9dWU7ZnVuY3Rpb24gdWUoZSx0KXt0PW9lLmNhbGwodGhpcyxlLHQpfHx0aGlzO3JldHVybiB0Lm5hbWU9IlBhcnNlRXJyb3IiLHQubWVzc2FnZT1lLm1lc3NhZ2Usb2UucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHQpLHR9cyhoZSxjZT10ZSksaGUuaXM9ZnVuY3Rpb24oZSl7cmV0dXJuIlJlbmRlckVycm9yIj09PWUubmFtZX07dmFyIGNlLGxlPWhlO2Z1bmN0aW9uIGhlKGUsdCl7dD1jZS5jYWxsKHRoaXMsZSx0LnRva2VuKXx8dGhpcztyZXR1cm4gdC5uYW1lPSJSZW5kZXJFcnJvciIsdC5tZXNzYWdlPWUubWVzc2FnZSxjZS5wcm90b3R5cGUudXBkYXRlLmNhbGwodCksdH1zKGRlLHBlPXRlKTt2YXIgcGUsZmU9ZGU7ZnVuY3Rpb24gZGUoZSx0KXt0PXBlLmNhbGwodGhpcyxlLHQpfHx0aGlzO3JldHVybiB0Lm5hbWU9IlVuZGVmaW5lZFZhcmlhYmxlRXJyb3IiLHQubWVzc2FnZT1lLm1lc3NhZ2UscGUucHJvdG90eXBlLnVwZGF0ZS5jYWxsKHQpLHR9cyh5ZSx2ZT1FcnJvcik7dmFyIHZlLGdlPXllO2Z1bmN0aW9uIHllKGUpe3ZhciB0PXZlLmNhbGwodGhpcywidW5kZWZpbmVkIHZhcmlhYmxlOiAiLmNvbmNhdChlKSl8fHRoaXM7cmV0dXJuIHQubmFtZT0iSW50ZXJuYWxVbmRlZmluZWRWYXJpYWJsZUVycm9yIix0LnZhcmlhYmxlTmFtZT1lLHR9cyh3ZSxtZT1FcnJvcik7dmFyIG1lLGJlPXdlO2Z1bmN0aW9uIHdlKGUpe3ZhciB0PW1lLmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gdC5uYW1lPSJBc3NlcnRpb25FcnJvciIsdC5tZXNzYWdlPWUrIiIsdH12YXIgcD1bMCwwLDAsMCwwLDAsMCwwLDAsMjAsNCw0LDQsMjAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMCwwLDAsMjAsMiw4LDAsMCwwLDAsOCwwLDAsMCw2NCwwLDY1LDAsMCwzMywzMywzMywzMywzMywzMywzMywzMywzMywzMywwLDAsMiwyLDIsMSwwLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwwLDAsMCwwLDEsMCwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMSwxLDEsMCwwLDAsMCwwXSxrZT0xLFRlPTQseGU9MTY7ZnVuY3Rpb24gT2UoZSl7ZT1lLmNoYXJDb2RlQXQoMCk7cmV0dXJuIDEyODw9ZT8hcFtlXTpwW2VdJmtlfWZ1bmN0aW9uIF8oZSx0KXtpZighZSl0aHJvdyB0PSJmdW5jdGlvbiI9PXR5cGVvZiB0P3QoKTp0fHwiZXhwZWN0ICIuY29uY2F0KGUsIiB0byBiZSB0cnVlIiksbmV3IGJlKHQpfXBbMTYwXT1wWzU3NjBdPXBbNjE1OF09cFs4MTkyXT1wWzgxOTNdPXBbODE5NF09cFs4MTk1XT1wWzgxOTZdPXBbODE5N109cFs4MTk4XT1wWzgxOTldPXBbODIwMF09cFs4MjAxXT1wWzgyMDJdPXBbODIzMl09cFs4MjMzXT1wWzgyMzldPXBbODI4N109cFsxMjI4OF09VGUscFs4MjIwXT1wWzgyMjFdPTEyODtzKHplLF9lPW8pLHplLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIGgoeShlKSl9LHplLnByb3RvdHlwZS5ndD1mdW5jdGlvbigpe3JldHVybiExfSx6ZS5wcm90b3R5cGUuZ2VxPWZ1bmN0aW9uKCl7cmV0dXJuITF9LHplLnByb3RvdHlwZS5sdD1mdW5jdGlvbigpe3JldHVybiExfSx6ZS5wcm90b3R5cGUubGVxPWZ1bmN0aW9uKCl7cmV0dXJuITF9LHplLnByb3RvdHlwZS52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIG51bGx9O3ZhciBfZSxyPXplO2Z1bmN0aW9uIHplKCl7cmV0dXJuIG51bGwhPT1fZSYmX2UuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXMobixTZT1vKSxuLnByb3RvdHlwZS5lcXVhbHM9ZnVuY3Rpb24oZSl7cmV0dXJuIShlIGluc3RhbmNlb2Ygbnx8KHUoZT15KGUpKXx8ZyhlKT8wIT09ZS5sZW5ndGg6ISQoZSl8fDAhPT1PYmplY3Qua2V5cyhlKS5sZW5ndGgpKX0sbi5wcm90b3R5cGUuZ3Q9ZnVuY3Rpb24oKXtyZXR1cm4hMX0sbi5wcm90b3R5cGUuZ2VxPWZ1bmN0aW9uKCl7cmV0dXJuITF9LG4ucHJvdG90eXBlLmx0PWZ1bmN0aW9uKCl7cmV0dXJuITF9LG4ucHJvdG90eXBlLmxlcT1mdW5jdGlvbigpe3JldHVybiExfSxuLnByb3RvdHlwZS52YWx1ZU9mPWZ1bmN0aW9uKCl7cmV0dXJuIiJ9O3ZhciBTZSxSZT1uO2Z1bmN0aW9uIG4oKXtyZXR1cm4gbnVsbCE9PVNlJiZTZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cyhxZSxGZT1SZSkscWUucHJvdG90eXBlLmVxdWFscz1mdW5jdGlvbihlKXtyZXR1cm4hMT09PWV8fCEhaCh5KGUpKXx8KHUoZSk/L15ccyokLy50ZXN0KGUpOkZlLnByb3RvdHlwZS5lcXVhbHMuY2FsbCh0aGlzLGUpKX07dmFyIEZlLGk9cWU7ZnVuY3Rpb24gcWUoKXtyZXR1cm4gbnVsbCE9PUZlJiZGZS5hcHBseSh0aGlzLGFyZ3VtZW50cyl8fHRoaXN9cyhtLExlPW8pLG0ucHJvdG90eXBlLm5leHQ9ZnVuY3Rpb24oKXt0aGlzLmkrK30sbS5wcm90b3R5cGUuaW5kZXgwPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaX0sbS5wcm90b3R5cGUuaW5kZXg9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pKzF9LG0ucHJvdG90eXBlLmZpcnN0PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLml9LG0ucHJvdG90eXBlLmxhc3Q9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pPT09dGhpcy5sZW5ndGgtMX0sbS5wcm90b3R5cGUucmluZGV4PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGVuZ3RoLXRoaXMuaX0sbS5wcm90b3R5cGUucmluZGV4MD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmxlbmd0aC10aGlzLmktMX0sbS5wcm90b3R5cGUudmFsdWVPZj1mdW5jdGlvbigpe3JldHVybiBKU09OLnN0cmluZ2lmeSh0aGlzKX07dmFyIExlLEVlPW07ZnVuY3Rpb24gbShlLHQscil7dmFyIG49TGUuY2FsbCh0aGlzKXx8dGhpcztyZXR1cm4gbi5pPTAsbi5sZW5ndGg9ZSxuLm5hbWU9IiIuY29uY2F0KHIsIi0iKS5jb25jYXQodCksbn1zKGplLERlPW8pLGplLnByb3RvdHlwZS5zdXBlcj1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN1cGVyQmxvY2tSZW5kZXIoKX07dmFyIERlLE5lPWplO2Z1bmN0aW9uIGplKGUpe3ZvaWQgMD09PWUmJihlPWZ1bmN0aW9uKCl7cmV0dXJuIiJ9KTt2YXIgdD1EZS5jYWxsKHRoaXMpfHx0aGlzO3JldHVybiB0LnN1cGVyQmxvY2tSZW5kZXI9ZSx0fWZ1bmN0aW9uIGIoZSl7cmV0dXJuIGUmJmMoZS5lcXVhbHMpfXZhciByPW5ldyByLE1lPXt0cnVlOiEwLGZhbHNlOiExLG5pbDpyLG51bGw6cixlbXB0eTpuZXcgUmUsYmxhbms6bmV3IGl9O2Z1bmN0aW9uIFBlKGUpe3ZhciB0LHIsbj17fTt0cnl7Zm9yKHZhciBpPU8oT2JqZWN0LmVudHJpZXMoZSkpLHM9aS5uZXh0KCk7IXMuZG9uZTtzPWkubmV4dCgpKXtmb3IodmFyIG89ZChzLnZhbHVlLDIpLGE9b1swXSx1PW9bMV0sYz1uLGw9MDtsPGEubGVuZ3RoO2wrKyl7dmFyIGg9YVtsXTtjW2hdPWNbaF18fHt9LGw9PT1hLmxlbmd0aC0xJiZPZShhW2xdKSYmKGNbaF0ubmVlZEJvdW5kYXJ5PSEwKSxjPWNbaF19Yy5kYXRhPXUsYy5lbmQ9ITB9fWNhdGNoKGUpe3Q9e2Vycm9yOmV9fWZpbmFsbHl7dHJ5e3MmJiFzLmRvbmUmJihyPWkucmV0dXJuKSYmci5jYWxsKGkpfWZpbmFsbHl7aWYodCl0aHJvdyB0LmVycm9yfX1yZXR1cm4gbn1mdW5jdGlvbiB3KG8pe3JldHVybiBhKHRoaXMsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe3ZhciByLG4saSxzO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDppZighQyhvKSlyZXR1cm5bMixvXTtuPSExLGk9Im5leHQiLGUubGFiZWw9MTtjYXNlIDE6cz1vW2ldKHIpLG49cy5kb25lLHI9cy52YWx1ZSxpPSJuZXh0IixlLmxhYmVsPTI7Y2FzZSAyOnJldHVybihlLnRyeXMucHVzaChbMiw1LCw2XSksQyhyKSYmKHI9dyhyKSksKHQ9cikmJmModC50aGVuKSk/WzQscl06WzMsNF07Y2FzZSAzOnI9ZS5zZW50KCksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm5bMyw2XTtjYXNlIDU6cmV0dXJuIHM9ZS5zZW50KCksaT0idGhyb3ciLHI9cyxbMyw2XTtjYXNlIDY6aWYoIW4pcmV0dXJuWzMsMV07ZS5sYWJlbD03O2Nhc2UgNzpyZXR1cm5bMixyXX12YXIgdH0pfSl9ZnVuY3Rpb24gayhlKXtpZighQyhlKSlyZXR1cm4gZTt2YXIgdD0ibmV4dCI7ZG97dmFyIHIsbj1lW3RdKHIpLGk9bi5kb25lLHQ9Im5leHQiO2lmKEMocj1uLnZhbHVlKSl0cnl7cj1rKHIpfWNhdGNoKGUpe3Q9InRocm93IixyPWV9fXdoaWxlKCFpKTtyZXR1cm4gcn1mdW5jdGlvbiBWZSh0KXt2YXIgZTtyZXR1cm4gZyh0PXkodCkpP3Q6dSh0KSYmMDx0Lmxlbmd0aD9bdF06JChlPXQpJiZTeW1ib2wuaXRlcmF0b3IgaW4gZT9BcnJheS5mcm9tKHQpOiQodCk/T2JqZWN0LmtleXModCkubWFwKGZ1bmN0aW9uKGUpe3JldHVybltlLHRbZV1dfSk6W119ZnVuY3Rpb24geihlKXtyZXR1cm4gaChlKT9bXTpnKGUpP2U6W2VdfXZhciBBZT0vJShbLV8wXiM6XSspPyhcZCspPyhbRU9dKT8oLikvLEllPVsiSmFudWFyeSIsIkZlYnJ1YXJ5IiwiTWFyY2giLCJBcHJpbCIsIk1heSIsIkp1bmUiLCJKdWx5IiwiQXVndXN0IiwiU2VwdGVtYmVyIiwiT2N0b2JlciIsIk5vdmVtYmVyIiwiRGVjZW1iZXIiXSxCZT1bIlN1bmRheSIsIk1vbmRheSIsIlR1ZXNkYXkiLCJXZWRuZXNkYXkiLCJUaHVyc2RheSIsIkZyaWRheSIsIlNhdHVyZGF5Il0sQ2U9SWUubWFwKEtlKSxIZT1CZS5tYXAoS2UpO2Z1bmN0aW9uIEtlKGUpe3JldHVybiBlLnNsaWNlKDAsMyl9ZnVuY3Rpb24gVWUoZSl7cmV0dXJuWzMxLGZ1bmN0aW9uKGUpe2U9ZS5nZXRGdWxsWWVhcigpO3JldHVybiAwPT0oMyZlKSYmKGUlMTAwfHxlJTQwMD09MCYmZSl9KGUpPzI5OjI4LDMxLDMwLDMxLDMwLDMxLDMxLDMwLDMxLDMwLDMxXX1mdW5jdGlvbiAkZShlKXtmb3IodmFyIHQ9MCxyPTA7cjxlLmdldE1vbnRoKCk7KytyKXQrPVVlKGUpW3JdO3JldHVybiB0K2UuZ2V0RGF0ZSgpfWZ1bmN0aW9uIFFlKGUsdCl7dmFyIHI9JGUoZSkrKHQtZS5nZXREYXkoKSksZT03LW5ldyBEYXRlKGUuZ2V0RnVsbFllYXIoKSwwLDEpLmdldERheSgpK3Q7cmV0dXJuIFN0cmluZyhNYXRoLmZsb29yKChyLWUpLzcpKzEpfXZhciBXZT17ZDoyLGU6MixIOjIsSToyLGo6MyxrOjIsbDoyLEw6MyxtOjIsTToyLFM6MixVOjIsVzoyfSxZZT17YToiICIsQToiICIsYjoiICIsQjoiICIsYzoiICIsZToiICIsazoiICIsbDoiICIscDoiICIsUDoiICJ9LEplPXthOmZ1bmN0aW9uKGUpe3JldHVybiBIZVtlLmdldERheSgpXX0sQTpmdW5jdGlvbihlKXtyZXR1cm4gQmVbZS5nZXREYXkoKV19LGI6ZnVuY3Rpb24oZSl7cmV0dXJuIENlW2UuZ2V0TW9udGgoKV19LEI6ZnVuY3Rpb24oZSl7cmV0dXJuIEllW2UuZ2V0TW9udGgoKV19LGM6ZnVuY3Rpb24oZSl7cmV0dXJuIGUudG9Mb2NhbGVTdHJpbmcoKX0sQzpmdW5jdGlvbihlKXtyZXR1cm4gcGFyc2VJbnQoZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkuc3Vic3RyaW5nKDAsMiksMTApfSxkOmZ1bmN0aW9uKGUpe3JldHVybiBlLmdldERhdGUoKX0sZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXREYXRlKCl9LEg6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZ2V0SG91cnMoKX0sSTpmdW5jdGlvbihlKXtyZXR1cm4gU3RyaW5nKGUuZ2V0SG91cnMoKSUxMnx8MTIpfSxqOiRlLGs6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZ2V0SG91cnMoKX0sbDpmdW5jdGlvbihlKXtyZXR1cm4gU3RyaW5nKGUuZ2V0SG91cnMoKSUxMnx8MTIpfSxMOmZ1bmN0aW9uKGUpe3JldHVybiBlLmdldE1pbGxpc2Vjb25kcygpfSxtOmZ1bmN0aW9uKGUpe3JldHVybiBlLmdldE1vbnRoKCkrMX0sTTpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRNaW51dGVzKCl9LE46ZnVuY3Rpb24oZSx0KXt0PU51bWJlcih0LndpZHRoKXx8OTtyZXR1cm4gWShTdHJpbmcoZS5nZXRNaWxsaXNlY29uZHMoKSkuc2xpY2UoMCx0KSx0LGU9dm9pZCAwPT09KGU9IjAiKT8iICI6ZSxmdW5jdGlvbihlLHQpe3JldHVybiBlK3R9KX0scDpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRIb3VycygpPDEyPyJBTSI6IlBNIn0sUDpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRIb3VycygpPDEyPyJhbSI6InBtIn0scTpmdW5jdGlvbihlKXt2YXIgdD1lLmdldERhdGUoKSxyPSJ0aCI7c3dpdGNoKHQpe2Nhc2UgMTE6Y2FzZSAxMjpjYXNlIDEzOmJyZWFrO2RlZmF1bHQ6c3dpdGNoKHQlMTApe2Nhc2UgMTpyPSJzdCI7YnJlYWs7Y2FzZSAyOnI9Im5kIjticmVhaztjYXNlIDM6cj0icmQifX1yZXR1cm4gcn0sczpmdW5jdGlvbihlKXtyZXR1cm4gTWF0aC5yb3VuZChlLmdldFRpbWUoKS8xZTMpfSxTOmZ1bmN0aW9uKGUpe3JldHVybiBlLmdldFNlY29uZHMoKX0sdTpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXREYXkoKXx8N30sVTpmdW5jdGlvbihlKXtyZXR1cm4gUWUoZSwwKX0sdzpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXREYXkoKX0sVzpmdW5jdGlvbihlKXtyZXR1cm4gUWUoZSwxKX0seDpmdW5jdGlvbihlKXtyZXR1cm4gZS50b0xvY2FsZURhdGVTdHJpbmcoKX0sWDpmdW5jdGlvbihlKXtyZXR1cm4gZS50b0xvY2FsZVRpbWVTdHJpbmcoKX0seTpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRGdWxsWWVhcigpLnRvU3RyaW5nKCkuc2xpY2UoMiw0KX0sWTpmdW5jdGlvbihlKXtyZXR1cm4gZS5nZXRGdWxsWWVhcigpfSx6OmZ1bmN0aW9uKGUsdCl7dmFyIHI9TWF0aC5hYnMoZS5nZXRUaW1lem9uZU9mZnNldCgpKSxuPU1hdGguZmxvb3Ioci82MCkscj1yJTYwO3JldHVybigwPGUuZ2V0VGltZXpvbmVPZmZzZXQoKT8iLSI6IisiKStXKG4sMiwiMCIpKyh0LmZsYWdzWyI6Il0/IjoiOiIiKStXKHIsMiwiMCIpfSx0OmZ1bmN0aW9uKCl7cmV0dXJuIlx0In0sbjpmdW5jdGlvbigpe3JldHVybiJcbiJ9LCIlIjpmdW5jdGlvbigpe3JldHVybiIlIn19O2Z1bmN0aW9uIFplKGUsdCl7Zm9yKHZhciByLG49IiIsaT10O3I9QWUuZXhlYyhpKTspbis9aS5zbGljZSgwLHIuaW5kZXgpLGk9aS5zbGljZShyLmluZGV4K3JbMF0ubGVuZ3RoKSxuKz1mdW5jdGlvbihlLHQpe3ZhciByLHQ9ZCh0LDUpLG49dFswXSxpPXRbMV0saT12b2lkIDA9PT1pPyIiOmkscz10WzJdLG89dFszXSx0PXRbNF0sYT1KZVt0XTtpZighYSlyZXR1cm4gbjt2YXIgdT17fTt0cnl7Zm9yKHZhciBjPU8oaSksbD1jLm5leHQoKTshbC5kb25lO2w9Yy5uZXh0KCkpe3ZhciBoPWwudmFsdWU7dVtoXT0hMH19Y2F0Y2goZSl7cj17ZXJyb3I6ZX19ZmluYWxseXt0cnl7bCYmIWwuZG9uZSYmKHA9Yy5yZXR1cm4pJiZwLmNhbGwoYyl9ZmluYWxseXtpZihyKXRocm93IHIuZXJyb3J9fXZhciBuPVN0cmluZyhhKGUse2ZsYWdzOnUsd2lkdGg6cyxtb2RpZmllcjpvfSkpLGk9WWVbdF18fCIwIixwPXN8fFdlW3RdfHwwO3VbIl4iXT9uPW4udG9VcHBlckNhc2UoKTp1WyIjIl0mJihuPWZ1bmN0aW9uKGUpe3JldHVybiB2KFtdLGQoZSksITEpLnNvbWUoZnVuY3Rpb24oZSl7cmV0dXJuImEiPD1lJiZlPD0ieiJ9KT9lLnRvVXBwZXJDYXNlKCk6ZS50b0xvd2VyQ2FzZSgpfShuKSk7dS5fP2k9IiAiOnVbMF0mJihpPSIwIik7dVsiLSJdJiYocD0wKTtyZXR1cm4gVyhuLHAsaSl9KGUscik7cmV0dXJuIG4raX1KZS5oPUplLmI7dmFyIEdlPS8oW3paXXwoWystXSkoXGR7Mn0pOihcZHsyfSkpJC8sWGU9KFMucHJvdG90eXBlLmdldFRpbWU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5kaXNwbGF5RGF0ZS5nZXRUaW1lKCl9LFMucHJvdG90eXBlLmdldE1pbGxpc2Vjb25kcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLmdldE1pbGxpc2Vjb25kcygpfSxTLnByb3RvdHlwZS5nZXRTZWNvbmRzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheURhdGUuZ2V0U2Vjb25kcygpfSxTLnByb3RvdHlwZS5nZXRNaW51dGVzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheURhdGUuZ2V0TWludXRlcygpfSxTLnByb3RvdHlwZS5nZXRIb3Vycz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLmdldEhvdXJzKCl9LFMucHJvdG90eXBlLmdldERheT1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLmdldERheSgpfSxTLnByb3RvdHlwZS5nZXREYXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheURhdGUuZ2V0RGF0ZSgpfSxTLnByb3RvdHlwZS5nZXRNb250aD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLmdldE1vbnRoKCl9LFMucHJvdG90eXBlLmdldEZ1bGxZZWFyPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZGlzcGxheURhdGUuZ2V0RnVsbFllYXIoKX0sUy5wcm90b3R5cGUudG9Mb2NhbGVTdHJpbmc9ZnVuY3Rpb24oZSx0KXtyZXR1cm4obnVsbCE9dCYmdC50aW1lWm9uZT90aGlzLmRhdGU6dGhpcy5kaXNwbGF5RGF0ZSkudG9Mb2NhbGVTdHJpbmcoZSx0KX0sUy5wcm90b3R5cGUudG9Mb2NhbGVUaW1lU3RyaW5nPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLnRvTG9jYWxlVGltZVN0cmluZyhlKX0sUy5wcm90b3R5cGUudG9Mb2NhbGVEYXRlU3RyaW5nPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmRpc3BsYXlEYXRlLnRvTG9jYWxlRGF0ZVN0cmluZyhlKX0sUy5wcm90b3R5cGUuZ2V0VGltZXpvbmVPZmZzZXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aW1lem9uZU9mZnNldH0sUy5jcmVhdGVEYXRlRml4ZWRUb1RpbWV6b25lPWZ1bmN0aW9uKGUpe3ZhciB0LHIsbj1lLm1hdGNoKEdlKTtyZXR1cm4gbiYmIloiPT09blsxXT9uZXcgUygrbmV3IERhdGUoZSksMCk6biYmblsyXSYmblszXSYmbls0XT8ocj0obj1kKG4sNSkpWzJdLHQ9blszXSxuPW5bNF0scj0oIisiPT09cj8tMToxKSooNjAqcGFyc2VJbnQodCwxMCkrcGFyc2VJbnQobiwxMCkpLG5ldyBTKCtuZXcgRGF0ZShlKSxyKSk6bmV3IERhdGUoZSl9LFMpO2Z1bmN0aW9uIFMoZSx0KXt0aGlzLmRhdGU9ZSBpbnN0YW5jZW9mIFM/ZS5kYXRlOm5ldyBEYXRlKGUpLHRoaXMudGltZXpvbmVPZmZzZXQ9dDtlPTZlNCoodGhpcy5kYXRlLmdldFRpbWV6b25lT2Zmc2V0KCktdGhpcy50aW1lem9uZU9mZnNldCksdD10aGlzLmRhdGUuZ2V0VGltZSgpK2U7dGhpcy5kaXNwbGF5RGF0ZT1uZXcgRGF0ZSh0KX1zKHR0LGV0PWUpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0dC5wcm90b3R5cGUsImNvbnRlbnQiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnB1dC5zbGljZSh0aGlzLmNvbnRlbnRSYW5nZVswXSx0aGlzLmNvbnRlbnRSYW5nZVsxXSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7dmFyIGV0LHI9dHQ7ZnVuY3Rpb24gdHQoZSx0LHIsbixpLHMsbyxhKXtmb3IodmFyIHQ9ZCh0LDIpLHU9dFswXSx0PXRbMV0sZT1ldC5jYWxsKHRoaXMsZSxyLG4saSxhKXx8dGhpcyxuPShlLnRyaW1MZWZ0PSExLGUudHJpbVJpZ2h0PSExLCItIj09PXJbdV0pLGk9Ii0iPT09clt0LTFdLGM9bj91KzE6dSxsPWk/dC0xOnQ7YzxsJiZwW3IuY2hhckNvZGVBdChjKV0mVGU7KWMrKztmb3IoO2M8bCYmcFtyLmNoYXJDb2RlQXQobC0xKV0mVGU7KWwtLTtyZXR1cm4gZS5jb250ZW50UmFuZ2U9W2MsbF0sZS50cmltTGVmdD1ufHxzLGUudHJpbVJpZ2h0PWl8fG8sZX1zKGl0LHJ0PXIpLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShpdC5wcm90b3R5cGUsImFyZ3MiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b2tlbml6ZXIuaW5wdXQuc2xpY2UodGhpcy50b2tlbml6ZXIucCx0aGlzLmNvbnRlbnRSYW5nZVsxXSl9LGVudW1lcmFibGU6ITEsY29uZmlndXJhYmxlOiEwfSk7dmFyIHJ0LG50PWl0O2Z1bmN0aW9uIGl0KGUsdCxyLG4saSl7dmFyIHM9dGhpcyxvPW4udHJpbVRhZ0xlZnQsYT1uLnRyaW1UYWdSaWdodCx1PW4udGFnRGVsaW1pdGVyTGVmdCxjPW4udGFnRGVsaW1pdGVyUmlnaHQsdT1kKFt0K3UubGVuZ3RoLHItYy5sZW5ndGhdLDIpLGM9dVswXSx1PXVbMV07cmV0dXJuKHM9cnQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLlRhZyxbYyx1XSxlLHQscixvLGEsaSl8fHRoaXMpLnRva2VuaXplcj1uZXcgVHIoZSxuLm9wZXJhdG9ycyxpLHMuY29udGVudFJhbmdlKSxzLm5hbWU9cy50b2tlbml6ZXIucmVhZFRhZ05hbWUoKSxzLnRva2VuaXplci5hc3NlcnQocy5uYW1lLCJpbGxlZ2FsIHRhZyBzeW50YXgsIHRhZyBuYW1lIGV4cGVjdGVkIikscy50b2tlbml6ZXIuc2tpcEJsYW5rKCksc31zKGF0LHN0PXIpO3ZhciBzdCxvdD1hdDtmdW5jdGlvbiBhdChlLHQscixuLGkpe3ZhciBzPW4udHJpbU91dHB1dExlZnQsbz1uLnRyaW1PdXRwdXRSaWdodCxhPW4ub3V0cHV0RGVsaW1pdGVyTGVmdCxuPW4ub3V0cHV0RGVsaW1pdGVyUmlnaHQsYT1bdCthLmxlbmd0aCxyLW4ubGVuZ3RoXTtyZXR1cm4gc3QuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLk91dHB1dCxhLGUsdCxyLHMsbyxpKXx8dGhpc31zKGx0LHV0PWUpLGx0LnByb3RvdHlwZS5nZXRDb250ZW50PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaW5wdXQuc2xpY2UodGhpcy5iZWdpbit0aGlzLnRyaW1MZWZ0LHRoaXMuZW5kLXRoaXMudHJpbVJpZ2h0KX07dmFyIHV0LGN0PWx0O2Z1bmN0aW9uIGx0KGUsdCxyLG4pe3ZhciBpPXV0LmNhbGwodGhpcyxsLlRva2VuS2luZC5IVE1MLGUsdCxyLG4pfHx0aGlzO3JldHVybiBpLmlucHV0PWUsaS5iZWdpbj10LGkuZW5kPXIsaS5maWxlPW4saS50cmltTGVmdD0wLGkudHJpbVJpZ2h0PTAsaX1zKGZ0LGh0PWUpO3ZhciBodCxwdD1mdDtmdW5jdGlvbiBmdChlLHQscixuKXt2YXIgaT1odC5jYWxsKHRoaXMsbC5Ub2tlbktpbmQuTnVtYmVyLGUsdCxyLG4pfHx0aGlzO3JldHVybiBpLmlucHV0PWUsaS5iZWdpbj10LGkuZW5kPXIsaS5maWxlPW4saS5jb250ZW50PU51bWJlcihpLmdldFRleHQoKSksaX1zKGd0LGR0PWUpLGd0LnByb3RvdHlwZS5pc051bWJlcj1mdW5jdGlvbihlKXtmb3IodmFyIHQ9KGU9dm9pZCAwPT09ZT8hMTplKSYmNjQmcFt0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5iZWdpbildP3RoaXMuYmVnaW4rMTp0aGlzLmJlZ2luO3Q8dGhpcy5lbmQ7dCsrKWlmKCEoMzImcFt0aGlzLmlucHV0LmNoYXJDb2RlQXQodCldKSlyZXR1cm4hMTtyZXR1cm4hMH07dmFyIGR0LHZ0PWd0O2Z1bmN0aW9uIGd0KGUsdCxyLG4pe3ZhciBpPWR0LmNhbGwodGhpcyxsLlRva2VuS2luZC5Xb3JkLGUsdCxyLG4pfHx0aGlzO3JldHVybiBpLmlucHV0PWUsaS5iZWdpbj10LGkuZW5kPXIsaS5maWxlPW4saS5jb250ZW50PWkuZ2V0VGV4dCgpLGl9cyhidCx5dD1lKTt2YXIgeXQsbXQ9YnQ7ZnVuY3Rpb24gYnQoZSx0LHIsbil7dmFyIGk9eXQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLkxpdGVyYWwsZSx0LHIsbil8fHRoaXM7cmV0dXJuIGkuaW5wdXQ9ZSxpLmJlZ2luPXQsaS5lbmQ9cixpLmZpbGU9bixpLmxpdGVyYWw9aS5nZXRUZXh0KCksaS5jb250ZW50PU1lW2kubGl0ZXJhbF0saX12YXIgd3Qsa3Q9eyI9PSI6MiwiIT0iOjIsIj4iOjIsIjwiOjIsIj49IjoyLCI8PSI6Mixjb250YWluczoyLG5vdDoxLGFuZDowLG9yOjB9LFR0PXsiPT0iOjAsIiE9IjowLCI+IjowLCI8IjowLCI+PSI6MCwiPD0iOjAsY29udGFpbnM6MCxub3Q6MSxhbmQ6MCxvcjowfSx4dD0ocyhPdCx3dD1lKSxPdC5wcm90b3R5cGUuZ2V0UHJlY2VkZW5jZT1mdW5jdGlvbigpe3ZhciBlPXRoaXMuZ2V0VGV4dCgpO3JldHVybiBlIGluIGt0P2t0W2VdOjF9LE90KTtmdW5jdGlvbiBPdChlLHQscixuKXt2YXIgaT13dC5jYWxsKHRoaXMsbC5Ub2tlbktpbmQuT3BlcmF0b3IsZSx0LHIsbil8fHRoaXM7cmV0dXJuIGkuaW5wdXQ9ZSxpLmJlZ2luPXQsaS5lbmQ9cixpLmZpbGU9bixpLm9wZXJhdG9yPWkuZ2V0VGV4dCgpLGl9cyhTdCxfdD1lKTt2YXIgX3QsenQ9U3Q7ZnVuY3Rpb24gU3QoZSx0LHIsbixpLHMpe3I9X3QuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLlByb3BlcnR5QWNjZXNzLHIsbixpLHMpfHx0aGlzO3JldHVybiByLnZhcmlhYmxlPWUsci5wcm9wcz10LHJ9cyhxdCxSdD1lKTt2YXIgUnQsRnQ9cXQ7ZnVuY3Rpb24gcXQoZSx0LHIsbixpLHMpe3I9UnQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLkZpbHRlcixyLG4saSxzKXx8dGhpcztyZXR1cm4gci5uYW1lPWUsci5hcmdzPXQscn1zKER0LEx0PWUpO3ZhciBMdCxFdD1EdDtmdW5jdGlvbiBEdChlLHQscixuLGkscyl7dmFyIG89THQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLkhhc2gsZSx0LHIscyl8fHRoaXM7cmV0dXJuIG8uaW5wdXQ9ZSxvLmJlZ2luPXQsby5lbmQ9cixvLm5hbWU9bixvLnZhbHVlPWksby5maWxlPXMsb312YXIgTnQ9L1tcZGEtZkEtRl0vLGp0PS9bMC03XS8sTXQ9e2I6IlxiIixmOiJcZiIsbjoiXG4iLHI6IlxyIix0OiJcdCIsdjoiXHYifTtmdW5jdGlvbiBQdChlKXtlPWUuY2hhckNvZGVBdCgwKTtyZXR1cm4gOTc8PWU/ZS04Nzo2NTw9ZT9lLTU1OmUtNDh9cyhJdCxWdD1lKTt2YXIgVnQsQXQ9SXQ7ZnVuY3Rpb24gSXQoZSx0LHIsbil7dmFyIGk9VnQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLlF1b3RlZCxlLHQscixuKXx8dGhpcztyZXR1cm4gaS5pbnB1dD1lLGkuYmVnaW49dCxpLmVuZD1yLGkuZmlsZT1uLGkuY29udGVudD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9IiIscj0xO3I8ZS5sZW5ndGgtMTtyKyspaWYoIlxcIiE9PWVbcl0pdCs9ZVtyXTtlbHNlIGlmKHZvaWQgMCE9PU10W2VbcisxXV0pdCs9TXRbZVsrK3JdXTtlbHNlIGlmKCJ1Ij09PWVbcisxXSl7Zm9yKHZhciBuPTAsaT1yKzI7aTw9cis1JiZOdC50ZXN0KGVbaV0pOyluPTE2Km4rUHQoZVtpKytdKTtyPWktMSx0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKG4pfWVsc2UgaWYoanQudGVzdChlW3IrMV0pKXtmb3IoaT1yKzEsbj0wO2k8PXIrMyYmanQudGVzdChlW2ldKTspbj04Km4rUHQoZVtpKytdKTtyPWktMSx0Kz1TdHJpbmcuZnJvbUNoYXJDb2RlKG4pfWVsc2UgdCs9ZVsrK3JdO3JldHVybiB0fShpLmdldFRleHQoKSksaX1zKEh0LEJ0PWUpO3ZhciBCdCxDdD1IdDtmdW5jdGlvbiBIdChlLHQscixuLGkscyl7dmFyIG89QnQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLlJhbmdlLGUsdCxyLHMpfHx0aGlzO3JldHVybiBvLmlucHV0PWUsby5iZWdpbj10LG8uZW5kPXIsby5saHM9bixvLnJocz1pLG8uZmlsZT1zLG99cygkdCxLdD1yKTt2YXIgS3QsVXQ9JHQ7ZnVuY3Rpb24gJHQoZSx0LHIsbixpKXt0PUt0LmNhbGwodGhpcyxsLlRva2VuS2luZC5UYWcsW3Qscl0sZSx0LHIsITEsITEsaSl8fHRoaXM7cmV0dXJuIHQudG9rZW5pemVyPW5ldyBUcihlLG4ub3BlcmF0b3JzLGksdC5jb250ZW50UmFuZ2UpLHQubmFtZT10LnRva2VuaXplci5yZWFkVGFnTmFtZSgpLHQudG9rZW5pemVyLmFzc2VydCh0Lm5hbWUsImlsbGVnYWwgbGlxdWlkIHRhZyBzeW50YXgiKSx0LnRva2VuaXplci5za2lwQmxhbmsoKSx0LmFyZ3M9dC50b2tlbml6ZXIucmVtYWluaW5nKCksdH1zKFl0LFF0PWUpO3ZhciBRdCxXdD1ZdDtmdW5jdGlvbiBZdChlLHQscixuLGkscyl7dmFyIG89UXQuY2FsbCh0aGlzLGwuVG9rZW5LaW5kLkZpbHRlcmVkVmFsdWUscixuLGkscyl8fHRoaXM7cmV0dXJuIG8uaW5pdGlhbD1lLG8uZmlsdGVycz10LG8uaW5wdXQ9cixvLmJlZ2luPW4sby5lbmQ9aSxvLmZpbGU9cyxvfVp0LnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihlKXt0aGlzLmJ1ZmZlcis9ZihlKX07dmFyIEp0PVp0O2Z1bmN0aW9uIFp0KCl7dGhpcy5idWZmZXI9IiJ9dmFyIEd0PWZ1bmN0aW9uKCl7dGhyb3cgdGhpcy5idWZmZXI9IiIsdGhpcy5zdHJlYW09bnVsbCxuZXcgRXJyb3IoInN0cmVhbWluZyBub3Qgc3VwcG9ydGVkIGluIGJyb3dzZXIiKX0sWHQ9KGVyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihlKXsic3RyaW5nIiE9dHlwZW9mKGU9eShlKSkmJiIiPT09dGhpcy5idWZmZXI/dGhpcy5idWZmZXI9ZTp0aGlzLmJ1ZmZlcj1mKHRoaXMuYnVmZmVyKStmKGUpfSxlcik7ZnVuY3Rpb24gZXIoKXt0aGlzLmJ1ZmZlcj0iIn1yci5wcm90b3R5cGUucmVuZGVyVGVtcGxhdGVzVG9Ob2RlU3RyZWFtPWZ1bmN0aW9uKGUsdCl7dmFyIHI9dGhpcyxuPW5ldyBHdDtyZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpe3JldHVybiB3KHIucmVuZGVyVGVtcGxhdGVzKGUsdCxuKSl9KS50aGVuKGZ1bmN0aW9uKCl7cmV0dXJuIG4uZW5kKCl9LGZ1bmN0aW9uKGUpe3JldHVybiBuLmVycm9yKGUpfSksbi5zdHJlYW19LHJyLnByb3RvdHlwZS5yZW5kZXJUZW1wbGF0ZXM9ZnVuY3Rpb24odCxyLG4pe3ZhciBpLHMsbyxhLHUsYztyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6bj1ufHxuZXcoci5vcHRzLmtlZXBPdXRwdXRUeXBlP1h0Okp0KSxlLmxhYmVsPTE7Y2FzZSAxOmUudHJ5cy5wdXNoKFsxLDgsOSwxMF0pLGk9Tyh0KSxzPWkubmV4dCgpLGUubGFiZWw9MjtjYXNlIDI6aWYocy5kb25lKXJldHVyblszLDddO289cy52YWx1ZSxlLmxhYmVsPTM7Y2FzZSAzOnJldHVybiBlLnRyeXMucHVzaChbMyw1LCw2XSksWzQsby5yZW5kZXIocixuKV07Y2FzZSA0OnJldHVybihhPWUuc2VudCgpKSYmbi53cml0ZShhKSxuLmJyZWFrfHxuLmNvbnRpbnVlP1szLDddOlszLDZdO2Nhc2UgNTp0aHJvdyBhPWUuc2VudCgpLGxlLmlzKGEpP2E6bmV3IGxlKGEsbyk7Y2FzZSA2OnJldHVybiBzPWkubmV4dCgpLFszLDJdO2Nhc2UgNzpyZXR1cm5bMywxMF07Y2FzZSA4OnJldHVybiB1PWUuc2VudCgpLHU9e2Vycm9yOnV9LFszLDEwXTtjYXNlIDk6dHJ5e3MmJiFzLmRvbmUmJihjPWkucmV0dXJuKSYmYy5jYWxsKGkpfWZpbmFsbHl7aWYodSl0aHJvdyB1LmVycm9yfXJldHVybls3XTtjYXNlIDEwOnJldHVyblsyLG4uYnVmZmVyXX19KX07dmFyIHRyPXJyO2Z1bmN0aW9uIHJyKCl7fWlyLnByb3RvdHlwZS5ldmFsdWF0ZT1mdW5jdGlvbih0LHIpe3ZhciBuLGkscyxvLGEsdSxjLGwsaCxwLGY7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOl8odCwidW5hYmxlIHRvIGV2YWx1YXRlOiBjb250ZXh0IG5vdCBkZWZpbmVkIiksbj1bXSxlLmxhYmVsPTE7Y2FzZSAxOmUudHJ5cy5wdXNoKFsxLDExLDEyLDEzXSksaT1PKHRoaXMucG9zdGZpeCkscz1pLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiBzLmRvbmU/WzMsMTBdOlVyKG89cy52YWx1ZSk/KGE9bi5wb3AoKSx1PXZvaWQgMCwxIT09VHRbby5vcGVyYXRvcl0/WzMsNF06WzQsdC5vcHRzLm9wZXJhdG9yc1tvLm9wZXJhdG9yXShhLHQpXSk6WzMsN107Y2FzZSAzOnJldHVybiB1PWUuc2VudCgpLFszLDZdO2Nhc2UgNDpyZXR1cm4gaD1uLnBvcCgpLFs0LHQub3B0cy5vcGVyYXRvcnNbby5vcGVyYXRvcl0oaCxhLHQpXTtjYXNlIDU6dT1lLnNlbnQoKSxlLmxhYmVsPTY7Y2FzZSA2OnJldHVybiBuLnB1c2godSksWzMsOV07Y2FzZSA3OnJldHVybiBsPShjPW4pLnB1c2gsWzQsUihvLHQsciYmMT09PXRoaXMucG9zdGZpeC5sZW5ndGgpXTtjYXNlIDg6bC5hcHBseShjLFtlLnNlbnQoKV0pLGUubGFiZWw9OTtjYXNlIDk6cmV0dXJuIHM9aS5uZXh0KCksWzMsMl07Y2FzZSAxMDpyZXR1cm5bMywxM107Y2FzZSAxMTpyZXR1cm4gaD1lLnNlbnQoKSxwPXtlcnJvcjpofSxbMywxM107Y2FzZSAxMjp0cnl7cyYmIXMuZG9uZSYmKGY9aS5yZXR1cm4pJiZmLmNhbGwoaSl9ZmluYWxseXtpZihwKXRocm93IHAuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTM6cmV0dXJuWzIsblswXV19fSl9LGlyLnByb3RvdHlwZS52YWxpZD1mdW5jdGlvbigpe3JldHVybiEhdGhpcy5wb3N0Zml4Lmxlbmd0aH07dmFyIG5yPWlyO2Z1bmN0aW9uIGlyKGUpe3RoaXMucG9zdGZpeD12KFtdLGQoZnVuY3Rpb24odCl7dmFyIHIsbixpLHMsbyxhO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyPVtdLGUubGFiZWw9MTtjYXNlIDE6ZS50cnlzLnB1c2goWzEsMTAsMTEsMTJdKSxuPU8odCksaT1uLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOmlmKGkuZG9uZSlyZXR1cm5bMyw5XTtpZighVXIocz1pLnZhbHVlKSlyZXR1cm5bMyw2XTtlLmxhYmVsPTM7Y2FzZSAzOnJldHVybiByLmxlbmd0aCYmcltyLmxlbmd0aC0xXS5nZXRQcmVjZWRlbmNlKCk+cy5nZXRQcmVjZWRlbmNlKCk/WzQsci5wb3AoKV06WzMsNV07Y2FzZSA0OnJldHVybiBlLnNlbnQoKSxbMywzXTtjYXNlIDU6cmV0dXJuIHIucHVzaChzKSxbMyw4XTtjYXNlIDY6cmV0dXJuWzQsc107Y2FzZSA3OmUuc2VudCgpLGUubGFiZWw9ODtjYXNlIDg6cmV0dXJuIGk9bi5uZXh0KCksWzMsMl07Y2FzZSA5OnJldHVyblszLDEyXTtjYXNlIDEwOnJldHVybiBvPWUuc2VudCgpLG89e2Vycm9yOm99LFszLDEyXTtjYXNlIDExOnRyeXtpJiYhaS5kb25lJiYoYT1uLnJldHVybikmJmEuY2FsbChuKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn1yZXR1cm5bN107Y2FzZSAxMjpyZXR1cm4gci5sZW5ndGg/WzQsci5wb3AoKV06WzMsMTRdO2Nhc2UgMTM6cmV0dXJuIGUuc2VudCgpLFszLDEyXTtjYXNlIDE0OnJldHVyblsyXX19KX0oZSkpLCExKX1mdW5jdGlvbiBSKHQscixuKXtyZXR1cm4gdm9pZCAwPT09biYmKG49ITEpLHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiB0PyJjb250ZW50ImluIHQ/WzIsdC5jb250ZW50XTpKcih0KT9bNCxmdW5jdGlvbih0LHIsbil7dmFyIGkscyxvLGEsdSxjLGwsaCxwLGY7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiBpPVtdLFs0LFIodC52YXJpYWJsZSxyLG4pXTtjYXNlIDE6cz1lLnNlbnQoKSxlLmxhYmVsPTI7Y2FzZSAyOmUudHJ5cy5wdXNoKFsyLDcsOCw5XSksbz1PKHQucHJvcHMpLGE9by5uZXh0KCksZS5sYWJlbD0zO2Nhc2UgMzpyZXR1cm4gYS5kb25lP1szLDZdOihsPWEudmFsdWUsYz0odT1pKS5wdXNoLFs0LFIobCxyLCExKV0pO2Nhc2UgNDpjLmFwcGx5KHUsW2Uuc2VudCgpXSksZS5sYWJlbD01O2Nhc2UgNTpyZXR1cm4gYT1vLm5leHQoKSxbMywzXTtjYXNlIDY6cmV0dXJuWzMsOV07Y2FzZSA3OnJldHVybiBsPWUuc2VudCgpLHA9e2Vycm9yOmx9LFszLDldO2Nhc2UgODp0cnl7YSYmIWEuZG9uZSYmKGY9by5yZXR1cm4pJiZmLmNhbGwobyl9ZmluYWxseXtpZihwKXRocm93IHAuZXJyb3J9cmV0dXJuWzddO2Nhc2UgOTpyZXR1cm4oZS50cnlzLnB1c2goWzksMTQsLDE1XSksdC52YXJpYWJsZSk/WzQsci5fZ2V0RnJvbVNjb3BlKHMsaSldOlszLDExXTtjYXNlIDEwOnJldHVyblsyLGUuc2VudCgpXTtjYXNlIDExOnJldHVybls0LHIuX2dldChpKV07Y2FzZSAxMjpyZXR1cm5bMixlLnNlbnQoKV07Y2FzZSAxMzpyZXR1cm5bMywxNV07Y2FzZSAxNDppZihoPWUuc2VudCgpLG4mJiJJbnRlcm5hbFVuZGVmaW5lZFZhcmlhYmxlRXJyb3IiPT09aC5uYW1lKXJldHVyblsyLG51bGxdO3Rocm93IG5ldyBmZShoLHQpO2Nhc2UgMTU6cmV0dXJuWzJdfX0pfSh0LHIsbildOlszLDJdOlsyXTtjYXNlIDE6cmV0dXJuWzIsZS5zZW50KCldO2Nhc2UgMjpyZXR1cm4gWnIodCk/WzQsZnVuY3Rpb24odCxyKXt2YXIgbixpO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm5bNCxSKHQubGhzLHIpXTtjYXNlIDE6cmV0dXJuIG49ZS5zZW50KCksWzQsUih0LnJocyxyKV07Y2FzZSAyOnJldHVybiBpPWUuc2VudCgpLFsyLFEoK24sK2krMSldfX0pfSh0LHIpXTpbMyw0XTtjYXNlIDM6cmV0dXJuWzIsZS5zZW50KCldO2Nhc2UgNDpyZXR1cm5bMl19fSl9ZnVuY3Rpb24gc3IoZSl7cmV0dXJuIGUuY29udGVudH1mdW5jdGlvbiBvcihlLHQpe3JldHVybiFhcihlLHQpfWZ1bmN0aW9uIGFyKGUsdCl7cmV0dXJuIHQub3B0cy5qc1RydXRoeT8hZTohMT09PWV8fG51bGw9PWV9UmU9eyI9PSI6dXIsIiE9IjpmdW5jdGlvbihlLHQpe3JldHVybiF1cihlLHQpfSwiPiI6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYihlKT9lLmd0KHQpOmIodCk/dC5sdChlKTp5KGUpPnkodCl9LCI8IjpmdW5jdGlvbihlLHQpe3JldHVybiBiKGUpP2UubHQodCk6Yih0KT90Lmd0KGUpOnkoZSk8eSh0KX0sIj49IjpmdW5jdGlvbihlLHQpe3JldHVybiBiKGUpP2UuZ2VxKHQpOmIodCk/dC5sZXEoZSk6eShlKT49eSh0KX0sIjw9IjpmdW5jdGlvbihlLHQpe3JldHVybiBiKGUpP2UubGVxKHQpOmIodCk/dC5nZXEoZSk6eShlKTw9eSh0KX0sY29udGFpbnM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZyhlPXkoZSkpP2Uuc29tZShmdW5jdGlvbihlKXtyZXR1cm4gdXIoZSx0KX0pOiEhdShlKSYmLTE8ZS5pbmRleE9mKHkodCkpfSxub3Q6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYXIoeShlKSx0KX0sYW5kOmZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gb3IoeShlKSxyKSYmb3IoeSh0KSxyKX0sb3I6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBvcih5KGUpLHIpfHxvcih5KHQpLHIpfX07ZnVuY3Rpb24gdXIoZSx0KXt2YXIgcixuO3JldHVybiBiKGUpP2UuZXF1YWxzKHQpOmIodCk/dC5lcXVhbHMoZSk6KGU9eShlKSx0PXkodCksZyhlKT9nKHQpJiYobj10LChyPWUpLmxlbmd0aD09PW4ubGVuZ3RoKSYmIXIuc29tZShmdW5jdGlvbihlLHQpe3JldHVybiF1cihlLG5bdF0pfSk6ZT09PXQpfXZhciBjcj1mdW5jdGlvbihlLHQscixuKXt0aGlzLmtleT1lLHRoaXMudmFsdWU9dCx0aGlzLm5leHQ9cix0aGlzLnByZXY9bn0sbHI9KGhyLnByb3RvdHlwZS53cml0ZT1mdW5jdGlvbihlLHQpe3RoaXMuY2FjaGVbZV0/dGhpcy5jYWNoZVtlXS52YWx1ZT10Oih0PW5ldyBjcihlLHQsdGhpcy5oZWFkLm5leHQsdGhpcy5oZWFkKSx0aGlzLmhlYWQubmV4dC5wcmV2PXQsdGhpcy5oZWFkLm5leHQ9dCx0aGlzLmNhY2hlW2VdPXQsdGhpcy5zaXplKyssdGhpcy5lbnN1cmVMaW1pdCgpKX0saHIucHJvdG90eXBlLnJlYWQ9ZnVuY3Rpb24oZSl7dmFyIHQ7aWYodGhpcy5jYWNoZVtlXSlyZXR1cm4gdD10aGlzLmNhY2hlW2VdLnZhbHVlLHRoaXMucmVtb3ZlKGUpLHRoaXMud3JpdGUoZSx0KSx0fSxoci5wcm90b3R5cGUucmVtb3ZlPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuY2FjaGVbZV07dC5wcmV2Lm5leHQ9dC5uZXh0LHQubmV4dC5wcmV2PXQucHJldixkZWxldGUgdGhpcy5jYWNoZVtlXSx0aGlzLnNpemUtLX0saHIucHJvdG90eXBlLmNsZWFyPWZ1bmN0aW9uKCl7dGhpcy5oZWFkLm5leHQ9dGhpcy50YWlsLHRoaXMudGFpbC5wcmV2PXRoaXMuaGVhZCx0aGlzLnNpemU9MCx0aGlzLmNhY2hlPXt9fSxoci5wcm90b3R5cGUuZW5zdXJlTGltaXQ9ZnVuY3Rpb24oKXt0aGlzLnNpemU+dGhpcy5saW1pdCYmdGhpcy5yZW1vdmUodGhpcy50YWlsLnByZXYua2V5KX0saHIpO2Z1bmN0aW9uIGhyKGUsdCl7dm9pZCAwPT09dCYmKHQ9MCksdGhpcy5saW1pdD1lLHRoaXMuc2l6ZT10LHRoaXMuY2FjaGU9e30sdGhpcy5oZWFkPW5ldyBjcigiSEVBRCIsbnVsbCxudWxsLG51bGwpLHRoaXMudGFpbD1uZXcgY3IoIlRBSUwiLG51bGwsbnVsbCxudWxsKSx0aGlzLmhlYWQubmV4dD10aGlzLnRhaWwsdGhpcy50YWlsLnByZXY9dGhpcy5oZWFkfWZ1bmN0aW9uIHByKGUsdCl7dmFyIHI9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgiYmFzZSIpLGU9KHIuaHJlZj1lLGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF0pLG49KGUuaW5zZXJ0QmVmb3JlKHIsZS5maXJzdENoaWxkKSxkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJhIikpLHQ9KG4uaHJlZj10LG4uaHJlZik7cmV0dXJuIGUucmVtb3ZlQ2hpbGQociksdH1pPU9iamVjdC5mcmVlemUoe19fcHJvdG9fXzpudWxsLHJlc29sdmU6ZnVuY3Rpb24oZSx0LGkpe3JldHVybiBlLmxlbmd0aCYmIi8iIT09VShlKSYmKGUrPSIvIikscHIoZSx0KS5yZXBsYWNlKC9eKFx3KzpcL1wvW14vXSspKFwvW14/XSspLyxmdW5jdGlvbihlLHQscil7dmFyIG49ci5zcGxpdCgiLyIpLnBvcCgpO3JldHVybi9cLlx3KyQvLnRlc3Qobik/ZTp0K3IraX0pfSxyZWFkRmlsZTpmdW5jdGlvbihuKXtyZXR1cm4gYSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVyblsyLG5ldyBQcm9taXNlKGZ1bmN0aW9uKGUsdCl7dmFyIHI9bmV3IFhNTEh0dHBSZXF1ZXN0O3Iub25sb2FkPWZ1bmN0aW9uKCl7MjAwPD1yLnN0YXR1cyYmci5zdGF0dXM8MzAwP2Uoci5yZXNwb25zZVRleHQpOnQobmV3IEVycm9yKHIuc3RhdHVzVGV4dCkpfSxyLm9uZXJyb3I9ZnVuY3Rpb24oKXt0KG5ldyBFcnJvcigiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbHN0IHJlY2VpdmluZyB0aGUgcmVzcG9uc2UuIikpfSxyLm9wZW4oIkdFVCIsbiksci5zZW5kKCl9KV19KX0pfSxyZWFkRmlsZVN5bmM6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFhNTEh0dHBSZXF1ZXN0O2lmKHQub3BlbigiR0VUIixlLCExKSx0LnNlbmQoKSx0LnN0YXR1czwyMDB8fDMwMDw9dC5zdGF0dXMpdGhyb3cgbmV3IEVycm9yKHQuc3RhdHVzVGV4dCk7cmV0dXJuIHQucmVzcG9uc2VUZXh0fSxleGlzdHM6ZnVuY3Rpb24oZSl7cmV0dXJuIGEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtyZXR1cm5bMiwhMF19KX0pfSxleGlzdHNTeW5jOmZ1bmN0aW9uKGUpe3JldHVybiEwfSxkaXJuYW1lOmZ1bmN0aW9uKGUpe3JldHVybiBwcihlLCIuIil9LHNlcDoiLyJ9KTtmdW5jdGlvbiBmcihlLHQpe3JldHVybiB2b2lkIDA9PT10JiYodD0wKSxKU09OLnN0cmluZ2lmeShlLG51bGwsdCl9dmFyIHI9e3JhdzohMCxoYW5kbGVyOkp9LGRyPXsiJiI6IiZhbXA7IiwiPCI6IiZsdDsiLCI+IjoiJmd0OyIsJyInOiImIzM0OyIsIiciOiImIzM5OyJ9LHZyPXsiJmFtcDsiOiImIiwiJmx0OyI6IjwiLCImZ3Q7IjoiPiIsIiYjMzQ7IjonIicsIiYjMzk7IjoiJyJ9O2Z1bmN0aW9uIGdyKGUpe3JldHVybiBmKGUpLnJlcGxhY2UoLyZ8PHw+fCJ8Jy9nLGZ1bmN0aW9uKGUpe3JldHVybiBkcltlXX0pfXZhciB5cj1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxlc2NhcGU6Z3IsZXNjYXBlX29uY2U6ZnVuY3Rpb24oZSl7cmV0dXJuIGdyKChlPWYoZSksZihlKS5yZXBsYWNlKC8mKGFtcHxsdHxndHwjMzR8IzM5KTsvZyxmdW5jdGlvbihlKXtyZXR1cm4gdnJbZV19KSkpfSxuZXdsaW5lX3RvX2JyOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUpLnJlcGxhY2UoL1xyP1xuL2dtLCI8YnIgLz5cbiIpfSxzdHJpcF9odG1sOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUpLnJlcGxhY2UoLzxzY3JpcHRbXHNcU10qPzxcL3NjcmlwdD58PHN0eWxlW1xzXFNdKj88XC9zdHlsZT58PC4qPz58PCEtLVtcc1xTXSo/LS0+L2csIiIpfX0pLG1yPXtyb290OlsiLiJdLGxheW91dHM6WyIuIl0scGFydGlhbHM6WyIuIl0scmVsYXRpdmVSZWZlcmVuY2U6ITAsamVreWxsSW5jbHVkZTohMSxjYWNoZTp2b2lkIDAsZXh0bmFtZToiIixmczppLGR5bmFtaWNQYXJ0aWFsczohMCxqc1RydXRoeTohMSxkYXRlRm9ybWF0OiIlQSwgJUIgJS1lLCAlWSBhdCAlLWw6JU0gJVAgJXoiLHRyaW1UYWdSaWdodDohMSx0cmltVGFnTGVmdDohMSx0cmltT3V0cHV0UmlnaHQ6ITEsdHJpbU91dHB1dExlZnQ6ITEsZ3JlZWR5OiEwLHRhZ0RlbGltaXRlckxlZnQ6InslIix0YWdEZWxpbWl0ZXJSaWdodDoiJX0iLG91dHB1dERlbGltaXRlckxlZnQ6Int7IixvdXRwdXREZWxpbWl0ZXJSaWdodDoifX0iLHByZXNlcnZlVGltZXpvbmVzOiExLHN0cmljdEZpbHRlcnM6ITEsc3RyaWN0VmFyaWFibGVzOiExLG93blByb3BlcnR5T25seTohMCxsZW5pZW50SWY6ITEsZ2xvYmFsczp7fSxrZWVwT3V0cHV0VHlwZTohMSxvcGVyYXRvcnM6UmV9O2Z1bmN0aW9uIGJyKGUpe3ZhciB0O3JldHVybiBlLmhhc093blByb3BlcnR5KCJyb290IikmJihlLmhhc093blByb3BlcnR5KCJwYXJ0aWFscyIpfHwoZS5wYXJ0aWFscz1lLnJvb3QpLGUuaGFzT3duUHJvcGVydHkoImxheW91dHMiKXx8KGUubGF5b3V0cz1lLnJvb3QpKSxlLmhhc093blByb3BlcnR5KCJjYWNoZSIpJiYodD12b2lkIDAsdD0ibnVtYmVyIj09dHlwZW9mIGUuY2FjaGU/MDxlLmNhY2hlP25ldyBscihlLmNhY2hlKTp2b2lkIDA6Im9iamVjdCI9PXR5cGVvZiBlLmNhY2hlP2UuY2FjaGU6ZS5jYWNoZT9uZXcgbHIoMTAyNCk6dm9pZCAwLGUuY2FjaGU9dCksKGU9VChUKFQoe30sbXIpLGUuamVreWxsSW5jbHVkZT97ZHluYW1pY1BhcnRpYWxzOiExfTp7fSksZSkpLmZzLmRpcm5hbWUmJmUuZnMuc2VwfHwhZS5yZWxhdGl2ZVJlZmVyZW5jZXx8KGNvbnNvbGUud2FybigiW0xpcXVpZEpTXSBgZnMuZGlybmFtZWAgYW5kIGBmcy5zZXBgIGFyZSByZXF1aXJlZCBmb3IgcmVsYXRpdmVSZWZlcmVuY2UsIHNldCByZWxhdGl2ZVJlZmVyZW5jZSB0byBgZmFsc2VgIHRvIHN1cHByZXNzIHRoaXMgd2FybmluZyIpLGUucmVsYXRpdmVSZWZlcmVuY2U9ITEpLGUucm9vdD13cihlLnJvb3QpLGUucGFydGlhbHM9d3IoZS5wYXJ0aWFscyksZS5sYXlvdXRzPXdyKGUubGF5b3V0cyksZS5vdXRwdXRFc2NhcGU9ZS5vdXRwdXRFc2NhcGUmJigiZXNjYXBlIj09PSh0PWUub3V0cHV0RXNjYXBlKT9ncjoianNvbiI9PT10P2ZyOihfKGModCksImBvdXRwdXRFc2NhcGVgIG5lZWQgdG8gYmUgb2YgdHlwZSBzdHJpbmcgb3IgZnVuY3Rpb24iKSx0KSksZX1mdW5jdGlvbiB3cihlKXt2YXIgdD1bXTtyZXR1cm4gZyhlKSYmKHQ9ZSksdD11KGUpP1tlXTp0fWZ1bmN0aW9uIGtyKGUsdCl7Zm9yKHZhciByPSExLG49MDtuPGUubGVuZ3RoO24rKyl7dmFyIGk9ZVtuXTtpZihLcihpKSl7aWYoIXImJmkudHJpbUxlZnQpe2E9bz1zPXZvaWQgMDt2YXIgcz1lW24tMV0sbz10LmdyZWVkeTtpZihzJiYkcihzKSlmb3IodmFyIGE9bz9UZTp4ZTtwW3MuaW5wdXQuY2hhckNvZGVBdChzLmVuZC0xLXMudHJpbVJpZ2h0KV0mYTspcy50cmltUmlnaHQrK31pZihXcihpKSYmKCJyYXciPT09aS5uYW1lP3I9ITA6ImVuZHJhdyI9PT1pLm5hbWUmJihyPSExKSksIXImJmkudHJpbVJpZ2h0KXtjPW89dT12b2lkIDA7dmFyIHU9ZVtuKzFdLG89dC5ncmVlZHk7aWYodSYmJHIodSkpe2Zvcih2YXIgYz1vP1RlOnhlO3BbdS5pbnB1dC5jaGFyQ29kZUF0KHUuYmVnaW4rdS50cmltTGVmdCldJmM7KXUudHJpbUxlZnQrKzsiXG4iPT09dS5pbnB1dC5jaGFyQXQodS5iZWdpbit1LnRyaW1MZWZ0KSYmdS50cmltTGVmdCsrfX19fX1GLnByb3RvdHlwZS5yZWFkRXhwcmVzc2lvbj1mdW5jdGlvbigpe3JldHVybiBuZXcgbnIodGhpcy5yZWFkRXhwcmVzc2lvblRva2VucygpKX0sRi5wcm90b3R5cGUucmVhZEV4cHJlc3Npb25Ub2tlbnM9ZnVuY3Rpb24oKXt2YXIgdDtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuIHRoaXMucDx0aGlzLk4/KHQ9dGhpcy5yZWFkT3BlcmF0b3IoKSk/WzQsdF06WzMsMl06WzMsNV07Y2FzZSAxOnJldHVybiBlLnNlbnQoKSxbMywwXTtjYXNlIDI6cmV0dXJuKHQ9dGhpcy5yZWFkVmFsdWUoKSk/WzQsdF06WzMsNF07Y2FzZSAzOnJldHVybiBlLnNlbnQoKSxbMywwXTtjYXNlIDQ6Y2FzZSA1OnJldHVyblsyXX19KX0sRi5wcm90b3R5cGUucmVhZE9wZXJhdG9yPWZ1bmN0aW9uKCl7dGhpcy5za2lwQmxhbmsoKTt2YXIgZT10aGlzLm1hdGNoVHJpZSh0aGlzLm9wVHJpZSk7aWYoLTEhPT1lKXJldHVybiBuZXcgeHQodGhpcy5pbnB1dCx0aGlzLnAsdGhpcy5wPWUsdGhpcy5maWxlKX0sRi5wcm90b3R5cGUubWF0Y2hUcmllPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxyPWUsbj10aGlzLnA7clt0aGlzLmlucHV0W25dXSYmbjx0aGlzLk47KShyPXJbdGhpcy5pbnB1dFtuKytdXSkuZW5kJiYodD1yKTtyZXR1cm4hdHx8dC5uZWVkQm91bmRhcnkmJk9lKHRoaXMucGVlayhuLXRoaXMucCkpPy0xOm59LEYucHJvdG90eXBlLnJlYWRGaWx0ZXJlZFZhbHVlPWZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5wLHQ9dGhpcy5yZWFkRXhwcmVzc2lvbigpLHI9KHRoaXMuYXNzZXJ0KHQudmFsaWQoKSwiaW52YWxpZCB2YWx1ZSBleHByZXNzaW9uOiAiLmNvbmNhdCh0aGlzLnNuYXBzaG90KCkpKSx0aGlzLnJlYWRGaWx0ZXJzKCkpO3JldHVybiBuZXcgV3QodCxyLHRoaXMuaW5wdXQsZSx0aGlzLnAsdGhpcy5maWxlKX0sRi5wcm90b3R5cGUucmVhZEZpbHRlcnM9ZnVuY3Rpb24oKXtmb3IodmFyIGU9W107Oyl7dmFyIHQ9dGhpcy5yZWFkRmlsdGVyKCk7aWYoIXQpcmV0dXJuIGU7ZS5wdXNoKHQpfX0sRi5wcm90b3R5cGUucmVhZEZpbHRlcj1mdW5jdGlvbigpe3ZhciBlPXRoaXM7aWYodGhpcy5za2lwQmxhbmsoKSx0aGlzLmVuZCgpKXJldHVybiBudWxsO3RoaXMuYXNzZXJ0KCJ8Ij09PXRoaXMucGVlaygpLCdleHBlY3RlZCAifCIgYmVmb3JlIGZpbHRlcicpLHRoaXMucCsrO3ZhciB0PXRoaXMucCxyPXRoaXMucmVhZElkZW50aWZpZXIoKTtpZighci5zaXplKCkpcmV0dXJuIHRoaXMuYXNzZXJ0KHRoaXMuZW5kKCksImV4cGVjdGVkIGZpbHRlciBuYW1lIiksbnVsbDt2YXIgbj1bXTtpZih0aGlzLnNraXBCbGFuaygpLCI6Ij09PXRoaXMucGVlaygpKWRveysrdGhpcy5wO3ZhciBpPXRoaXMucmVhZEZpbHRlckFyZygpfXdoaWxlKGkmJm4ucHVzaChpKSx0aGlzLnNraXBCbGFuaygpLHRoaXMuYXNzZXJ0KHRoaXMuZW5kKCl8fCIsIj09PXRoaXMucGVlaygpfHwifCI9PT10aGlzLnBlZWsoKSxmdW5jdGlvbigpe3JldHVybiJ1bmV4cGVjdGVkIGNoYXJhY3RlciAiLmNvbmNhdChlLnNuYXBzaG90KCkpfSksIiwiPT09dGhpcy5wZWVrKCkpO2Vsc2UgaWYoInwiIT09dGhpcy5wZWVrKCkmJiF0aGlzLmVuZCgpKXRocm93IHRoaXMuZXJyb3IoJ2V4cGVjdGVkICI6IiBhZnRlciBmaWx0ZXIgbmFtZScpO3JldHVybiBuZXcgRnQoci5nZXRUZXh0KCksbix0aGlzLmlucHV0LHQsdGhpcy5wLHRoaXMuZmlsZSl9LEYucHJvdG90eXBlLnJlYWRGaWx0ZXJBcmc9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnJlYWRWYWx1ZSgpO2lmKGUpe2lmKHRoaXMuc2tpcEJsYW5rKCksIjoiIT09dGhpcy5wZWVrKCkpcmV0dXJuIGU7Kyt0aGlzLnA7dmFyIHQ9dGhpcy5yZWFkVmFsdWUoKTtyZXR1cm5bZS5nZXRUZXh0KCksdF19fSxGLnByb3RvdHlwZS5yZWFkVG9wTGV2ZWxUb2tlbnM9ZnVuY3Rpb24oZSl7dm9pZCAwPT09ZSYmKGU9bXIpO2Zvcih2YXIgdD1bXTt0aGlzLnA8dGhpcy5OOyl7dmFyIHI9dGhpcy5yZWFkVG9wTGV2ZWxUb2tlbihlKTt0LnB1c2gocil9cmV0dXJuIGtyKHQsZSksdH0sRi5wcm90b3R5cGUucmVhZFRvcExldmVsVG9rZW49ZnVuY3Rpb24oZSl7dmFyIHQ9ZS50YWdEZWxpbWl0ZXJMZWZ0LHI9ZS5vdXRwdXREZWxpbWl0ZXJMZWZ0O3JldHVybi0xPHRoaXMucmF3QmVnaW5BdD90aGlzLnJlYWRFbmRyYXdPclJhd0NvbnRlbnQoZSk6dGhpcy5tYXRjaCh0KT90aGlzLnJlYWRUYWdUb2tlbihlKTp0aGlzLm1hdGNoKHIpP3RoaXMucmVhZE91dHB1dFRva2VuKGUpOnRoaXMucmVhZEhUTUxUb2tlbihbdCxyXSl9LEYucHJvdG90eXBlLnJlYWRIVE1MVG9rZW49ZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXRoaXMscj10aGlzLnA7dGhpcy5wPHRoaXMuTiYmIWUuc29tZShmdW5jdGlvbihlKXtyZXR1cm4gdC5tYXRjaChlKX0pOykrK3RoaXMucDtyZXR1cm4gbmV3IGN0KHRoaXMuaW5wdXQscix0aGlzLnAsdGhpcy5maWxlKX0sRi5wcm90b3R5cGUucmVhZFRhZ1Rva2VuPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPW1yKTt2YXIgdD10aGlzLmZpbGUscj10aGlzLmlucHV0LG49dGhpcy5wO2lmKC0xPT09dGhpcy5yZWFkVG9EZWxpbWl0ZXIoZS50YWdEZWxpbWl0ZXJSaWdodCkpdGhyb3cgdGhpcy5lcnJvcigidGFnICIuY29uY2F0KHRoaXMuc25hcHNob3QobiksIiBub3QgY2xvc2VkIiksbik7cj1uZXcgbnQocixuLHRoaXMucCxlLHQpO3JldHVybiJyYXciPT09ci5uYW1lJiYodGhpcy5yYXdCZWdpbkF0PW4pLHJ9LEYucHJvdG90eXBlLnJlYWRUb0RlbGltaXRlcj1mdW5jdGlvbihlLHQpe2Zvcih2b2lkIDA9PT10JiYodD0hMSksdGhpcy5za2lwQmxhbmsoKTt0aGlzLnA8dGhpcy5OOylpZih0JiY4JnRoaXMucGVla1R5cGUoKSl0aGlzLnJlYWRRdW90ZWQoKTtlbHNlIGlmKCsrdGhpcy5wLHRoaXMucm1hdGNoKGUpKXJldHVybiB0aGlzLnA7cmV0dXJuLTF9LEYucHJvdG90eXBlLnJlYWRPdXRwdXRUb2tlbj1mdW5jdGlvbihlKXt2b2lkIDA9PT1lJiYoZT1tcik7dmFyIHQ9dGhpcy5maWxlLHI9dGhpcy5pbnB1dCxuPWUub3V0cHV0RGVsaW1pdGVyUmlnaHQsaT10aGlzLnA7aWYoLTE9PT10aGlzLnJlYWRUb0RlbGltaXRlcihuLCEwKSl0aHJvdyB0aGlzLmVycm9yKCJvdXRwdXQgIi5jb25jYXQodGhpcy5zbmFwc2hvdChpKSwiIG5vdCBjbG9zZWQiKSxpKTtyZXR1cm4gbmV3IG90KHIsaSx0aGlzLnAsZSx0KX0sRi5wcm90b3R5cGUucmVhZEVuZHJhd09yUmF3Q29udGVudD1mdW5jdGlvbihlKXtmb3IodmFyIHQscj1lLnRhZ0RlbGltaXRlckxlZnQsbj1lLnRhZ0RlbGltaXRlclJpZ2h0LGk9dGhpcy5wLHM9dGhpcy5yZWFkVG8ociktci5sZW5ndGg7dGhpcy5wPHRoaXMuTjspaWYoImVuZHJhdyIhPT10aGlzLnJlYWRJZGVudGlmaWVyKCkuZ2V0VGV4dCgpKXM9dGhpcy5yZWFkVG8ociktci5sZW5ndGg7ZWxzZSBmb3IoO3RoaXMucDw9dGhpcy5OOyl7aWYodGhpcy5ybWF0Y2gobikpcmV0dXJuIHQ9dGhpcy5wLGk9PT1zPyh0aGlzLnJhd0JlZ2luQXQ9LTEsbmV3IG50KHRoaXMuaW5wdXQsaSx0LGUsdGhpcy5maWxlKSk6KHRoaXMucD1zLG5ldyBjdCh0aGlzLmlucHV0LGkscyx0aGlzLmZpbGUpKTtpZih0aGlzLnJtYXRjaChyKSlicmVhazt0aGlzLnArK310aHJvdyB0aGlzLmVycm9yKCJyYXcgIi5jb25jYXQodGhpcy5zbmFwc2hvdCh0aGlzLnJhd0JlZ2luQXQpLCIgbm90IGNsb3NlZCIpLGkpfSxGLnByb3RvdHlwZS5yZWFkTGlxdWlkVGFnVG9rZW5zPWZ1bmN0aW9uKGUpe3ZvaWQgMD09PWUmJihlPW1yKTtmb3IodmFyIHQ9W107dGhpcy5wPHRoaXMuTjspe3ZhciByPXRoaXMucmVhZExpcXVpZFRhZ1Rva2VuKGUpO3ImJnQucHVzaChyKX1yZXR1cm4gdH0sRi5wcm90b3R5cGUucmVhZExpcXVpZFRhZ1Rva2VuPWZ1bmN0aW9uKGUpe3ZhciB0LHI7aWYodGhpcy5za2lwQmxhbmsoKSwhdGhpcy5lbmQoKSlyZXR1cm4gdD10aGlzLnAsdGhpcy5yZWFkVG9EZWxpbWl0ZXIoIlxuIikscj10aGlzLnAsbmV3IFV0KHRoaXMuaW5wdXQsdCxyLGUsdGhpcy5maWxlKX0sRi5wcm90b3R5cGUuZXJyb3I9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9dGhpcy5wKSxuZXcgaWUoZSxuZXcgdnQodGhpcy5pbnB1dCx0LHRoaXMuTix0aGlzLmZpbGUpKX0sRi5wcm90b3R5cGUuYXNzZXJ0PWZ1bmN0aW9uKGUsdCxyKXtpZighZSl0aHJvdyB0aGlzLmVycm9yKCJmdW5jdGlvbiI9PXR5cGVvZiB0P3QoKTp0LHIpfSxGLnByb3RvdHlwZS5zbmFwc2hvdD1mdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwPT09ZSYmKGU9dGhpcy5wKSxKU09OLnN0cmluZ2lmeSgoZT10aGlzLmlucHV0LnNsaWNlKGUsdGhpcy5OKSx0PTMyLGUubGVuZ3RoPnQ/ZS5zbGljZSgwLHQtMykrIi4uLiI6ZSkpO3ZhciB0fSxGLnByb3RvdHlwZS5yZWFkV29yZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRJZGVudGlmaWVyKCl9LEYucHJvdG90eXBlLnJlYWRJZGVudGlmaWVyPWZ1bmN0aW9uKCl7dGhpcy5za2lwQmxhbmsoKTtmb3IodmFyIGU9dGhpcy5wOyF0aGlzLmVuZCgpJiZPZSh0aGlzLnBlZWsoKSk7KSsrdGhpcy5wO3JldHVybiBuZXcgdnQodGhpcy5pbnB1dCxlLHRoaXMucCx0aGlzLmZpbGUpfSxGLnByb3RvdHlwZS5yZWFkVGFnTmFtZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNraXBCbGFuaygpLCIjIj09PXRoaXMuaW5wdXRbdGhpcy5wXT90aGlzLmlucHV0LnNsaWNlKHRoaXMucCwrK3RoaXMucCk6dGhpcy5yZWFkSWRlbnRpZmllcigpLmdldFRleHQoKX0sRi5wcm90b3R5cGUucmVhZEhhc2hlcz1mdW5jdGlvbihlKXtmb3IodmFyIHQ9W107Oyl7dmFyIHI9dGhpcy5yZWFkSGFzaChlKTtpZighcilyZXR1cm4gdDt0LnB1c2gocil9fSxGLnByb3RvdHlwZS5yZWFkSGFzaD1mdW5jdGlvbihlKXt0aGlzLnNraXBCbGFuaygpLCIsIj09PXRoaXMucGVlaygpJiYrK3RoaXMucDt2YXIgdCxyPXRoaXMucCxuPXRoaXMucmVhZElkZW50aWZpZXIoKTtpZihuLnNpemUoKSlyZXR1cm4gdGhpcy5za2lwQmxhbmsoKSxlPWU/Ij0iOiI6Iix0aGlzLnBlZWsoKT09PWUmJigrK3RoaXMucCx0PXRoaXMucmVhZFZhbHVlKCkpLG5ldyBFdCh0aGlzLmlucHV0LHIsdGhpcy5wLG4sdCx0aGlzLmZpbGUpfSxGLnByb3RvdHlwZS5yZW1haW5pbmc9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pbnB1dC5zbGljZSh0aGlzLnAsdGhpcy5OKX0sRi5wcm90b3R5cGUuYWR2YW5jZT1mdW5jdGlvbihlKXt0aGlzLnArPWU9dm9pZCAwPT09ZT8xOmV9LEYucHJvdG90eXBlLmVuZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnA+PXRoaXMuTn0sRi5wcm90b3R5cGUucmVhZFRvPWZ1bmN0aW9uKGUpe2Zvcig7dGhpcy5wPHRoaXMuTjspaWYoKyt0aGlzLnAsdGhpcy5ybWF0Y2goZSkpcmV0dXJuIHRoaXMucDtyZXR1cm4tMX0sRi5wcm90b3R5cGUucmVhZFZhbHVlPWZ1bmN0aW9uKCl7dGhpcy5za2lwQmxhbmsoKTtmb3IodmFyIGU9dGhpcy5wLHQ9dGhpcy5yZWFkTGl0ZXJhbCgpfHx0aGlzLnJlYWRRdW90ZWQoKXx8dGhpcy5yZWFkUmFuZ2UoKXx8dGhpcy5yZWFkTnVtYmVyKCkscj1bXTs7KXtpZigiWyI9PT10aGlzLnBlZWsoKSl7dGhpcy5wKys7dmFyIG49dGhpcy5yZWFkVmFsdWUoKXx8bmV3IHZ0KHRoaXMuaW5wdXQsdGhpcy5wLHRoaXMucCx0aGlzLmZpbGUpO3RoaXMuYXNzZXJ0KC0xIT09dGhpcy5yZWFkVG8oIl0iKSwiWyBub3QgY2xvc2VkIil9ZWxzZXtpZighdCYmIXIubGVuZ3RoKWlmKChuPXRoaXMucmVhZElkZW50aWZpZXIoKSkuc2l6ZSgpKXtyLnB1c2gobik7Y29udGludWV9aWYoIi4iIT09dGhpcy5wZWVrKCl8fCIuIj09PXRoaXMucGVlaygxKSlicmVhaztpZih0aGlzLnArKywhKG49dGhpcy5yZWFkSWRlbnRpZmllcigpKS5zaXplKCkpYnJlYWt9ci5wdXNoKG4pfXJldHVybiByLmxlbmd0aD9uZXcgenQodCxyLHRoaXMuaW5wdXQsZSx0aGlzLnApOnR9LEYucHJvdG90eXBlLnJlYWROdW1iZXI9ZnVuY3Rpb24oKXt0aGlzLnNraXBCbGFuaygpO3ZhciBlLHQ9ITEscj0hMSxuPTA7Zm9yKDY0JnRoaXMucGVla1R5cGUoKSYmbisrO3RoaXMucCtuPD10aGlzLk47KXtpZigzMiZ0aGlzLnBlZWtUeXBlKG4pKXI9ITA7ZWxzZXtpZigiLiIhPT10aGlzLnBlZWsobil8fCIuIj09PXRoaXMucGVlayhuKzEpKWJyZWFrO2lmKHR8fCFyKXJldHVybjt0PSEwfW4rK31pZihyJiYhT2UodGhpcy5wZWVrKG4pKSlyZXR1cm4gZT1uZXcgcHQodGhpcy5pbnB1dCx0aGlzLnAsdGhpcy5wK24sdGhpcy5maWxlKSx0aGlzLmFkdmFuY2UobiksZX0sRi5wcm90b3R5cGUucmVhZExpdGVyYWw9ZnVuY3Rpb24oKXt0aGlzLnNraXBCbGFuaygpO3ZhciBlLHQ9dGhpcy5tYXRjaFRyaWUodGhpcy5saXRlcmFsVHJpZSk7aWYoLTEhPT10KXJldHVybiBlPW5ldyBtdCh0aGlzLmlucHV0LHRoaXMucCx0LHRoaXMuZmlsZSksdGhpcy5wPXQsZX0sRi5wcm90b3R5cGUucmVhZFJhbmdlPWZ1bmN0aW9uKCl7dGhpcy5za2lwQmxhbmsoKTt2YXIgZSx0LHI9dGhpcy5wO2lmKCIoIj09PXRoaXMucGVlaygpKXJldHVybisrdGhpcy5wLGU9dGhpcy5yZWFkVmFsdWVPclRocm93KCksdGhpcy5wKz0yLHQ9dGhpcy5yZWFkVmFsdWVPclRocm93KCksKyt0aGlzLnAsbmV3IEN0KHRoaXMuaW5wdXQscix0aGlzLnAsZSx0LHRoaXMuZmlsZSl9LEYucHJvdG90eXBlLnJlYWRWYWx1ZU9yVGhyb3c9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLHQ9dGhpcy5yZWFkVmFsdWUoKTtyZXR1cm4gdGhpcy5hc3NlcnQodCxmdW5jdGlvbigpe3JldHVybiJ1bmV4cGVjdGVkIHRva2VuICIuY29uY2F0KGUuc25hcHNob3QoKSwiLCB2YWx1ZSBleHBlY3RlZCIpfSksdH0sRi5wcm90b3R5cGUucmVhZFF1b3RlZD1mdW5jdGlvbigpe3RoaXMuc2tpcEJsYW5rKCk7dmFyIGU9dGhpcy5wO2lmKDgmdGhpcy5wZWVrVHlwZSgpKXsrK3RoaXMucDtmb3IodmFyIHQ9ITE7dGhpcy5wPHRoaXMuTiYmKCsrdGhpcy5wLHRoaXMuaW5wdXRbdGhpcy5wLTFdIT09dGhpcy5pbnB1dFtlXXx8dCk7KXQ/dD0hMToiXFwiPT09dGhpcy5pbnB1dFt0aGlzLnAtMV0mJih0PSEwKTtyZXR1cm4gbmV3IEF0KHRoaXMuaW5wdXQsZSx0aGlzLnAsdGhpcy5maWxlKX19LEYucHJvdG90eXBlLnJlYWRGaWxlTmFtZVRlbXBsYXRlPWZ1bmN0aW9uKHQpe3ZhciByLG4saTtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cj10Lm91dHB1dERlbGltaXRlckxlZnQsbj1bIiwiLCIgIixyXSxpPW5ldyBTZXQobiksZS5sYWJlbD0xO2Nhc2UgMTpyZXR1cm4gdGhpcy5wPHRoaXMuTiYmIWkuaGFzKHRoaXMucGVlaygpKT9bNCx0aGlzLm1hdGNoKHIpP3RoaXMucmVhZE91dHB1dFRva2VuKHQpOnRoaXMucmVhZEhUTUxUb2tlbihuKV06WzMsM107Y2FzZSAyOnJldHVybiBlLnNlbnQoKSxbMywxXTtjYXNlIDM6cmV0dXJuWzJdfX0pfSxGLnByb3RvdHlwZS5tYXRjaD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKylpZihlW3RdIT09dGhpcy5pbnB1dFt0aGlzLnArdF0pcmV0dXJuITE7cmV0dXJuITB9LEYucHJvdG90eXBlLnJtYXRjaD1mdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKylpZihlW2UubGVuZ3RoLTEtdF0hPT10aGlzLmlucHV0W3RoaXMucC0xLXRdKXJldHVybiExO3JldHVybiEwfSxGLnByb3RvdHlwZS5wZWVrVHlwZT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wKyhlPXZvaWQgMD09PWU/MDplKT49dGhpcy5OPzA6cFt0aGlzLmlucHV0LmNoYXJDb2RlQXQodGhpcy5wK2UpXX0sRi5wcm90b3R5cGUucGVlaz1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5wKyhlPXZvaWQgMD09PWU/MDplKT49dGhpcy5OPyIiOnRoaXMuaW5wdXRbdGhpcy5wK2VdfSxGLnByb3RvdHlwZS5za2lwQmxhbms9ZnVuY3Rpb24oKXtmb3IoO3RoaXMucGVla1R5cGUoKSZUZTspKyt0aGlzLnB9O3ZhciBUcj1GO2Z1bmN0aW9uIEYoZSx0LHIsbil7dm9pZCAwPT09dCYmKHQ9bXIub3BlcmF0b3JzKSx0aGlzLmlucHV0PWUsdGhpcy5maWxlPXIsdGhpcy5yYW5nZT1uLHRoaXMucmF3QmVnaW5BdD0tMSx0aGlzLnA9bj9uWzBdOjAsdGhpcy5OPW4/blsxXTplLmxlbmd0aCx0aGlzLm9wVHJpZT1QZSh0KSx0aGlzLmxpdGVyYWxUcmllPVBlKE1lKX1Pci5wcm90b3R5cGUub249ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5oYW5kbGVyc1tlXT10LHRoaXN9LE9yLnByb3RvdHlwZS50cmlnZ2VyPWZ1bmN0aW9uKGUsdCl7ZT10aGlzLmhhbmRsZXJzW2VdO3JldHVybiEhZSYmKGUuY2FsbCh0aGlzLHQpLCEwKX0sT3IucHJvdG90eXBlLnN0YXJ0PWZ1bmN0aW9uKCl7dmFyIGUsdDtmb3IodGhpcy50cmlnZ2VyKCJzdGFydCIpOyF0aGlzLnN0b3BSZXF1ZXN0ZWQmJihlPXRoaXMudG9rZW5zLnNoaWZ0KCkpOyl0aGlzLnRyaWdnZXIoInRva2VuIixlKXx8V3IoZSkmJnRoaXMudHJpZ2dlcigidGFnOiIuY29uY2F0KGUubmFtZSksZSl8fCh0PXRoaXMucGFyc2VUb2tlbihlLHRoaXMudG9rZW5zKSx0aGlzLnRyaWdnZXIoInRlbXBsYXRlIix0KSk7cmV0dXJuIHRoaXMuc3RvcFJlcXVlc3RlZHx8dGhpcy50cmlnZ2VyKCJlbmQiKSx0aGlzfSxPci5wcm90b3R5cGUuc3RvcD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnN0b3BSZXF1ZXN0ZWQ9ITAsdGhpc307dmFyIHhyPU9yO2Z1bmN0aW9uIE9yKGUsdCl7dGhpcy5oYW5kbGVycz17fSx0aGlzLnN0b3BSZXF1ZXN0ZWQ9ITEsdGhpcy50b2tlbnM9ZSx0aGlzLnBhcnNlVG9rZW49dH1mdW5jdGlvbiBfcihlKXt0aGlzLnRva2VuPWV9cyhTcix6cj1fcik7dmFyIHpyLHE9U3I7ZnVuY3Rpb24gU3IoZSx0LHIpe3ZhciBuPXpyLmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gbi5uYW1lPWUubmFtZSxuLmxpcXVpZD1yLG4udG9rZW5pemVyPWUudG9rZW5pemVyLG59RnIucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0KXt2YXIgcixuLGkscyxvLGEsdSxjLGw7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnI9e30sZS5sYWJlbD0xO2Nhc2UgMTplLnRyeXMucHVzaChbMSw4LDksMTBdKSxuPU8oT2JqZWN0LmtleXModGhpcy5oYXNoKSksaT1uLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiBpLmRvbmU/WzMsN106KHM9aS52YWx1ZSxvPXIsYT1zLHZvaWQgMCE9PXRoaXMuaGFzaFtzXT9bMywzXToodT0hMCxbMyw1XSkpO2Nhc2UgMzpyZXR1cm5bNCxSKHRoaXMuaGFzaFtzXSx0KV07Y2FzZSA0OnU9ZS5zZW50KCksZS5sYWJlbD01O2Nhc2UgNTpvW2FdPXUsZS5sYWJlbD02O2Nhc2UgNjpyZXR1cm4gaT1uLm5leHQoKSxbMywyXTtjYXNlIDc6cmV0dXJuWzMsMTBdO2Nhc2UgODpyZXR1cm4gYz1lLnNlbnQoKSxjPXtlcnJvcjpjfSxbMywxMF07Y2FzZSA5OnRyeXtpJiYhaS5kb25lJiYobD1uLnJldHVybikmJmwuY2FsbChuKX1maW5hbGx5e2lmKGMpdGhyb3cgYy5lcnJvcn1yZXR1cm5bN107Y2FzZSAxMDpyZXR1cm5bMixyXX19KX07dmFyIFJyPUZyO2Z1bmN0aW9uIEZyKGUsdCl7dGhpcy5oYXNoPXt9O3ZhciByLG4sZT1uZXcgVHIoZSx7fSk7dHJ5e2Zvcih2YXIgaT1PKGUucmVhZEhhc2hlcyh0KSkscz1pLm5leHQoKTshcy5kb25lO3M9aS5uZXh0KCkpe3ZhciBvPXMudmFsdWU7dGhpcy5oYXNoW28ubmFtZS5jb250ZW50XT1vLnZhbHVlfX1jYXRjaChlKXtyPXtlcnJvcjplfX1maW5hbGx5e3RyeXtzJiYhcy5kb25lJiYobj1pLnJldHVybikmJm4uY2FsbChpKX1maW5hbGx5e2lmKHIpdGhyb3cgci5lcnJvcn19fUxyLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHUsYyxsLGgscCxmO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpuPVtdLGUubGFiZWw9MTtjYXNlIDE6ZS50cnlzLnB1c2goWzEsOCw5LDEwXSksaT1PKHRoaXMuYXJncykscz1pLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiBzLmRvbmU/WzMsN106ZyhvPXMudmFsdWUpPyh1PShhPW4pLnB1c2gsYz1bb1swXV0sWzQsUihvWzFdLHIpXSk6WzMsNF07Y2FzZSAzOnJldHVybiB1LmFwcGx5KGEsW2MuY29uY2F0KFtlLnNlbnQoKV0pXSksWzMsNl07Y2FzZSA0OnJldHVybiBoPShsPW4pLnB1c2gsWzQsUihvLHIpXTtjYXNlIDU6aC5hcHBseShsLFtlLnNlbnQoKV0pLGUubGFiZWw9NjtjYXNlIDY6cmV0dXJuIHM9aS5uZXh0KCksWzMsMl07Y2FzZSA3OnJldHVyblszLDEwXTtjYXNlIDg6cmV0dXJuIHA9ZS5zZW50KCkscD17ZXJyb3I6cH0sWzMsMTBdO2Nhc2UgOTp0cnl7cyYmIXMuZG9uZSYmKGY9aS5yZXR1cm4pJiZmLmNhbGwoaSl9ZmluYWxseXtpZihwKXRocm93IHAuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTA6cmV0dXJuWzQsdGhpcy5oYW5kbGVyLmFwcGx5KHtjb250ZXh0OnIsbGlxdWlkOnRoaXMubGlxdWlkfSx2KFt0XSxkKG4pLCExKSldO2Nhc2UgMTE6cmV0dXJuWzIsZS5zZW50KCldfX0pfTt2YXIgcXI9THI7ZnVuY3Rpb24gTHIoZSx0LHIsbil7dGhpcy5uYW1lPWUsdGhpcy5oYW5kbGVyPWModCk/dDpjKG51bGw9PXQ/dm9pZCAwOnQuaGFuZGxlcik/dC5oYW5kbGVyOkosdGhpcy5yYXc9IWModCkmJiEobnVsbD09dHx8IXQucmF3KSx0aGlzLmFyZ3M9cix0aGlzLmxpcXVpZD1ufUVyLnByb3RvdHlwZS52YWx1ZT1mdW5jdGlvbih0LHIpe3ZhciBuLGkscyxvLGE7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiByPXJ8fHQub3B0cy5sZW5pZW50SWYmJjA8dGhpcy5maWx0ZXJzLmxlbmd0aCYmImRlZmF1bHQiPT09dGhpcy5maWx0ZXJzWzBdLm5hbWUsWzQsdGhpcy5pbml0aWFsLmV2YWx1YXRlKHQscildO2Nhc2UgMTpuPWUuc2VudCgpLGUubGFiZWw9MjtjYXNlIDI6ZS50cnlzLnB1c2goWzIsNyw4LDldKSxpPU8odGhpcy5maWx0ZXJzKSxzPWkubmV4dCgpLGUubGFiZWw9MztjYXNlIDM6cmV0dXJuIHMuZG9uZT9bMyw2XTpbNCxzLnZhbHVlLnJlbmRlcihuLHQpXTtjYXNlIDQ6bj1lLnNlbnQoKSxlLmxhYmVsPTU7Y2FzZSA1OnJldHVybiBzPWkubmV4dCgpLFszLDNdO2Nhc2UgNjpyZXR1cm5bMyw5XTtjYXNlIDc6cmV0dXJuIG89ZS5zZW50KCksbz17ZXJyb3I6b30sWzMsOV07Y2FzZSA4OnRyeXtzJiYhcy5kb25lJiYoYT1pLnJldHVybikmJmEuY2FsbChpKX1maW5hbGx5e2lmKG8pdGhyb3cgby5lcnJvcn1yZXR1cm5bN107Y2FzZSA5OnJldHVyblsyLG5dfX0pfSxFci5wcm90b3R5cGUuZ2V0RmlsdGVyPWZ1bmN0aW9uKGUsdCl7dmFyIHI9ZS5maWx0ZXJzW3RdO3JldHVybiBfKHJ8fCFlLm9wdGlvbnMuc3RyaWN0RmlsdGVycyxmdW5jdGlvbigpe3JldHVybiJ1bmRlZmluZWQgZmlsdGVyOiAiLmNvbmNhdCh0KX0pLHJ9O3ZhciBMPUVyO2Z1bmN0aW9uIEVyKGUscil7dmFyIG49dGhpcyxlPSh0aGlzLmZpbHRlcnM9W10sInN0cmluZyI9PXR5cGVvZiBlP25ldyBUcihlLHIub3B0aW9ucy5vcGVyYXRvcnMpLnJlYWRGaWx0ZXJlZFZhbHVlKCk6ZSk7dGhpcy5pbml0aWFsPWUuaW5pdGlhbCx0aGlzLmZpbHRlcnM9ZS5maWx0ZXJzLm1hcChmdW5jdGlvbihlKXt2YXIgdD1lLm5hbWUsZT1lLmFyZ3M7cmV0dXJuIG5ldyBxcih0LG4uZ2V0RmlsdGVyKHIsdCksZSxyKX0pfXMoanIsRHI9X3IpLGpyLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbjtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsdGhpcy52YWx1ZS52YWx1ZSh0LCExKV07Y2FzZSAxOnJldHVybiBuPWUuc2VudCgpLHIud3JpdGUobiksWzJdfX0pfTt2YXIgRHIsTnI9anI7ZnVuY3Rpb24ganIoZSx0KXt2YXIgcixuPXRoaXMsbj1Eci5jYWxsKHRoaXMsZSl8fHRoaXMsZT1uZXcgVHIoZS5pbnB1dCx0Lm9wdGlvbnMub3BlcmF0b3JzLGUuZmlsZSxlLmNvbnRlbnRSYW5nZSksZT0obi52YWx1ZT1uZXcgTChlLnJlYWRGaWx0ZXJlZFZhbHVlKCksdCksbi52YWx1ZS5maWx0ZXJzKSxpPXQub3B0aW9ucy5vdXRwdXRFc2NhcGU7cmV0dXJuIG51bGwhPShyPWVbZS5sZW5ndGgtMV0pJiZyLnJhd3x8IWl8fGUucHVzaChuZXcgcXIodG9TdHJpbmcuY2FsbChpKSxpLFtdLHQpKSxufXMoQXIsTXI9X3IpLEFyLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oZSx0KXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVybiB0LndyaXRlKHRoaXMuc3RyKSxbMl19KX07dmFyIE1yLFByLFZyPUFyO2Z1bmN0aW9uIEFyKGUpe3ZhciB0PU1yLmNhbGwodGhpcyxlKXx8dGhpcztyZXR1cm4gdC5zdHI9ZS5nZXRDb250ZW50KCksdH0oaT1Qcj1Qcnx8e30pLlBhcnRpYWxzPSJwYXJ0aWFscyIsaS5MYXlvdXRzPSJsYXlvdXRzIixpLlJvb3Q9InJvb3QiO0JyLnByb3RvdHlwZS5sb29rdXA9ZnVuY3Rpb24odCxyLG4saSl7dmFyIHMsbyxhLHUsYyxsLGgscDtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cz10aGlzLm9wdGlvbnMuZnMsbz10aGlzLm9wdGlvbnNbcl0sZS5sYWJlbD0xO2Nhc2UgMTplLnRyeXMucHVzaChbMSw4LDksMTBdKSxhPU8odGhpcy5jYW5kaWRhdGVzKHQsbyxpLHIhPT1Qci5Sb290KSksdT1hLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiB1LmRvbmU/WzMsN106KGM9dS52YWx1ZSxuPyhsPXMuZXhpc3RzU3luYyhjKSxbMyw1XSk6WzMsM10pO2Nhc2UgMzpyZXR1cm5bNCxzLmV4aXN0cyhjKV07Y2FzZSA0Omw9ZS5zZW50KCksZS5sYWJlbD01O2Nhc2UgNTppZihsKXJldHVyblsyLGNdO2UubGFiZWw9NjtjYXNlIDY6cmV0dXJuIHU9YS5uZXh0KCksWzMsMl07Y2FzZSA3OnJldHVyblszLDEwXTtjYXNlIDg6cmV0dXJuIGg9ZS5zZW50KCksaD17ZXJyb3I6aH0sWzMsMTBdO2Nhc2UgOTp0cnl7dSYmIXUuZG9uZSYmKHA9YS5yZXR1cm4pJiZwLmNhbGwoYSl9ZmluYWxseXtpZihoKXRocm93IGguZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTA6dGhyb3cgdGhpcy5sb29rdXBFcnJvcih0LG8pfX0pfSxCci5wcm90b3R5cGUuY2FuZGlkYXRlcz1mdW5jdGlvbih0LHIsbixpKXt2YXIgcyxvLGEsdSxjLGwsaCxwLGYsZCx2LGcseTtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6aWYobz10aGlzLm9wdGlvbnMscz1vLmZzLG89by5leHRuYW1lLCF0aGlzLnNob3VsZExvYWRSZWxhdGl2ZSh0KXx8IW4pcmV0dXJuWzMsOF07cD1zLnJlc29sdmUodGhpcy5kaXJuYW1lKG4pLHQsbyksZS5sYWJlbD0xO2Nhc2UgMTplLnRyeXMucHVzaChbMSw2LDcsOF0pLGE9TyhyKSx1PWEubmV4dCgpLGUubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHUuZG9uZT9bMyw1XTooaD11LnZhbHVlLGkmJiF0aGlzLmNvbnRhaW5zKGgscCk/WzMsNF06WzQscF0pO2Nhc2UgMzpyZXR1cm4gZS5zZW50KCksWzMsNV07Y2FzZSA0OnJldHVybiB1PWEubmV4dCgpLFszLDJdO2Nhc2UgNTpyZXR1cm5bMyw4XTtjYXNlIDY6cmV0dXJuIGQ9ZS5zZW50KCksZD17ZXJyb3I6ZH0sWzMsOF07Y2FzZSA3OnRyeXt1JiYhdS5kb25lJiYodj1hLnJldHVybikmJnYuY2FsbChhKX1maW5hbGx5e2lmKGQpdGhyb3cgZC5lcnJvcn1yZXR1cm5bN107Y2FzZSA4OmUudHJ5cy5wdXNoKFs4LDEzLDE0LDE1XSksYz1PKHIpLGw9Yy5uZXh0KCksZS5sYWJlbD05O2Nhc2UgOTpyZXR1cm4gbC5kb25lP1szLDEyXTooaD1sLnZhbHVlLHA9cy5yZXNvbHZlKGgsdCxvKSxpJiYhdGhpcy5jb250YWlucyhoLHApP1szLDExXTpbNCxwXSk7Y2FzZSAxMDplLnNlbnQoKSxlLmxhYmVsPTExO2Nhc2UgMTE6cmV0dXJuIGw9Yy5uZXh0KCksWzMsOV07Y2FzZSAxMjpyZXR1cm5bMywxNV07Y2FzZSAxMzpyZXR1cm4gZz1lLnNlbnQoKSxnPXtlcnJvcjpnfSxbMywxNV07Y2FzZSAxNDp0cnl7bCYmIWwuZG9uZSYmKHk9Yy5yZXR1cm4pJiZ5LmNhbGwoYyl9ZmluYWxseXtpZihnKXRocm93IGcuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTU6cmV0dXJuIHZvaWQgMD09PXMuZmFsbGJhY2s/WzMsMTddOnZvaWQgMD09PShmPXMuZmFsbGJhY2sodCkpP1szLDE3XTpbNCxmXTtjYXNlIDE2OmUuc2VudCgpLGUubGFiZWw9MTc7Y2FzZSAxNzpyZXR1cm5bMl19fSl9LEJyLnByb3RvdHlwZS5kaXJuYW1lPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMub3B0aW9ucy5mcztyZXR1cm4gXyh0LmRpcm5hbWUsImBmcy5kaXJuYW1lYCBpcyByZXF1aXJlZCBmb3IgcmVsYXRpdmUgcmVmZXJlbmNlIiksdC5kaXJuYW1lKGUpfSxCci5wcm90b3R5cGUubG9va3VwRXJyb3I9ZnVuY3Rpb24oZSx0KXt2YXIgcj1uZXcgRXJyb3IoIkVOT0VOVCIpO3JldHVybiByLm1lc3NhZ2U9J0VOT0VOVDogRmFpbGVkIHRvIGxvb2t1cCAiJy5jb25jYXQoZSwnIiBpbiAiJykuY29uY2F0KHQsJyInKSxyLmNvZGU9IkVOT0VOVCIscn07dmFyIElyPUJyO2Z1bmN0aW9uIEJyKGUpe3ZhciB0Oyh0aGlzLm9wdGlvbnM9ZSkucmVsYXRpdmVSZWZlcmVuY2U/KF8oZT1lLmZzLnNlcCwiYGZzLnNlcGAgaXMgcmVxdWlyZWQgZm9yIHJlbGF0aXZlIHJlZmVyZW5jZSIpLHQ9bmV3IFJlZ0V4cChbIi4iK2UsIi4uIitlLCIuLyIsIi4uLyJdLm1hcChmdW5jdGlvbihlKXtyZXR1cm4gZS5yZXBsYWNlKC9bLS9cXF4kKis/LigpfFtcXXt9XS9nLCJcXCQmIil9KS5qb2luKCJ8IikpLHRoaXMuc2hvdWxkTG9hZFJlbGF0aXZlPWZ1bmN0aW9uKGUpe3JldHVybiB0LnRlc3QoZSl9KTp0aGlzLnNob3VsZExvYWRSZWxhdGl2ZT1mdW5jdGlvbihlKXtyZXR1cm4hMX0sdGhpcy5jb250YWlucz10aGlzLm9wdGlvbnMuZnMuY29udGFpbnN8fGZ1bmN0aW9uKCl7cmV0dXJuITB9fUhyLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbihlLHQpe2U9bmV3IFRyKGUsdGhpcy5saXF1aWQub3B0aW9ucy5vcGVyYXRvcnMsdCkucmVhZFRvcExldmVsVG9rZW5zKHRoaXMubGlxdWlkLm9wdGlvbnMpO3JldHVybiB0aGlzLnBhcnNlVG9rZW5zKGUpfSxIci5wcm90b3R5cGUucGFyc2VUb2tlbnM9ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LHI9W107dD1lLnNoaWZ0KCk7KXIucHVzaCh0aGlzLnBhcnNlVG9rZW4odCxlKSk7cmV0dXJuIHJ9LEhyLnByb3RvdHlwZS5wYXJzZVRva2VuPWZ1bmN0aW9uKHQsZSl7dHJ5e3ZhciByO3JldHVybiBXcih0KT8oXyhyPXRoaXMubGlxdWlkLnRhZ3NbdC5uYW1lXSwndGFnICInLmNvbmNhdCh0Lm5hbWUsJyIgbm90IGZvdW5kJykpLG5ldyByKHQsZSx0aGlzLmxpcXVpZCkpOlFyKHQpP25ldyBOcih0LHRoaXMubGlxdWlkKTpuZXcgVnIodCl9Y2F0Y2goZSl7aWYodGUuaXMoZSkpdGhyb3cgZTt0aHJvdyBuZXcgYWUoZSx0KX19LEhyLnByb3RvdHlwZS5wYXJzZVN0cmVhbT1mdW5jdGlvbihlKXt2YXIgcj10aGlzO3JldHVybiBuZXcgeHIoZSxmdW5jdGlvbihlLHQpe3JldHVybiByLnBhcnNlVG9rZW4oZSx0KX0pfSxIci5wcm90b3R5cGUuX3BhcnNlRmlsZUNhY2hlZD1mdW5jdGlvbih0LHIsbixpKXt2YXIgcyxvLGEsdSxjLGw7cmV0dXJuIHZvaWQgMD09PW4mJihuPVByLlJvb3QpLHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiBzPXRoaXMuY2FjaGUsbz10aGlzLmxvYWRlci5zaG91bGRMb2FkUmVsYXRpdmUodCk/aSsiLCIrdDpuKyI6Iit0LFs0LHMucmVhZChvKV07Y2FzZSAxOnJldHVybihsPWUuc2VudCgpKT9bMixsXTooYT10aGlzLl9wYXJzZUZpbGUodCxyLG4saSkscj9bNCxhXTpbMywzXSk7Y2FzZSAyOnJldHVybiBjPWUuc2VudCgpLFszLDRdO2Nhc2UgMzpjPXcoYSksZS5sYWJlbD00O2Nhc2UgNDp1PWMscy53cml0ZShvLHUpLGUubGFiZWw9NTtjYXNlIDU6cmV0dXJuIGUudHJ5cy5wdXNoKFs1LDcsLDhdKSxbNCx1XTtjYXNlIDY6cmV0dXJuWzIsZS5zZW50KCldO2Nhc2UgNzp0aHJvdyBsPWUuc2VudCgpLHMucmVtb3ZlKG8pLGw7Y2FzZSA4OnJldHVyblsyXX19KX0sSHIucHJvdG90eXBlLl9wYXJzZUZpbGU9ZnVuY3Rpb24odCxyLG4saSl7dmFyIHMsbyxhLHU7cmV0dXJuIHZvaWQgMD09PW4mJihuPVByLlJvb3QpLHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LHRoaXMubG9hZGVyLmxvb2t1cCh0LG4scixpKV07Y2FzZSAxOnJldHVybihzPWUuc2VudCgpLGE9KG89dGhpcy5saXF1aWQpLnBhcnNlLHIpPyh1PXRoaXMuZnMucmVhZEZpbGVTeW5jKHMpLFszLDRdKTpbMywyXTtjYXNlIDI6cmV0dXJuWzQsdGhpcy5mcy5yZWFkRmlsZShzKV07Y2FzZSAzOnU9ZS5zZW50KCksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm5bMixhLmFwcGx5KG8sW3Usc10pXX19KX07dmFyIENyPUhyO2Z1bmN0aW9uIEhyKGUpe3RoaXMubGlxdWlkPWUsdGhpcy5jYWNoZT10aGlzLmxpcXVpZC5vcHRpb25zLmNhY2hlLHRoaXMuZnM9dGhpcy5saXF1aWQub3B0aW9ucy5mcyx0aGlzLnBhcnNlRmlsZT10aGlzLmNhY2hlP3RoaXMuX3BhcnNlRmlsZUNhY2hlZDp0aGlzLl9wYXJzZUZpbGUsdGhpcy5sb2FkZXI9bmV3IElyKHRoaXMubGlxdWlkLm9wdGlvbnMpfWZ1bmN0aW9uIEtyKGUpe3JldHVybiEhKEUoZSkmbC5Ub2tlbktpbmQuRGVsaW1pdGVkKX1mdW5jdGlvbiBVcihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLk9wZXJhdG9yfWZ1bmN0aW9uICRyKGUpe3JldHVybiBFKGUpPT09bC5Ub2tlbktpbmQuSFRNTH1mdW5jdGlvbiBRcihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLk91dHB1dH1mdW5jdGlvbiBXcihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLlRhZ31mdW5jdGlvbiBZcihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLlF1b3RlZH1mdW5jdGlvbiBKcihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLlByb3BlcnR5QWNjZXNzfWZ1bmN0aW9uIFpyKGUpe3JldHVybiBFKGUpPT09bC5Ub2tlbktpbmQuUmFuZ2V9ZnVuY3Rpb24gRShlKXtyZXR1cm4gZT9lLmtpbmQ6LTF9KGk9bC5Ub2tlbktpbmR8fChsLlRva2VuS2luZD17fSkpW2kuTnVtYmVyPTFdPSJOdW1iZXIiLGlbaS5MaXRlcmFsPTJdPSJMaXRlcmFsIixpW2kuVGFnPTRdPSJUYWciLGlbaS5PdXRwdXQ9OF09Ik91dHB1dCIsaVtpLkhUTUw9MTZdPSJIVE1MIixpW2kuRmlsdGVyPTMyXT0iRmlsdGVyIixpW2kuSGFzaD02NF09Ikhhc2giLGlbaS5Qcm9wZXJ0eUFjY2Vzcz0xMjhdPSJQcm9wZXJ0eUFjY2VzcyIsaVtpLldvcmQ9MjU2XT0iV29yZCIsaVtpLlJhbmdlPTUxMl09IlJhbmdlIixpW2kuUXVvdGVkPTEwMjRdPSJRdW90ZWQiLGlbaS5PcGVyYXRvcj0yMDQ4XT0iT3BlcmF0b3IiLGlbaS5GaWx0ZXJlZFZhbHVlPTQwOTZdPSJGaWx0ZXJlZFZhbHVlIixpW2kuRGVsaW1pdGVkPTEyXT0iRGVsaW1pdGVkIjt2YXIgR3IsaT1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxpc0RlbGltaXRlZFRva2VuOktyLGlzT3BlcmF0b3JUb2tlbjpVcixpc0hUTUxUb2tlbjokcixpc091dHB1dFRva2VuOlFyLGlzVGFnVG9rZW46V3IsaXNRdW90ZWRUb2tlbjpZcixpc0xpdGVyYWxUb2tlbjpmdW5jdGlvbihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLkxpdGVyYWx9LGlzTnVtYmVyVG9rZW46ZnVuY3Rpb24oZSl7cmV0dXJuIEUoZSk9PT1sLlRva2VuS2luZC5OdW1iZXJ9LGlzUHJvcGVydHlBY2Nlc3NUb2tlbjpKcixpc1dvcmRUb2tlbjpmdW5jdGlvbihlKXtyZXR1cm4gRShlKT09PWwuVG9rZW5LaW5kLldvcmR9LGlzUmFuZ2VUb2tlbjpacn0pLFhyPShELnByb3RvdHlwZS5nZXRSZWdpc3Rlcj1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5yZWdpc3RlcnNbZV09dGhpcy5yZWdpc3RlcnNbZV18fHt9fSxELnByb3RvdHlwZS5zZXRSZWdpc3Rlcj1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLnJlZ2lzdGVyc1tlXT10fSxELnByb3RvdHlwZS5zYXZlUmVnaXN0ZXI9ZnVuY3Rpb24oKXtmb3IodmFyIHQ9dGhpcyxlPVtdLHI9MDtyPGFyZ3VtZW50cy5sZW5ndGg7cisrKWVbcl09YXJndW1lbnRzW3JdO3JldHVybiBlLm1hcChmdW5jdGlvbihlKXtyZXR1cm5bZSx0LmdldFJlZ2lzdGVyKGUpXX0pfSxELnByb3RvdHlwZS5yZXN0b3JlUmVnaXN0ZXI9ZnVuY3Rpb24oZSl7dmFyIHI9dGhpcztyZXR1cm4gZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciBlPWQoZSwyKSx0PWVbMF0sZT1lWzFdO3JldHVybiByLnNldFJlZ2lzdGVyKHQsZSl9KX0sRC5wcm90b3R5cGUuZ2V0QWxsPWZ1bmN0aW9uKCl7cmV0dXJuIHYoW3RoaXMuZ2xvYmFscyx0aGlzLmVudmlyb25tZW50c10sZCh0aGlzLnNjb3BlcyksITEpLnJlZHVjZShmdW5jdGlvbihlLHQpe3JldHVybiBUKGUsdCl9LHt9KX0sRC5wcm90b3R5cGUuZ2V0PWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldFN5bmMoZSl9LEQucHJvdG90eXBlLmdldFN5bmM9ZnVuY3Rpb24oZSl7cmV0dXJuIGsodGhpcy5fZ2V0KGUpKX0sRC5wcm90b3R5cGUuX2dldD1mdW5jdGlvbih0KXt2YXIgcjtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuIHI9dGhpcy5maW5kU2NvcGUodFswXSksWzQsdGhpcy5fZ2V0RnJvbVNjb3BlKHIsdCldO2Nhc2UgMTpyZXR1cm5bMixlLnNlbnQoKV19fSl9LEQucHJvdG90eXBlLmdldEZyb21TY29wZT1mdW5jdGlvbihlLHQpe3JldHVybiBrKHRoaXMuX2dldEZyb21TY29wZShlLHQpKX0sRC5wcm90b3R5cGUuX2dldEZyb21TY29wZT1mdW5jdGlvbih0LHIsbil7dmFyIGk7cmV0dXJuIHZvaWQgMD09PW4mJihuPXRoaXMuc3RyaWN0VmFyaWFibGVzKSx4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDp1KHIpJiYocj1yLnNwbGl0KCIuIikpLGk9MCxlLmxhYmVsPTE7Y2FzZSAxOnJldHVybiBpPHIubGVuZ3RoP1s0LGZ1bmN0aW9uKGUsdCxyKXtpZihoKGU9ZnVuY3Rpb24gZSh0KXtyZXR1cm4gdCYmYyh0LnRvTGlxdWlkKT9lKHQudG9MaXF1aWQoKSk6dH0oZSkpKXJldHVybiBlO2lmKGcoZSkmJnQ8MClyZXR1cm4gZVtlLmxlbmd0aCsgK3RdO3I9ZnVuY3Rpb24oZSx0LHIpe2lmKCFyfHxPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChlLHQpfHxlIGluc3RhbmNlb2YgbylyZXR1cm4gZVt0XX0oZSx0LHIpO2lmKHZvaWQgMD09PXImJmUgaW5zdGFuY2VvZiBvKXJldHVybiBlLmxpcXVpZE1ldGhvZE1pc3NpbmcodCk7aWYoYyhyKSlyZXR1cm4gci5jYWxsKGUpO3tpZigic2l6ZSI9PT10KXJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZS5oYXNPd25Qcm9wZXJ0eSgic2l6ZSIpfHx2b2lkIDAhPT1lLnNpemU/ZS5zaXplOmcoZSl8fHUoZSk/ZS5sZW5ndGg6Im9iamVjdCI9PXR5cGVvZiBlP09iamVjdC5rZXlzKGUpLmxlbmd0aDp2b2lkIDB9KGUpO2lmKCJmaXJzdCI9PT10KXJldHVybiBmdW5jdGlvbihlKXtyZXR1cm4gZyhlKT9lWzBdOmUuZmlyc3R9KGUpO2lmKCJsYXN0Ij09PXQpcmV0dXJuIGZ1bmN0aW9uKGUpe3JldHVybiBnKGUpP2VbZS5sZW5ndGgtMV06ZS5sYXN0fShlKX1yZXR1cm4gcn0odCxyW2ldLHRoaXMub3duUHJvcGVydHlPbmx5KV06WzMsNF07Y2FzZSAyOmlmKHQ9ZS5zZW50KCksbiYmdm9pZCAwPT09dCl0aHJvdyBuZXcgZ2Uoci5zbGljZSgwLGkrMSkuam9pbigiLiIpKTtlLmxhYmVsPTM7Y2FzZSAzOnJldHVybiBpKyssWzMsMV07Y2FzZSA0OnJldHVyblsyLHRdfX0pfSxELnByb3RvdHlwZS5wdXNoPWZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLnNjb3Blcy5wdXNoKGUpfSxELnByb3RvdHlwZS5wb3A9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5zY29wZXMucG9wKCl9LEQucHJvdG90eXBlLmJvdHRvbT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnNjb3Blc1swXX0sRC5wcm90b3R5cGUuZmluZFNjb3BlPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdD10aGlzLnNjb3Blcy5sZW5ndGgtMTswPD10O3QtLSl7dmFyIHI9dGhpcy5zY29wZXNbdF07aWYoZSBpbiByKXJldHVybiByfXJldHVybiBlIGluIHRoaXMuZW52aXJvbm1lbnRzP3RoaXMuZW52aXJvbm1lbnRzOnRoaXMuZ2xvYmFsc30sRCk7ZnVuY3Rpb24gRChlLHQscil7dmFyIG47dm9pZCAwPT09ZSYmKGU9e30pLHZvaWQgMD09PXQmJih0PW1yKSx2b2lkIDA9PT1yJiYocj17fSksdGhpcy5zY29wZXM9W3t9XSx0aGlzLnJlZ2lzdGVycz17fSx0aGlzLnN5bmM9ISFyLnN5bmMsdGhpcy5vcHRzPXQsdGhpcy5nbG9iYWxzPW51bGwhPShuPXIuZ2xvYmFscyk/bjp0Lmdsb2JhbHMsdGhpcy5lbnZpcm9ubWVudHM9ZSx0aGlzLnN0cmljdFZhcmlhYmxlcz1udWxsIT0obj1yLnN0cmljdFZhcmlhYmxlcyk/bjp0aGlzLm9wdHMuc3RyaWN0VmFyaWFibGVzLHRoaXMub3duUHJvcGVydHlPbmx5PW51bGwhPShlPXIub3duUHJvcGVydHlPbmx5KT9lOnQub3duUHJvcGVydHlPbmx5fShOPUdyPUdyfHx7fSlbTi5PVVRQVVQ9MF09Ik9VVFBVVCIsTltOLlNUT1JFPTFdPSJTVE9SRSI7dmFyIE49dChNYXRoLmFicyksZW49dChNYXRoLm1heCksdG49dChNYXRoLm1pbikscm49dChNYXRoLmNlaWwpLG5uPXQoZnVuY3Rpb24oZSx0LHIpe3JldHVybihyPXZvaWQgMD09PXI/ITE6cik/TWF0aC5mbG9vcihlL3QpOmUvdH0pLHNuPXQoTWF0aC5mbG9vciksb249dChmdW5jdGlvbihlLHQpe3JldHVybiBlLXR9KSxhbj10KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUldH0pLHVuPXQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZSp0fSk7Tj1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCxhYnM6TixhdF9sZWFzdDplbixhdF9tb3N0OnRuLGNlaWw6cm4sZGl2aWRlZF9ieTpubixmbG9vcjpzbixtaW51czpvbixtb2R1bG86YW4sdGltZXM6dW4scm91bmQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdm9pZCAwPT09dCYmKHQ9MCksZT15KGUpLHQ9eSh0KSx0PU1hdGgucG93KDEwLHQpLE1hdGgucm91bmQoZSp0KS90fSxwbHVzOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIGU9eShlKSx0PXkodCksTnVtYmVyKGUpK051bWJlcih0KX19KSxlbj1PYmplY3QuZnJlZXplKHtfX3Byb3RvX186bnVsbCx1cmxfZGVjb2RlOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUpLnNwbGl0KCIrIikubWFwKGRlY29kZVVSSUNvbXBvbmVudCkuam9pbigiICIpfSx1cmxfZW5jb2RlOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUpLnNwbGl0KCIgIikubWFwKGVuY29kZVVSSUNvbXBvbmVudCkuam9pbigiKyIpfX0pLHRuPXQoZnVuY3Rpb24oZSx0KXtyZXR1cm4geihlKS5qb2luKHZvaWQgMD09PXQ/IiAiOnQpfSkscm49dChmdW5jdGlvbihlKXtyZXR1cm4gZyhlKT9VKGUpOiIifSksbm49dChmdW5jdGlvbihlKXtyZXR1cm4gZyhlKT9lWzBdOiIifSksc249dChmdW5jdGlvbihlKXtyZXR1cm4gdihbXSxkKHooZSkpLCExKS5yZXZlcnNlKCl9KTtmdW5jdGlvbiBjbihlLHQpe3JldHVybiB2b2lkIDA9PT10JiYodD1bXSksZT15KGUpLHQ9eih0KS5tYXAoeSkseihlKS5jb25jYXQodCl9b249T2JqZWN0LmZyZWV6ZSh7X19wcm90b19fOm51bGwsam9pbjp0bixsYXN0OnJuLGZpcnN0Om5uLHJldmVyc2U6c24sc29ydDpmdW5jdGlvbih0LHIpe3ZhciBuLGkscyxvLGEsdSxjLGwsaCxwO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpuPVtdLGUubGFiZWw9MTtjYXNlIDE6ZS50cnlzLnB1c2goWzEsOCw5LDEwXSksaT1PKHooeSh0KSkpLHM9aS5uZXh0KCksZS5sYWJlbD0yO2Nhc2UgMjpyZXR1cm4gcy5kb25lP1szLDddOihvPXMudmFsdWUsdT0oYT1uKS5wdXNoLGM9W29dLHI/WzQsdGhpcy5jb250ZXh0Ll9nZXRGcm9tU2NvcGUobyxmKHIpLnNwbGl0KCIuIiksITEpXTpbMyw0XSk7Y2FzZSAzOnJldHVybiBsPWUuc2VudCgpLFszLDVdO2Nhc2UgNDpsPW8sZS5sYWJlbD01O2Nhc2UgNTp1LmFwcGx5KGEsW2MuY29uY2F0KFtsXSldKSxlLmxhYmVsPTY7Y2FzZSA2OnJldHVybiBzPWkubmV4dCgpLFszLDJdO2Nhc2UgNzpyZXR1cm5bMywxMF07Y2FzZSA4OnJldHVybiBoPWUuc2VudCgpLGg9e2Vycm9yOmh9LFszLDEwXTtjYXNlIDk6dHJ5e3MmJiFzLmRvbmUmJihwPWkucmV0dXJuKSYmcC5jYWxsKGkpfWZpbmFsbHl7aWYoaCl0aHJvdyBoLmVycm9yfXJldHVybls3XTtjYXNlIDEwOnJldHVyblsyLG4uc29ydChmdW5jdGlvbihlLHQpe2U9ZVsxXSx0PXRbMV07cmV0dXJuIGU8dD8tMTp0PGU/MTowfSkubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlWzBdfSldfX0pfSxzb3J0X25hdHVyYWw6ZnVuY3Rpb24oZSx0KXtlPXkoZSk7dmFyIHI9Zih0KSx0PXZvaWQgMD09PXQ/WjpmdW5jdGlvbihlLHQpe3JldHVybiBaKGVbcl0sdFtyXSl9O3JldHVybiB2KFtdLGQoeihlKSksITEpLnNvcnQodCl9LHNpemU6ZnVuY3Rpb24oZSl7cmV0dXJuIGUmJmUubGVuZ3RofHwwfSxtYXA6ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHUsYyxsO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpuPVtdLGUubGFiZWw9MTtjYXNlIDE6ZS50cnlzLnB1c2goWzEsNiw3LDhdKSxpPU8oeih5KHQpKSkscz1pLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiBzLmRvbmU/WzMsNV06KHU9cy52YWx1ZSxhPShvPW4pLnB1c2gsWzQsdGhpcy5jb250ZXh0Ll9nZXRGcm9tU2NvcGUodSxmKHIpLCExKV0pO2Nhc2UgMzphLmFwcGx5KG8sW2Uuc2VudCgpXSksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm4gcz1pLm5leHQoKSxbMywyXTtjYXNlIDU6cmV0dXJuWzMsOF07Y2FzZSA2OnJldHVybiB1PWUuc2VudCgpLGM9e2Vycm9yOnV9LFszLDhdO2Nhc2UgNzp0cnl7cyYmIXMuZG9uZSYmKGw9aS5yZXR1cm4pJiZsLmNhbGwoaSl9ZmluYWxseXtpZihjKXRocm93IGMuZXJyb3J9cmV0dXJuWzddO2Nhc2UgODpyZXR1cm5bMixuXX19KX0sc3VtOmZ1bmN0aW9uKHQscil7dmFyIG4saSxzLG8sYSx1LGMsbCxoO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpuPTAsZS5sYWJlbD0xO2Nhc2UgMTplLnRyeXMucHVzaChbMSw4LDksMTBdKSxpPU8oeih5KHQpKSkscz1pLm5leHQoKSxlLmxhYmVsPTI7Y2FzZSAyOnJldHVybiBzLmRvbmU/WzMsN106KG89cy52YWx1ZSxhPU51bWJlcixyP1s0LHRoaXMuY29udGV4dC5fZ2V0RnJvbVNjb3BlKG8sZihyKSwhMSldOlszLDRdKTtjYXNlIDM6cmV0dXJuIHU9ZS5zZW50KCksWzMsNV07Y2FzZSA0OnU9byxlLmxhYmVsPTU7Y2FzZSA1OmM9YS5hcHBseSh2b2lkIDAsW3VdKSxuKz1OdW1iZXIuaXNOYU4oYyk/MDpjLGUubGFiZWw9NjtjYXNlIDY6cmV0dXJuIHM9aS5uZXh0KCksWzMsMl07Y2FzZSA3OnJldHVyblszLDEwXTtjYXNlIDg6cmV0dXJuIGM9ZS5zZW50KCksbD17ZXJyb3I6Y30sWzMsMTBdO2Nhc2UgOTp0cnl7cyYmIXMuZG9uZSYmKGg9aS5yZXR1cm4pJiZoLmNhbGwoaSl9ZmluYWxseXtpZihsKXRocm93IGwuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTA6cmV0dXJuWzIsbl19fSl9LGNvbXBhY3Q6ZnVuY3Rpb24oZSl7cmV0dXJuIHooZT15KGUpKS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIWgoeShlKSl9KX0sY29uY2F0OmNuLHB1c2g6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gY24oZSxbdF0pfSxzbGljZTpmdW5jdGlvbihlLHQscil7cmV0dXJuIHZvaWQgMD09PXImJihyPTEpLGgoZT15KGUpKT9bXTooZyhlKXx8KGU9ZihlKSksdD10PDA/ZS5sZW5ndGgrdDp0LGUuc2xpY2UodCx0K3IpKX0sd2hlcmU6ZnVuY3Rpb24odCxyLG4pe3ZhciBpLHMsbyxhLHUsYyxsLGgscD10aGlzO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDppPVtdLHQ9eih5KHQpKSxlLmxhYmVsPTE7Y2FzZSAxOmUudHJ5cy5wdXNoKFsxLDYsNyw4XSkscz1PKHQpLG89cy5uZXh0KCksZS5sYWJlbD0yO2Nhc2UgMjpyZXR1cm4gby5kb25lP1szLDVdOihjPW8udmFsdWUsdT0oYT1pKS5wdXNoLFs0LHRoaXMuY29udGV4dC5fZ2V0RnJvbVNjb3BlKGMsZihyKS5zcGxpdCgiLiIpLCExKV0pO2Nhc2UgMzp1LmFwcGx5KGEsW2Uuc2VudCgpXSksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm4gbz1zLm5leHQoKSxbMywyXTtjYXNlIDU6cmV0dXJuWzMsOF07Y2FzZSA2OnJldHVybiBjPWUuc2VudCgpLGw9e2Vycm9yOmN9LFszLDhdO2Nhc2UgNzp0cnl7byYmIW8uZG9uZSYmKGg9cy5yZXR1cm4pJiZoLmNhbGwocyl9ZmluYWxseXtpZihsKXRocm93IGwuZXJyb3J9cmV0dXJuWzddO2Nhc2UgODpyZXR1cm5bMix0LmZpbHRlcihmdW5jdGlvbihlLHQpe3JldHVybiB2b2lkIDA9PT1uP29yKGlbdF0scC5jb250ZXh0KTpiKG4pP24uZXF1YWxzKGlbdF0pOmlbdF09PT1ufSldfX0pfSx1bmlxOmZ1bmN0aW9uKGUpe2U9eShlKTt2YXIgdD17fTtyZXR1cm4oZXx8W10pLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4hQi5jYWxsKHQsU3RyaW5nKGUpKSYmKHRbU3RyaW5nKGUpXT0hMCl9KX0sc2FtcGxlOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHZvaWQgMD09PXQmJih0PTEpLGgoZT15KGUpKT9bXTooZT12KFtdLGQoZT1nKGUpP2U6ZihlKSksITEpLnNvcnQoZnVuY3Rpb24oKXtyZXR1cm4gTWF0aC5yYW5kb20oKS0uNX0pLDE9PT10P2VbMF06ZS5zbGljZSgwLHQpKX19KTtmdW5jdGlvbiBsbihlLHQpe3ZhciByO3JldHVybiBIKHQpP3Q6KHI9bmV3IERhdGUoZS50b0xvY2FsZVN0cmluZygiZW4tVVMiLHt0aW1lWm9uZToiVVRDIn0pKSxlPW5ldyBEYXRlKGUudG9Mb2NhbGVTdHJpbmcoImVuLVVTIix7dGltZVpvbmU6dH0pKSwoci5nZXRUaW1lKCktZS5nZXRUaW1lKCkpLzZlNCl9YW49T2JqZWN0LmZyZWV6ZSh7X19wcm90b19fOm51bGwsZGF0ZTpmdW5jdGlvbihlLHQscil7dmFyIG4saSxzPXRoaXMuY29udGV4dC5vcHRzO3JldHVybiBlPXkoZSksdD1oKHQ9eSh0KSk/cy5kYXRlRm9ybWF0OmYodCksbj0ibm93Ij09PWV8fCJ0b2RheSI9PT1lP25ldyBEYXRlOkgoZSk/bmV3IERhdGUoMWUzKmUpOnUoZSk/L15cZCskLy50ZXN0KGUpP25ldyBEYXRlKDFlMyorZSk6cy5wcmVzZXJ2ZVRpbWV6b25lcz9YZS5jcmVhdGVEYXRlRml4ZWRUb1RpbWV6b25lKGUpOm5ldyBEYXRlKGUpOmUsISgoaT1uKWluc3RhbmNlb2YgRGF0ZXx8aSBpbnN0YW5jZW9mIFhlKXx8aXNOYU4oaS5nZXRUaW1lKCkpP2U6KHZvaWQgMCE9PXI/bj1uZXcgWGUobixsbihuLHIpKTpuIGluc3RhbmNlb2YgWGV8fHZvaWQgMD09PXMudGltZXpvbmVPZmZzZXR8fChuPW5ldyBYZShuLGxuKG4scy50aW1lem9uZU9mZnNldCkpKSxaZShuLHQpKX19KTt2YXIgaG4sdW49T2JqZWN0LmZyZWV6ZSh7X19wcm90b19fOm51bGwsYXBwZW5kOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIF8oMj09PWFyZ3VtZW50cy5sZW5ndGgsImFwcGVuZCBleHBlY3QgMiBhcmd1bWVudHMiKSxmKGUpK2YodCl9LHByZXBlbmQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gXygyPT09YXJndW1lbnRzLmxlbmd0aCwicHJlcGVuZCBleHBlY3QgMiBhcmd1bWVudHMiKSxmKHQpK2YoZSl9LGxzdHJpcDpmdW5jdGlvbihlLHQpe3JldHVybiB0Pyh0PUcoZih0KSksZihlKS5yZXBsYWNlKG5ldyBSZWdFeHAoIl5bIi5jb25jYXQodCwiXSsiKSwiZyIpLCIiKSk6ZihlKS5yZXBsYWNlKC9eXHMrLywiIil9LGRvd25jYXNlOmZ1bmN0aW9uKGUpe3JldHVybiBmKGUpLnRvTG93ZXJDYXNlKCl9LHVwY2FzZTpmdW5jdGlvbihlKXtyZXR1cm4gZihlKS50b1VwcGVyQ2FzZSgpfSxyZW1vdmU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZihlKS5zcGxpdChTdHJpbmcodCkpLmpvaW4oIiIpfSxyZW1vdmVfZmlyc3Q6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZihlKS5yZXBsYWNlKFN0cmluZyh0KSwiIil9LHJlbW92ZV9sYXN0OmZ1bmN0aW9uKGUsdCl7dmFyIGU9ZihlKSx0PVN0cmluZyh0KSxyPWUubGFzdEluZGV4T2YodCk7cmV0dXJuLTE9PT1yP2U6ZS5zdWJzdHJpbmcoMCxyKStlLnN1YnN0cmluZyhyK3QubGVuZ3RoKX0scnN0cmlwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/KHQ9RyhmKHQpKSxmKGUpLnJlcGxhY2UobmV3IFJlZ0V4cCgiWyIuY29uY2F0KHQsIl0rJCIpLCJnIiksIiIpKTpmKGUpLnJlcGxhY2UoL1xzKyQvLCIiKX0sc3BsaXQ6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIHI9ZihlKS5zcGxpdChTdHJpbmcodCkpO3IubGVuZ3RoJiYiIj09PXJbci5sZW5ndGgtMV07KXIucG9wKCk7cmV0dXJuIHJ9LHN0cmlwOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQ/KHQ9RyhmKHQpKSxmKGUpLnJlcGxhY2UobmV3IFJlZ0V4cCgiXlsiLmNvbmNhdCh0LCJdKyIpLCJnIiksIiIpLnJlcGxhY2UobmV3IFJlZ0V4cCgiWyIuY29uY2F0KHQsIl0rJCIpLCJnIiksIiIpKTpmKGUpLnRyaW0oKX0sc3RyaXBfbmV3bGluZXM6ZnVuY3Rpb24oZSl7cmV0dXJuIGYoZSkucmVwbGFjZSgvXHI/XG4vZ20sIiIpfSxjYXBpdGFsaXplOmZ1bmN0aW9uKGUpe3JldHVybihlPWYoZSkpLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpK2Uuc2xpY2UoMSkudG9Mb3dlckNhc2UoKX0scmVwbGFjZTpmdW5jdGlvbihlLHQscil7cmV0dXJuIGYoZSkuc3BsaXQoU3RyaW5nKHQpKS5qb2luKHIpfSxyZXBsYWNlX2ZpcnN0OmZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gZihlKS5yZXBsYWNlKFN0cmluZyh0KSxyKX0scmVwbGFjZV9sYXN0OmZ1bmN0aW9uKGUsdCxyKXt2YXIgZT1mKGUpLHQ9U3RyaW5nKHQpLG49ZS5sYXN0SW5kZXhPZih0KTtyZXR1cm4tMT09PW4/ZToocj1TdHJpbmcociksZS5zdWJzdHJpbmcoMCxuKStyK2Uuc3Vic3RyaW5nKG4rdC5sZW5ndGgpKX0sdHJ1bmNhdGU6ZnVuY3Rpb24oZSx0LHIpe3JldHVybiB2b2lkIDA9PT10JiYodD01MCksdm9pZCAwPT09ciYmKHI9Ii4uLiIpLChlPWYoZSkpLmxlbmd0aDw9dD9lOmUuc3Vic3RyaW5nKDAsdC1yLmxlbmd0aCkrcn0sdHJ1bmNhdGV3b3JkczpmdW5jdGlvbihlLHQscil7dm9pZCAwPT09dCYmKHQ9MTUpLHZvaWQgMD09PXImJihyPSIuLi4iKTt2YXIgbj0oZT1mKGUpLnNwbGl0KC9ccysvKSkuc2xpY2UoMCx0PXQ8PTA/MTp0KS5qb2luKCIgIik7cmV0dXJuIGUubGVuZ3RoPj10JiYobis9ciksbn19KSxwbj1UKFQoVChUKFQoVChUKHt9LHlyKSxOKSxlbiksb24pLGFuKSx1bikse2pzb246ZnIscmF3OnIsZGVmYXVsdDpmdW5jdGlvbihlLHQpe2Zvcih2YXIgcj1bXSxuPTI7bjxhcmd1bWVudHMubGVuZ3RoO24rKylyW24tMl09YXJndW1lbnRzW25dO3JldHVybiBnKGU9eShlKSl8fHUoZSk/ZS5sZW5ndGg/ZTp0OighMSE9PWV8fCFuZXcgTWFwKHIpLmdldCgiYWxsb3dfZmFsc2UiKSkmJihhcihlLHRoaXMuY29udGV4dCk/dDplKX19KSx0bj0ocyhmbixobj1xKSxmbi5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQpe3ZhciByLG47cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiByPXQuYm90dG9tKCksbj10aGlzLmtleSxbNCx0aGlzLnZhbHVlLnZhbHVlKHQsdGhpcy5saXF1aWQub3B0aW9ucy5sZW5pZW50SWYpXTtjYXNlIDE6cmV0dXJuIHJbbl09ZS5zZW50KCksWzJdfX0pfSxmbik7ZnVuY3Rpb24gZm4oZSx0LHIpe2U9aG4uY2FsbCh0aGlzLGUsdCxyKXx8dGhpcztyZXR1cm4gZS5rZXk9ZS50b2tlbml6ZXIucmVhZElkZW50aWZpZXIoKS5jb250ZW50LGUudG9rZW5pemVyLmFzc2VydChlLmtleSwiZXhwZWN0ZWQgdmFyaWFibGUgbmFtZSIpLGUudG9rZW5pemVyLnNraXBCbGFuaygpLGUudG9rZW5pemVyLmFzc2VydCgiPSI9PT1lLnRva2VuaXplci5wZWVrKCksJ2V4cGVjdGVkICI9IicpLGUudG9rZW5pemVyLmFkdmFuY2UoKSxlLnZhbHVlPW5ldyBMKGUudG9rZW5pemVyLnJlYWRGaWx0ZXJlZFZhbHVlKCksZS5saXF1aWQpLGV9dmFyIGRuLHZuPVsib2Zmc2V0IiwibGltaXQiLCJyZXZlcnNlZCJdLHJuPShzKGduLGRuPXEpLGduLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHUsYyxsLGgscCxmO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm4gbj10aGlzLmxpcXVpZC5yZW5kZXJlcixzPVZlLFs0LFIodGhpcy5jb2xsZWN0aW9uLHQpXTtjYXNlIDE6cmV0dXJuKGk9cy5hcHBseSh2b2lkIDAsW2Uuc2VudCgpXSkpLmxlbmd0aD9bMywzXTpbNCxuLnJlbmRlclRlbXBsYXRlcyh0aGlzLmVsc2VUZW1wbGF0ZXMsdCxyKV07Y2FzZSAyOnJldHVybiBlLnNlbnQoKSxbMl07Y2FzZSAzOnJldHVybiBvPSJjb250aW51ZS0iK3RoaXMudmFyaWFibGUrIi0iK3RoaXMuY29sbGVjdGlvbi5nZXRUZXh0KCksdC5wdXNoKHtjb250aW51ZTp0LmdldFJlZ2lzdGVyKG8pfSksWzQsdGhpcy5oYXNoLnJlbmRlcih0KV07Y2FzZSA0OmE9ZS5zZW50KCksdC5wb3AoKSx1PXRoaXMubGlxdWlkLm9wdGlvbnMub3JkZXJlZEZpbHRlclBhcmFtZXRlcnM/T2JqZWN0LmtleXMoYSkuZmlsdGVyKGZ1bmN0aW9uKGUpe3JldHVybiB2bi5pbmNsdWRlcyhlKX0pOnZuLmZpbHRlcihmdW5jdGlvbihlKXtyZXR1cm4gdm9pZCAwIT09YVtlXX0pLGk9dS5yZWR1Y2UoZnVuY3Rpb24oZSx0KXt2YXIgcjtyZXR1cm4ib2Zmc2V0Ij09PXQ/KHI9YS5vZmZzZXQsZS5zbGljZShyKSk6ImxpbWl0Ij09PXQ/KHI9YS5saW1pdCxlLnNsaWNlKDAscikpOnYoW10sZChlKSwhMSkucmV2ZXJzZSgpfSxpKSx0LnNldFJlZ2lzdGVyKG8sKGEub2Zmc2V0fHwwKStpLmxlbmd0aCksdT17Zm9ybG9vcDpuZXcgRWUoaS5sZW5ndGgsdGhpcy5jb2xsZWN0aW9uLmdldFRleHQoKSx0aGlzLnZhcmlhYmxlKX0sdC5wdXNoKHUpLGUubGFiZWw9NTtjYXNlIDU6ZS50cnlzLnB1c2goWzUsMTAsMTEsMTJdKSxjPU8oaSksbD1jLm5leHQoKSxlLmxhYmVsPTY7Y2FzZSA2OnJldHVybiBsLmRvbmU/WzMsOV06KGg9bC52YWx1ZSx1W3RoaXMudmFyaWFibGVdPWgsWzQsbi5yZW5kZXJUZW1wbGF0ZXModGhpcy50ZW1wbGF0ZXMsdCxyKV0pO2Nhc2UgNzppZihlLnNlbnQoKSxyLmJyZWFrKXJldHVybiByLmJyZWFrPSExLFszLDldO3IuY29udGludWU9ITEsdS5mb3Jsb29wLm5leHQoKSxlLmxhYmVsPTg7Y2FzZSA4OnJldHVybiBsPWMubmV4dCgpLFszLDZdO2Nhc2UgOTpyZXR1cm5bMywxMl07Y2FzZSAxMDpyZXR1cm4gaD1lLnNlbnQoKSxwPXtlcnJvcjpofSxbMywxMl07Y2FzZSAxMTp0cnl7bCYmIWwuZG9uZSYmKGY9Yy5yZXR1cm4pJiZmLmNhbGwoYyl9ZmluYWxseXtpZihwKXRocm93IHAuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTI6cmV0dXJuIHQucG9wKCksWzJdfX0pfSxnbik7ZnVuY3Rpb24gZ24oZSx0LHIpe3ZhciBuLGk9ZG4uY2FsbCh0aGlzLGUsdCxyKXx8dGhpcyxyPWkudG9rZW5pemVyLnJlYWRJZGVudGlmaWVyKCkscz1pLnRva2VuaXplci5yZWFkSWRlbnRpZmllcigpLG89aS50b2tlbml6ZXIucmVhZFZhbHVlKCk7aWYoIXIuc2l6ZSgpfHwiaW4iIT09cy5jb250ZW50fHwhbyl0aHJvdyBuZXcgRXJyb3IoImlsbGVnYWwgdGFnOiAiLmNvbmNhdChlLmdldFRleHQoKSkpO2kudmFyaWFibGU9ci5jb250ZW50LGkuY29sbGVjdGlvbj1vLGkuaGFzaD1uZXcgUnIoaS50b2tlbml6ZXIucmVtYWluaW5nKCkpLGkudGVtcGxhdGVzPVtdLGkuZWxzZVRlbXBsYXRlcz1bXTt2YXIgYT1pLmxpcXVpZC5wYXJzZXIucGFyc2VTdHJlYW0odCkub24oInN0YXJ0IixmdW5jdGlvbigpe3JldHVybiBuPWkudGVtcGxhdGVzfSkub24oInRhZzplbHNlIixmdW5jdGlvbigpe3JldHVybiBuPWkuZWxzZVRlbXBsYXRlc30pLm9uKCJ0YWc6ZW5kZm9yIixmdW5jdGlvbigpe3JldHVybiBhLnN0b3AoKX0pLm9uKCJ0ZW1wbGF0ZSIsZnVuY3Rpb24oZSl7cmV0dXJuIG4ucHVzaChlKX0pLm9uKCJlbmQiLGZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJ0YWcgIi5jb25jYXQoZS5nZXRUZXh0KCksIiBub3QgY2xvc2VkIikpfSk7cmV0dXJuIGEuc3RhcnQoKSxpfXMobW4seW49cSksbW4ucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0KXt2YXIgcjtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsdGhpcy5saXF1aWQucmVuZGVyZXIucmVuZGVyVGVtcGxhdGVzKHRoaXMudGVtcGxhdGVzLHQpXTtjYXNlIDE6cmV0dXJuIHI9ZS5zZW50KCksdC5ib3R0b20oKVt0aGlzLnZhcmlhYmxlXT1yLFsyXX19KX0sbW4ucHJvdG90eXBlLnJlYWRWYXJpYWJsZU5hbWU9ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnRva2VuaXplci5yZWFkSWRlbnRpZmllcigpLmNvbnRlbnQ7aWYoZSlyZXR1cm4gZTtlPXRoaXMudG9rZW5pemVyLnJlYWRRdW90ZWQoKTtpZihlKXJldHVybiBzcihlKTt0aHJvdyB0aGlzLnRva2VuaXplci5lcnJvcigiaW52YWxpZCBjYXB0dXJlIG5hbWUiKX07dmFyIHluLG5uPW1uO2Z1bmN0aW9uIG1uKGUsdCxyKXt2YXIgbj15bi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzO2ZvcihuLnRlbXBsYXRlcz1bXSxuLnZhcmlhYmxlPW4ucmVhZFZhcmlhYmxlTmFtZSgpO3QubGVuZ3RoOyl7dmFyIGk9dC5zaGlmdCgpO2lmKFdyKGkpJiYiZW5kY2FwdHVyZSI9PT1pLm5hbWUpcmV0dXJuIG47bi50ZW1wbGF0ZXMucHVzaChyLnBhcnNlci5wYXJzZVRva2VuKGksdCkpfXRocm93IG5ldyBFcnJvcigidGFnICIuY29uY2F0KGUuZ2V0VGV4dCgpLCIgbm90IGNsb3NlZCIpKX1zKHduLGJuPXEpLHduLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHUsYyxsLGgscCxmLGQsdixnO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm4gbj10aGlzLmxpcXVpZC5yZW5kZXJlcixzPXksWzQsdGhpcy52YWx1ZS52YWx1ZSh0LHQub3B0cy5sZW5pZW50SWYpXTtjYXNlIDE6aT1zLmFwcGx5KHZvaWQgMCxbZS5zZW50KCldKSxvPSExLGUubGFiZWw9MjtjYXNlIDI6ZS50cnlzLnB1c2goWzIsMTQsMTUsMTZdKSxhPU8odGhpcy5icmFuY2hlcyksdT1hLm5leHQoKSxlLmxhYmVsPTM7Y2FzZSAzOmlmKHUuZG9uZSlyZXR1cm5bMywxM107Yz11LnZhbHVlLGUubGFiZWw9NDtjYXNlIDQ6ZS50cnlzLnB1c2goWzQsMTAsMTEsMTJdKSx2PXZvaWQgMCxsPU8oYy52YWx1ZXMpLGg9bC5uZXh0KCksZS5sYWJlbD01O2Nhc2UgNTpyZXR1cm4gaC5kb25lP1szLDldOls0LFIoaC52YWx1ZSx0LHQub3B0cy5sZW5pZW50SWYpXTtjYXNlIDY6cmV0dXJuIHA9ZS5zZW50KCksaSE9PXA/WzMsOF06WzQsbi5yZW5kZXJUZW1wbGF0ZXMoYy50ZW1wbGF0ZXMsdCxyKV07Y2FzZSA3OnJldHVybiBlLnNlbnQoKSxvPSEwLFszLDldO2Nhc2UgODpyZXR1cm4gaD1sLm5leHQoKSxbMyw1XTtjYXNlIDk6cmV0dXJuWzMsMTJdO2Nhc2UgMTA6cmV0dXJuIHA9ZS5zZW50KCksdj17ZXJyb3I6cH0sWzMsMTJdO2Nhc2UgMTE6dHJ5e2gmJiFoLmRvbmUmJihnPWwucmV0dXJuKSYmZy5jYWxsKGwpfWZpbmFsbHl7aWYodil0aHJvdyB2LmVycm9yfXJldHVybls3XTtjYXNlIDEyOnJldHVybiB1PWEubmV4dCgpLFszLDNdO2Nhc2UgMTM6cmV0dXJuWzMsMTZdO2Nhc2UgMTQ6cmV0dXJuIGY9ZS5zZW50KCksZj17ZXJyb3I6Zn0sWzMsMTZdO2Nhc2UgMTU6dHJ5e3UmJiF1LmRvbmUmJihkPWEucmV0dXJuKSYmZC5jYWxsKGEpfWZpbmFsbHl7aWYoZil0aHJvdyBmLmVycm9yfXJldHVybls3XTtjYXNlIDE2OnJldHVybiBvP1szLDE4XTpbNCxuLnJlbmRlclRlbXBsYXRlcyh0aGlzLmVsc2VUZW1wbGF0ZXMsdCxyKV07Y2FzZSAxNzplLnNlbnQoKSxlLmxhYmVsPTE4O2Nhc2UgMTg6cmV0dXJuWzJdfX0pfTt2YXIgYm4sc249d247ZnVuY3Rpb24gd24oZSx0LHIpe3ZhciBuPWJuLmNhbGwodGhpcyxlLHQscil8fHRoaXMsaT0obi5icmFuY2hlcz1bXSxuLmVsc2VUZW1wbGF0ZXM9W10sbi52YWx1ZT1uZXcgTChuLnRva2VuaXplci5yZWFkRmlsdGVyZWRWYWx1ZSgpLG4ubGlxdWlkKSxuLmVsc2VUZW1wbGF0ZXM9W10sW10pLHM9MCxvPW4ubGlxdWlkLnBhcnNlci5wYXJzZVN0cmVhbSh0KS5vbigidGFnOndoZW4iLGZ1bmN0aW9uKGUpe2lmKCEoMDxzKSl7aT1bXTtmb3IodmFyIHQ9W107IWUudG9rZW5pemVyLmVuZCgpOyl0LnB1c2goZS50b2tlbml6ZXIucmVhZFZhbHVlT3JUaHJvdygpKSxlLnRva2VuaXplci5za2lwQmxhbmsoKSwiLCI9PT1lLnRva2VuaXplci5wZWVrKCk/ZS50b2tlbml6ZXIucmVhZFRvKCIsIik6ZS50b2tlbml6ZXIucmVhZFRvKCJvciIpO24uYnJhbmNoZXMucHVzaCh7dmFsdWVzOnQsdGVtcGxhdGVzOml9KX19KS5vbigidGFnOmVsc2UiLGZ1bmN0aW9uKCl7cysrLGk9bi5lbHNlVGVtcGxhdGVzfSkub24oInRhZzplbmRjYXNlIixmdW5jdGlvbigpe3JldHVybiBvLnN0b3AoKX0pLm9uKCJ0ZW1wbGF0ZSIsZnVuY3Rpb24oZSl7aT09PW4uZWxzZVRlbXBsYXRlcyYmMSE9PXN8fGkucHVzaChlKX0pLm9uKCJlbmQiLGZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKCJ0YWcgIi5jb25jYXQoZS5nZXRUZXh0KCksIiBub3QgY2xvc2VkIikpfSk7cmV0dXJuIG8uc3RhcnQoKSxufXMoVG4sa249cSksVG4ucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe307dmFyIGtuLHlyPVRuO2Z1bmN0aW9uIFRuKGUsdCxyKXtmb3IodmFyIG49a24uY2FsbCh0aGlzLGUsdCxyKXx8dGhpczt0Lmxlbmd0aDspe3ZhciBpPXQuc2hpZnQoKTtpZihXcihpKSYmImVuZGNvbW1lbnQiPT09aS5uYW1lKXJldHVybiBufXRocm93IG5ldyBFcnJvcigidGFnICIuY29uY2F0KGUuZ2V0VGV4dCgpLCIgbm90IGNsb3NlZCIpKX1zKE9uLHhuPXEpLE9uLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHUsYyxsLGgscCxmLGQsdixnLHksbSxiLHcsaztyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuIG49KGk9dGhpcykubGlxdWlkLGk9aS5oYXNoLFs0LFNuKHRoaXMuZmlsZSx0LG4pXTtjYXNlIDE6cmV0dXJuIF8ocz1lLnNlbnQoKSxmdW5jdGlvbigpe3JldHVybidpbGxlZ2FsIGZpbGUgcGF0aCAiJy5jb25jYXQocywnIicpfSksbz1uZXcgWHIoe30sdC5vcHRzLHtzeW5jOnQuc3luYyxnbG9iYWxzOnQuZ2xvYmFscyxzdHJpY3RWYXJpYWJsZXM6dC5zdHJpY3RWYXJpYWJsZXN9KSxhPW8uYm90dG9tKCksdT1ULGM9W2FdLFs0LGkucmVuZGVyKHQpXTtjYXNlIDI6cmV0dXJuKHUuYXBwbHkodm9pZCAwLGMuY29uY2F0KFtlLnNlbnQoKV0pKSx0aGlzLndpdGgpPyhmPXRoaXMud2l0aCxwPWYudmFsdWUsZj1mLmFsaWFzLGw9YSxoPWZ8fHMsWzQsUihwLHQpXSk6WzMsNF07Y2FzZSAzOmxbaF09ZS5zZW50KCksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm4gdGhpcy5mb3I/KHY9dGhpcy5mb3IscD12LnZhbHVlLGY9di5hbGlhcyx2PVZlLFs0LFIocCx0KV0pOlszLDE1XTtjYXNlIDU6ZD12LmFwcGx5KHZvaWQgMCxbZS5zZW50KCldKSxhLmZvcmxvb3A9bmV3IEVlKGQubGVuZ3RoLHAuZ2V0VGV4dCgpLGYpLGUubGFiZWw9NjtjYXNlIDY6ZS50cnlzLnB1c2goWzYsMTIsMTMsMTRdKSxnPU8oZCkseT1nLm5leHQoKSxlLmxhYmVsPTc7Y2FzZSA3OnJldHVybiB5LmRvbmU/WzMsMTFdOihtPXkudmFsdWUsYVtmXT1tLFs0LG4uX3BhcnNlUGFydGlhbEZpbGUocyxvLnN5bmMsdGhpcy5jdXJyZW50RmlsZSldKTtjYXNlIDg6cmV0dXJuIGI9ZS5zZW50KCksWzQsbi5yZW5kZXJlci5yZW5kZXJUZW1wbGF0ZXMoYixvLHIpXTtjYXNlIDk6ZS5zZW50KCksYS5mb3Jsb29wLm5leHQoKSxlLmxhYmVsPTEwO2Nhc2UgMTA6cmV0dXJuIHk9Zy5uZXh0KCksWzMsN107Y2FzZSAxMTpyZXR1cm5bMywxNF07Y2FzZSAxMjpyZXR1cm4gbT1lLnNlbnQoKSx3PXtlcnJvcjptfSxbMywxNF07Y2FzZSAxMzp0cnl7eSYmIXkuZG9uZSYmKGs9Zy5yZXR1cm4pJiZrLmNhbGwoZyl9ZmluYWxseXtpZih3KXRocm93IHcuZXJyb3J9cmV0dXJuWzddO2Nhc2UgMTQ6cmV0dXJuWzMsMThdO2Nhc2UgMTU6cmV0dXJuWzQsbi5fcGFyc2VQYXJ0aWFsRmlsZShzLG8uc3luYyx0aGlzLmN1cnJlbnRGaWxlKV07Y2FzZSAxNjpyZXR1cm4gYj1lLnNlbnQoKSxbNCxuLnJlbmRlcmVyLnJlbmRlclRlbXBsYXRlcyhiLG8scildO2Nhc2UgMTc6ZS5zZW50KCksZS5sYWJlbD0xODtjYXNlIDE4OnJldHVyblsyXX19KX07dmFyIHhuLE49T247ZnVuY3Rpb24gT24oZSx0LHIpe3ZhciBuPXhuLmNhbGwodGhpcyxlLHQscil8fHRoaXMsaT1uLnRva2VuaXplcjtmb3Iobi5maWxlPV9uKGksbi5saXF1aWQpLG4uY3VycmVudEZpbGU9ZS5maWxlOyFpLmVuZCgpOyl7aS5za2lwQmxhbmsoKTt2YXIgcz1pLnAsbz1pLnJlYWRJZGVudGlmaWVyKCk7aWYoKCJ3aXRoIj09PW8uY29udGVudHx8ImZvciI9PT1vLmNvbnRlbnQpJiYoaS5za2lwQmxhbmsoKSwiOiIhPT1pLnBlZWsoKSkpe3ZhciBhPWkucmVhZFZhbHVlKCk7aWYoYSl7dmFyIHU9aS5wLGM9dm9pZCAwOyJhcyI9PT1pLnJlYWRJZGVudGlmaWVyKCkuY29udGVudD9jPWkucmVhZElkZW50aWZpZXIoKTppLnA9dSxuW28uY29udGVudF09e3ZhbHVlOmEsYWxpYXM6YyYmYy5jb250ZW50fSxpLnNraXBCbGFuaygpLCIsIj09PWkucGVlaygpJiZpLmFkdmFuY2UoKTtjb250aW51ZX19aS5wPXM7YnJlYWt9cmV0dXJuIG4uaGFzaD1uZXcgUnIoaS5yZW1haW5pbmcoKSksbn1mdW5jdGlvbiBfbihlLHQpe3ZhciByO3JldHVybiB0Lm9wdGlvbnMuZHluYW1pY1BhcnRpYWxzPyhyPWUucmVhZFZhbHVlKCksZS5hc3NlcnQociwiaWxsZWdhbCBmaWxlIHBhdGgiKSwibm9uZSI9PT1yLmdldFRleHQoKT92b2lkIDA6WXIocik/em4odC5wYXJzZShzcihyKSkpOnIpOihyPXYoW10sZChlLnJlYWRGaWxlTmFtZVRlbXBsYXRlKHQub3B0aW9ucykpLCExKSwibm9uZSI9PT0oZT16bih0LnBhcnNlci5wYXJzZVRva2VucyhyKSkpP3ZvaWQgMDplKX1mdW5jdGlvbiB6bihlKXtyZXR1cm4gMT09PWUubGVuZ3RoJiYkcihlWzBdLnRva2VuKT9lWzBdLnRva2VuLmdldENvbnRlbnQoKTplfWZ1bmN0aW9uIFNuKHQscixuKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuInN0cmluZyI9PXR5cGVvZiB0P1syLHRdOkFycmF5LmlzQXJyYXkodCk/WzIsbi5yZW5kZXJlci5yZW5kZXJUZW1wbGF0ZXModCxyKV06WzQsUih0LHIpXTtjYXNlIDE6cmV0dXJuWzIsZS5zZW50KCldfX0pfXMoRm4sUm49cSksRm4ucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0LHIpe3ZhciBuLGkscyxvLGEsdSxjLGwsaCxwO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm4gbj0ocz10aGlzKS5saXF1aWQsaT1zLmhhc2gscz1zLndpdGhWYXIsbz1uLnJlbmRlcmVyLFs0LFNuKHRoaXMuZmlsZSx0LG4pXTtjYXNlIDE6cmV0dXJuIF8oYT1lLnNlbnQoKSxmdW5jdGlvbigpe3JldHVybidpbGxlZ2FsIGZpbGUgcGF0aCAiJy5jb25jYXQoYSwnIicpfSksdT10LnNhdmVSZWdpc3RlcigiYmxvY2tzIiwiYmxvY2tNb2RlIiksdC5zZXRSZWdpc3RlcigiYmxvY2tzIix7fSksdC5zZXRSZWdpc3RlcigiYmxvY2tNb2RlIixHci5PVVRQVVQpLFs0LGkucmVuZGVyKHQpXTtjYXNlIDI6cmV0dXJuKGM9ZS5zZW50KCkscyk/KGw9YyxoPWEsWzQsUihzLHQpXSk6WzMsNF07Y2FzZSAzOmxbaF09ZS5zZW50KCksZS5sYWJlbD00O2Nhc2UgNDpyZXR1cm5bNCxuLl9wYXJzZVBhcnRpYWxGaWxlKGEsdC5zeW5jLHRoaXMuY3VycmVudEZpbGUpXTtjYXNlIDU6cmV0dXJuIHA9ZS5zZW50KCksdC5wdXNoKHQub3B0cy5qZWt5bGxJbmNsdWRlP3tpbmNsdWRlOmN9OmMpLFs0LG8ucmVuZGVyVGVtcGxhdGVzKHAsdCxyKV07Y2FzZSA2OnJldHVybiBlLnNlbnQoKSx0LnBvcCgpLHQucmVzdG9yZVJlZ2lzdGVyKHUpLFsyXX19KX07dmFyIFJuLGVuPUZuO2Z1bmN0aW9uIEZuKGUsdCxyKXt0PVJuLmNhbGwodGhpcyxlLHQscil8fHRoaXMscj1lLnRva2VuaXplcix0LmZpbGU9X24ocix0LmxpcXVpZCksdC5jdXJyZW50RmlsZT1lLmZpbGUsZT1yLnA7cmV0dXJuIndpdGgiPT09ci5yZWFkSWRlbnRpZmllcigpLmNvbnRlbnQmJihyLnNraXBCbGFuaygpLCI6IiE9PXIucGVlaygpKT90LndpdGhWYXI9ci5yZWFkVmFsdWUoKTpyLnA9ZSx0Lmhhc2g9bmV3IFJyKHIucmVtYWluaW5nKCksdC5saXF1aWQub3B0aW9ucy5qZWt5bGxJbmNsdWRlKSx0fXMoTG4scW49cSksTG4ucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlLHQpe2U9ZS5lbnZpcm9ubWVudHM7SChlW3RoaXMudmFyaWFibGVdKXx8KGVbdGhpcy52YXJpYWJsZV09MCksdC53cml0ZShmKC0tZVt0aGlzLnZhcmlhYmxlXSkpfTt2YXIgcW4sb249TG47ZnVuY3Rpb24gTG4oZSx0LHIpe2U9cW4uY2FsbCh0aGlzLGUsdCxyKXx8dGhpcztyZXR1cm4gZS52YXJpYWJsZT1lLnRva2VuaXplci5yZWFkSWRlbnRpZmllcigpLmNvbnRlbnQsZX1zKERuLEVuPXEpLERuLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxlKXt2YXIgcixuLGkscztyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsUih0aGlzLmdyb3VwLHQpXTtjYXNlIDE6cmV0dXJuIHI9ZS5zZW50KCkscj0iY3ljbGU6Ii5jb25jYXQociwiOiIpK3RoaXMuY2FuZGlkYXRlcy5qb2luKCIsIiksbj10LmdldFJlZ2lzdGVyKCJjeWNsZSIpLHZvaWQgMD09PShpPW5bcl0pJiYoaT1uW3JdPTApLHM9dGhpcy5jYW5kaWRhdGVzW2ldLGk9KGkrMSkldGhpcy5jYW5kaWRhdGVzLmxlbmd0aCxuW3JdPWksWzQsUihzLHQpXTtjYXNlIDI6cmV0dXJuWzIsZS5zZW50KCldfX0pfTt2YXIgRW4sYW49RG47ZnVuY3Rpb24gRG4oZSx0LHIpe3ZhciBuPUVuLmNhbGwodGhpcyxlLHQscil8fHRoaXMsdD0obi5jYW5kaWRhdGVzPVtdLG4udG9rZW5pemVyLnJlYWRWYWx1ZSgpKTtmb3Iobi50b2tlbml6ZXIuc2tpcEJsYW5rKCksdCYmKCI6Ij09PW4udG9rZW5pemVyLnBlZWsoKT8obi5ncm91cD10LG4udG9rZW5pemVyLmFkdmFuY2UoKSk6bi5jYW5kaWRhdGVzLnB1c2godCkpOyFuLnRva2VuaXplci5lbmQoKTspe3ZhciBpPW4udG9rZW5pemVyLnJlYWRWYWx1ZSgpO2kmJm4uY2FuZGlkYXRlcy5wdXNoKGkpLG4udG9rZW5pemVyLnJlYWRUbygiLCIpfXJldHVybiBuLnRva2VuaXplci5hc3NlcnQobi5jYW5kaWRhdGVzLmxlbmd0aCxmdW5jdGlvbigpe3JldHVybidlbXB0eSBjYW5kaWRhdGVzOiAiJy5jb25jYXQoZS5nZXRUZXh0KCksJyInKX0pLG59cyhqbixObj1xKSxqbi5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQscil7dmFyIG4saSxzLG8sYSx1LGM7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOm49dGhpcy5saXF1aWQucmVuZGVyZXIsZS5sYWJlbD0xO2Nhc2UgMTplLnRyeXMucHVzaChbMSw3LDgsOV0pLGk9Tyh0aGlzLmJyYW5jaGVzKSxzPWkubmV4dCgpLGUubGFiZWw9MjtjYXNlIDI6cmV0dXJuIHMuZG9uZT9bMyw2XToobz1zLnZhbHVlLGE9by52YWx1ZSxvPW8udGVtcGxhdGVzLFs0LGEudmFsdWUodCx0Lm9wdHMubGVuaWVudElmKV0pO2Nhc2UgMzpyZXR1cm4gb3IoZS5zZW50KCksdCk/WzQsbi5yZW5kZXJUZW1wbGF0ZXMobyx0LHIpXTpbMyw1XTtjYXNlIDQ6cmV0dXJuIGUuc2VudCgpLFsyXTtjYXNlIDU6cmV0dXJuIHM9aS5uZXh0KCksWzMsMl07Y2FzZSA2OnJldHVyblszLDldO2Nhc2UgNzpyZXR1cm4gYT1lLnNlbnQoKSx1PXtlcnJvcjphfSxbMyw5XTtjYXNlIDg6dHJ5e3MmJiFzLmRvbmUmJihjPWkucmV0dXJuKSYmYy5jYWxsKGkpfWZpbmFsbHl7aWYodSl0aHJvdyB1LmVycm9yfXJldHVybls3XTtjYXNlIDk6cmV0dXJuWzQsbi5yZW5kZXJUZW1wbGF0ZXModGhpcy5lbHNlVGVtcGxhdGVzLHQscildO2Nhc2UgMTA6cmV0dXJuIGUuc2VudCgpLFsyXX19KX07dmFyIE5uLHVuPWpuO2Z1bmN0aW9uIGpuKGUsdCxyKXt2YXIgbj1Obi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzLGk9KG4uYnJhbmNoZXM9W10sbi5lbHNlVGVtcGxhdGVzPVtdLFtdKSxzPTA7cmV0dXJuIHIucGFyc2VyLnBhcnNlU3RyZWFtKHQpLm9uKCJzdGFydCIsZnVuY3Rpb24oKXtyZXR1cm4gbi5icmFuY2hlcy5wdXNoKHt2YWx1ZTpuZXcgTChlLmFyZ3Msbi5saXF1aWQpLHRlbXBsYXRlczppPVtdfSl9KS5vbigidGFnOmVsc2lmIixmdW5jdGlvbihlKXswPHM/aT1bXTpuLmJyYW5jaGVzLnB1c2goe3ZhbHVlOm5ldyBMKGUuYXJncyxuLmxpcXVpZCksdGVtcGxhdGVzOmk9W119KX0pLm9uKCJ0YWc6ZWxzZSIsZnVuY3Rpb24oKXtzKyssaT1uLmVsc2VUZW1wbGF0ZXN9KS5vbigidGFnOmVuZGlmIixmdW5jdGlvbigpe3RoaXMuc3RvcCgpfSkub24oInRlbXBsYXRlIixmdW5jdGlvbihlKXtpPT09bi5lbHNlVGVtcGxhdGVzJiYxIT09c3x8aS5wdXNoKGUpfSkub24oImVuZCIsZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoInRhZyAiLmNvbmNhdChlLmdldFRleHQoKSwiIG5vdCBjbG9zZWQiKSl9KS5zdGFydCgpLG59cyhQbixNbj1xKSxQbi5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKGUsdCl7dmFyIGU9ZS5lbnZpcm9ubWVudHMscj0oSChlW3RoaXMudmFyaWFibGVdKXx8KGVbdGhpcy52YXJpYWJsZV09MCksZVt0aGlzLnZhcmlhYmxlXSk7ZVt0aGlzLnZhcmlhYmxlXSsrLHQud3JpdGUoZihyKSl9O3ZhciBNbixyPVBuO2Z1bmN0aW9uIFBuKGUsdCxyKXtlPU1uLmNhbGwodGhpcyxlLHQscil8fHRoaXM7cmV0dXJuIGUudmFyaWFibGU9ZS50b2tlbml6ZXIucmVhZElkZW50aWZpZXIoKS5jb250ZW50LGV9cyhJbixWbj1xKSxJbi5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQscil7dmFyIG4saSxzLG8sYSx1LGMsbCxoO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm4obj0oYz10aGlzKS5saXF1aWQsaT1jLmFyZ3MsYz1jLmZpbGUscz1uLnJlbmRlcmVyLHZvaWQgMCE9PWMpP1szLDJdOih0LnNldFJlZ2lzdGVyKCJibG9ja01vZGUiLEdyLk9VVFBVVCksWzQscy5yZW5kZXJUZW1wbGF0ZXModGhpcy50ZW1wbGF0ZXMsdCxyKV0pO2Nhc2UgMTpyZXR1cm4gZS5zZW50KCksWzJdO2Nhc2UgMjpyZXR1cm5bNCxTbih0aGlzLmZpbGUsdCxuKV07Y2FzZSAzOnJldHVybiBfKG89ZS5zZW50KCksZnVuY3Rpb24oKXtyZXR1cm4naWxsZWdhbCBmaWxlIHBhdGggIicuY29uY2F0KG8sJyInKX0pLFs0LG4uX3BhcnNlTGF5b3V0RmlsZShvLHQuc3luYyx0aGlzLmN1cnJlbnRGaWxlKV07Y2FzZSA0OnJldHVybiBhPWUuc2VudCgpLHQuc2V0UmVnaXN0ZXIoImJsb2NrTW9kZSIsR3IuU1RPUkUpLFs0LHMucmVuZGVyVGVtcGxhdGVzKHRoaXMudGVtcGxhdGVzLHQpXTtjYXNlIDU6cmV0dXJuIHU9ZS5zZW50KCksdm9pZCAwPT09KGM9dC5nZXRSZWdpc3RlcigiYmxvY2tzIikpWyIiXSYmKGNbIiJdPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQud3JpdGUodSl9KSx0LnNldFJlZ2lzdGVyKCJibG9ja01vZGUiLEdyLk9VVFBVVCksaD0obD10KS5wdXNoLFs0LGkucmVuZGVyKHQpXTtjYXNlIDY6cmV0dXJuIGguYXBwbHkobCxbZS5zZW50KCldKSxbNCxzLnJlbmRlclRlbXBsYXRlcyhhLHQscildO2Nhc2UgNzpyZXR1cm4gZS5zZW50KCksdC5wb3AoKSxbMl19fSl9O3ZhciBWbixBbj1JbjtmdW5jdGlvbiBJbihlLHQscil7cj1Wbi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzO3JldHVybiByLmZpbGU9X24oci50b2tlbml6ZXIsci5saXF1aWQpLHIuY3VycmVudEZpbGU9ZS5maWxlLHIuYXJncz1uZXcgUnIoci50b2tlbml6ZXIucmVtYWluaW5nKCkpLHIudGVtcGxhdGVzPXIubGlxdWlkLnBhcnNlci5wYXJzZVRva2Vucyh0KSxyfXMoSG4sQm49cSksSG4ucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbih0LHIpe3ZhciBuO3JldHVybiB4KHRoaXMsZnVuY3Rpb24oZSl7c3dpdGNoKGUubGFiZWwpe2Nhc2UgMDpyZXR1cm4obj10aGlzLmdldEJsb2NrUmVuZGVyKHQpLHQuZ2V0UmVnaXN0ZXIoImJsb2NrTW9kZSIpIT09R3IuU1RPUkUpP1szLDFdOih0LmdldFJlZ2lzdGVyKCJibG9ja3MiKVt0aGlzLmJsb2NrXT1uLFszLDNdKTtjYXNlIDE6cmV0dXJuWzQsbihuZXcgTmUscildO2Nhc2UgMjplLnNlbnQoKSxlLmxhYmVsPTM7Y2FzZSAzOnJldHVyblsyXX19KX0sSG4ucHJvdG90eXBlLmdldEJsb2NrUmVuZGVyPWZ1bmN0aW9uKG4pe2Z1bmN0aW9uIHIodCxyKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuIG4ucHVzaCh7YmxvY2s6dH0pLFs0LGkucmVuZGVyZXIucmVuZGVyVGVtcGxhdGVzKHMsbixyKV07Y2FzZSAxOnJldHVybiBlLnNlbnQoKSxuLnBvcCgpLFsyXX19KX12YXIgaT10aGlzLmxpcXVpZCxzPXRoaXMudGVtcGxhdGVzLG89bi5nZXRSZWdpc3RlcigiYmxvY2tzIilbdGhpcy5ibG9ja107cmV0dXJuIG8/ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbyhuZXcgTmUoZnVuY3Rpb24oKXtyZXR1cm4gcihlLHQpfSksdCl9OnJ9O3ZhciBCbixDbj1IbjtmdW5jdGlvbiBIbihlLHQscil7dmFyIG49Qm4uY2FsbCh0aGlzLGUsdCxyKXx8dGhpcyxpPShuLnRlbXBsYXRlcz1bXSwvXHcrLy5leGVjKGUuYXJncykpO2ZvcihuLmJsb2NrPWk/aVswXToiIjt0Lmxlbmd0aDspe3ZhciBzPXQuc2hpZnQoKTtpZihXcihzKSYmImVuZGJsb2NrIj09PXMubmFtZSlyZXR1cm4gbjtzPXIucGFyc2VyLnBhcnNlVG9rZW4ocyx0KTtuLnRlbXBsYXRlcy5wdXNoKHMpfXRocm93IG5ldyBFcnJvcigidGFnICIuY29uY2F0KGUuZ2V0VGV4dCgpLCIgbm90IGNsb3NlZCIpKX1zKCRuLEtuPXEpLCRuLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50b2tlbnMubWFwKGZ1bmN0aW9uKGUpe3JldHVybiBlLmdldFRleHQoKX0pLmpvaW4oIiIpfTt2YXIgS24sVW49JG47ZnVuY3Rpb24gJG4oZSx0LHIpe3ZhciBuPUtuLmNhbGwodGhpcyxlLHQscil8fHRoaXM7Zm9yKG4udG9rZW5zPVtdO3QubGVuZ3RoOyl7dmFyIGk9dC5zaGlmdCgpO2lmKFdyKGkpJiYiZW5kcmF3Ij09PWkubmFtZSlyZXR1cm4gbjtuLnRva2Vucy5wdXNoKGkpfXRocm93IG5ldyBFcnJvcigidGFnICIuY29uY2F0KGUuZ2V0VGV4dCgpLCIgbm90IGNsb3NlZCIpKX1zKFluLFFuPUVlKSxZbi5wcm90b3R5cGUucm93PWZ1bmN0aW9uKCl7cmV0dXJuIE1hdGguZmxvb3IodGhpcy5pL3RoaXMuY29scykrMX0sWW4ucHJvdG90eXBlLmNvbDA9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pJXRoaXMuY29sc30sWW4ucHJvdG90eXBlLmNvbD1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbDAoKSsxfSxZbi5wcm90b3R5cGUuY29sX2ZpcnN0PWZ1bmN0aW9uKCl7cmV0dXJuIDA9PT10aGlzLmNvbDAoKX0sWW4ucHJvdG90eXBlLmNvbF9sYXN0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29sKCk9PT10aGlzLmNvbHN9O3ZhciBRbixXbj1ZbjtmdW5jdGlvbiBZbihlLHQscixuKXtyPVFuLmNhbGwodGhpcyxlLHIsbil8fHRoaXM7cmV0dXJuIHIubGVuZ3RoPWUsci5jb2xzPXQscn1zKEduLEpuPXEpLEduLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbixpLHMsbyxhLHU7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybiBpPVZlLFs0LFIodGhpcy5jb2xsZWN0aW9uLHQpXTtjYXNlIDE6cmV0dXJuIG49aS5hcHBseSh2b2lkIDAsW2Uuc2VudCgpXSksWzQsdGhpcy5hcmdzLnJlbmRlcih0KV07Y2FzZSAyOm89ZS5zZW50KCksYT1vLm9mZnNldHx8MCxzPXZvaWQgMD09PW8ubGltaXQ/bi5sZW5ndGg6by5saW1pdCxuPW4uc2xpY2UoYSxhK3MpLGE9by5jb2xzfHxuLmxlbmd0aCxzPXRoaXMubGlxdWlkLnJlbmRlcmVyLG89bmV3IFduKG4ubGVuZ3RoLGEsdGhpcy5jb2xsZWN0aW9uLmdldFRleHQoKSx0aGlzLnZhcmlhYmxlKSxhPXt0YWJsZXJvd2xvb3A6b30sdC5wdXNoKGEpLHU9MCxlLmxhYmVsPTM7Y2FzZSAzOnJldHVybiB1PG4ubGVuZ3RoPyhhW3RoaXMudmFyaWFibGVdPW5bdV0sMD09PW8uY29sMCgpJiYoMSE9PW8ucm93KCkmJnIud3JpdGUoIjwvdHI+Iiksci53cml0ZSgnPHRyIGNsYXNzPSJyb3cnLmNvbmNhdChvLnJvdygpLCciPicpKSksci53cml0ZSgnPHRkIGNsYXNzPSJjb2wnLmNvbmNhdChvLmNvbCgpLCciPicpKSxbNCxzLnJlbmRlclRlbXBsYXRlcyh0aGlzLnRlbXBsYXRlcyx0LHIpXSk6WzMsNl07Y2FzZSA0OmUuc2VudCgpLHIud3JpdGUoIjwvdGQ+IiksZS5sYWJlbD01O2Nhc2UgNTpyZXR1cm4gdSsrLG8ubmV4dCgpLFszLDNdO2Nhc2UgNjpyZXR1cm4gbi5sZW5ndGgmJnIud3JpdGUoIjwvdHI+IiksdC5wb3AoKSxbMl19fSl9O3ZhciBKbixabj1HbjtmdW5jdGlvbiBHbihlLHQscil7dmFyIG4saT1Kbi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzLHI9aS50b2tlbml6ZXIucmVhZElkZW50aWZpZXIoKSxzPShpLnRva2VuaXplci5za2lwQmxhbmsoKSxpLnRva2VuaXplci5yZWFkSWRlbnRpZmllcigpKSxvPWkudG9rZW5pemVyLnJlYWRWYWx1ZSgpO2lmKCJpbiIhPT1zLmNvbnRlbnR8fCFvKXRocm93IG5ldyBFcnJvcigiaWxsZWdhbCB0YWc6ICIuY29uY2F0KGUuZ2V0VGV4dCgpKSk7aS52YXJpYWJsZT1yLmNvbnRlbnQsaS5jb2xsZWN0aW9uPW8saS5hcmdzPW5ldyBScihpLnRva2VuaXplci5yZW1haW5pbmcoKSksaS50ZW1wbGF0ZXM9W107dmFyIGE9aS5saXF1aWQucGFyc2VyLnBhcnNlU3RyZWFtKHQpLm9uKCJzdGFydCIsZnVuY3Rpb24oKXtyZXR1cm4gbj1pLnRlbXBsYXRlc30pLm9uKCJ0YWc6ZW5kdGFibGVyb3ciLGZ1bmN0aW9uKCl7cmV0dXJuIGEuc3RvcCgpfSkub24oInRlbXBsYXRlIixmdW5jdGlvbihlKXtyZXR1cm4gbi5wdXNoKGUpfSkub24oImVuZCIsZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoInRhZyAiLmNvbmNhdChlLmdldFRleHQoKSwiIG5vdCBjbG9zZWQiKSl9KTtyZXR1cm4gYS5zdGFydCgpLGl9cyh0aSxYbj1xKSx0aS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQscil7dmFyIG4saSxzLG8sYSx1LGMsbDtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6bj10aGlzLmxpcXVpZC5yZW5kZXJlcixlLmxhYmVsPTE7Y2FzZSAxOmUudHJ5cy5wdXNoKFsxLDcsOCw5XSksaT1PKHRoaXMuYnJhbmNoZXMpLHM9aS5uZXh0KCksZS5sYWJlbD0yO2Nhc2UgMjpyZXR1cm4gcy5kb25lP1szLDZdOihhPXMudmFsdWUsdT1hLnZhbHVlLG89YS50ZXN0LGE9YS50ZW1wbGF0ZXMsWzQsdS52YWx1ZSh0LHQub3B0cy5sZW5pZW50SWYpXSk7Y2FzZSAzOnJldHVybih1PWUuc2VudCgpLG8odSx0KSk/WzQsbi5yZW5kZXJUZW1wbGF0ZXMoYSx0LHIpXTpbMyw1XTtjYXNlIDQ6cmV0dXJuIGUuc2VudCgpLFsyXTtjYXNlIDU6cmV0dXJuIHM9aS5uZXh0KCksWzMsMl07Y2FzZSA2OnJldHVyblszLDldO2Nhc2UgNzpyZXR1cm4gYz1lLnNlbnQoKSxjPXtlcnJvcjpjfSxbMyw5XTtjYXNlIDg6dHJ5e3MmJiFzLmRvbmUmJihsPWkucmV0dXJuKSYmbC5jYWxsKGkpfWZpbmFsbHl7aWYoYyl0aHJvdyBjLmVycm9yfXJldHVybls3XTtjYXNlIDk6cmV0dXJuWzQsbi5yZW5kZXJUZW1wbGF0ZXModGhpcy5lbHNlVGVtcGxhdGVzLHQscildO2Nhc2UgMTA6cmV0dXJuIGUuc2VudCgpLFsyXX19KX07dmFyIFhuLGVpPXRpO2Z1bmN0aW9uIHRpKGUsdCxyKXt2YXIgbj1Ybi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzLGk9KG4uYnJhbmNoZXM9W10sbi5lbHNlVGVtcGxhdGVzPVtdLFtdKSxzPTA7cmV0dXJuIG4ubGlxdWlkLnBhcnNlci5wYXJzZVN0cmVhbSh0KS5vbigic3RhcnQiLGZ1bmN0aW9uKCl7cmV0dXJuIG4uYnJhbmNoZXMucHVzaCh7dmFsdWU6bmV3IEwoZS5hcmdzLG4ubGlxdWlkKSx0ZXN0OmFyLHRlbXBsYXRlczppPVtdfSl9KS5vbigidGFnOmVsc2lmIixmdW5jdGlvbihlKXswPHM/aT1bXTpuLmJyYW5jaGVzLnB1c2goe3ZhbHVlOm5ldyBMKGUuYXJncyxuLmxpcXVpZCksdGVzdDpvcix0ZW1wbGF0ZXM6aT1bXX0pfSkub24oInRhZzplbHNlIixmdW5jdGlvbigpe3MrKyxpPW4uZWxzZVRlbXBsYXRlc30pLm9uKCJ0YWc6ZW5kdW5sZXNzIixmdW5jdGlvbigpe3RoaXMuc3RvcCgpfSkub24oInRlbXBsYXRlIixmdW5jdGlvbihlKXtpPT09bi5lbHNlVGVtcGxhdGVzJiYxIT09c3x8aS5wdXNoKGUpfSkub24oImVuZCIsZnVuY3Rpb24oKXt0aHJvdyBuZXcgRXJyb3IoInRhZyAiLmNvbmNhdChlLmdldFRleHQoKSwiIG5vdCBjbG9zZWQiKSl9KS5zdGFydCgpLG59cyhpaSxyaT1xKSxpaS5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKGUsdCl7dC5icmVhaz0hMH07dmFyIHJpLG5pPWlpO2Z1bmN0aW9uIGlpKCl7cmV0dXJuIG51bGwhPT1yaSYmcmkuYXBwbHkodGhpcyxhcmd1bWVudHMpfHx0aGlzfXMoYWksc2k9cSksYWkucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbihlLHQpe3QuY29udGludWU9ITB9O3ZhciBzaSxvaT1haTtmdW5jdGlvbiBhaSgpe3JldHVybiBudWxsIT09c2kmJnNpLmFwcGx5KHRoaXMsYXJndW1lbnRzKXx8dGhpc31zKGxpLHVpPXEpLGxpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXt2YXIgbjtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuIHRoaXMudmFsdWU/WzQsdGhpcy52YWx1ZS52YWx1ZSh0LCExKV06WzJdO2Nhc2UgMTpyZXR1cm4gbj1lLnNlbnQoKSxyLndyaXRlKG4pLFsyXX19KX07dmFyIHVpLGNpPWxpO2Z1bmN0aW9uIGxpKGUsdCxyKXtlPXVpLmNhbGwodGhpcyxlLHQscil8fHRoaXM7cmV0dXJuIGUudG9rZW5pemVyLnNraXBCbGFuaygpLGUudG9rZW5pemVyLmVuZCgpfHwoZS52YWx1ZT1uZXcgTChlLnRva2VuaXplci5yZWFkRmlsdGVyZWRWYWx1ZSgpLGUubGlxdWlkKSksZX1zKGZpLGhpPXEpLGZpLnByb3RvdHlwZS5yZW5kZXI9ZnVuY3Rpb24odCxyKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsdGhpcy5saXF1aWQucmVuZGVyZXIucmVuZGVyVGVtcGxhdGVzKHRoaXMudGVtcGxhdGVzLHQscildO2Nhc2UgMTpyZXR1cm4gZS5zZW50KCksWzJdfX0pfTt2YXIgaGkscGk9Zmk7ZnVuY3Rpb24gZmkoZSx0LHIpe2U9aGkuY2FsbCh0aGlzLGUsdCxyKXx8dGhpcyx0PWUudG9rZW5pemVyLnJlYWRMaXF1aWRUYWdUb2tlbnMoZS5saXF1aWQub3B0aW9ucyk7cmV0dXJuIGUudGVtcGxhdGVzPWUubGlxdWlkLnBhcnNlci5wYXJzZVRva2Vucyh0KSxlfXMoZ2ksZGk9cSksZ2kucHJvdG90eXBlLnJlbmRlcj1mdW5jdGlvbigpe307dmFyIGRpLHZpPWdpO2Z1bmN0aW9uIGdpKGUsdCxyKXt0PWRpLmNhbGwodGhpcyxlLHQscil8fHRoaXM7aWYoLTEhPT1lLmFyZ3Muc2VhcmNoKC9cblxzKlteI1xzXS9nKSl0aHJvdyBuZXcgRXJyb3IoImV2ZXJ5IGxpbmUgb2YgYW4gaW5saW5lIGNvbW1lbnQgbXVzdCBzdGFydCB3aXRoIGEgJyMnIGNoYXJhY3RlciIpO3JldHVybiB0fXZhciB5aT17YXNzaWduOnRuLGZvcjpybixjYXB0dXJlOm5uLGNhc2U6c24sY29tbWVudDp5cixpbmNsdWRlOmVuLHJlbmRlcjpOLGRlY3JlbWVudDpvbixpbmNyZW1lbnQ6cixjeWNsZTphbixpZjp1bixsYXlvdXQ6QW4sYmxvY2s6Q24scmF3OlVuLHRhYmxlcm93OlpuLHVubGVzczplaSxicmVhazpuaSxjb250aW51ZTpvaSxlY2hvOmNpLGxpcXVpZDpwaSwiIyI6dml9LG1pPShqLnByb3RvdHlwZS5wYXJzZT1mdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLnBhcnNlci5wYXJzZShlLHQpfSxqLnByb3RvdHlwZS5fcmVuZGVyPWZ1bmN0aW9uKGUsdCxyKXt0PXQgaW5zdGFuY2VvZiBYcj90Om5ldyBYcih0LHRoaXMub3B0aW9ucyxyKTtyZXR1cm4gdGhpcy5yZW5kZXJlci5yZW5kZXJUZW1wbGF0ZXMoZSx0KX0sai5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQscixuKXtyZXR1cm4gYSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVyblsyLHcodGhpcy5fcmVuZGVyKHQscixUKFQoe30sbikse3N5bmM6ITF9KSkpXX0pfSl9LGoucHJvdG90eXBlLnJlbmRlclN5bmM9ZnVuY3Rpb24oZSx0LHIpe3JldHVybiBrKHRoaXMuX3JlbmRlcihlLHQsVChUKHt9LHIpLHtzeW5jOiEwfSkpKX0sai5wcm90b3R5cGUucmVuZGVyVG9Ob2RlU3RyZWFtPWZ1bmN0aW9uKGUsdCxyKXt0PW5ldyBYcih0LHRoaXMub3B0aW9ucyxyPXZvaWQgMD09PXI/e306cik7cmV0dXJuIHRoaXMucmVuZGVyZXIucmVuZGVyVGVtcGxhdGVzVG9Ob2RlU3RyZWFtKGUsdCl9LGoucHJvdG90eXBlLl9wYXJzZUFuZFJlbmRlcj1mdW5jdGlvbihlLHQscil7ZT10aGlzLnBhcnNlKGUpO3JldHVybiB0aGlzLl9yZW5kZXIoZSx0LHIpfSxqLnByb3RvdHlwZS5wYXJzZUFuZFJlbmRlcj1mdW5jdGlvbih0LHIsbil7cmV0dXJuIGEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtyZXR1cm5bMix3KHRoaXMuX3BhcnNlQW5kUmVuZGVyKHQscixUKFQoe30sbikse3N5bmM6ITF9KSkpXX0pfSl9LGoucHJvdG90eXBlLnBhcnNlQW5kUmVuZGVyU3luYz1mdW5jdGlvbihlLHQscil7cmV0dXJuIGsodGhpcy5fcGFyc2VBbmRSZW5kZXIoZSx0LFQoVCh7fSxyKSx7c3luYzohMH0pKSl9LGoucHJvdG90eXBlLl9wYXJzZVBhcnRpYWxGaWxlPWZ1bmN0aW9uKGUsdCxyKXtyZXR1cm4gdGhpcy5wYXJzZXIucGFyc2VGaWxlKGUsdCxQci5QYXJ0aWFscyxyKX0sai5wcm90b3R5cGUuX3BhcnNlTGF5b3V0RmlsZT1mdW5jdGlvbihlLHQscil7cmV0dXJuIHRoaXMucGFyc2VyLnBhcnNlRmlsZShlLHQsUHIuTGF5b3V0cyxyKX0sai5wcm90b3R5cGUuX3BhcnNlRmlsZT1mdW5jdGlvbihlLHQscixuKXtyZXR1cm4gdGhpcy5wYXJzZXIucGFyc2VGaWxlKGUsdCxyLG4pfSxqLnByb3RvdHlwZS5wYXJzZUZpbGU9ZnVuY3Rpb24odCxyKXtyZXR1cm4gYSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVyblsyLHcodGhpcy5wYXJzZXIucGFyc2VGaWxlKHQsITEscikpXX0pfSl9LGoucHJvdG90eXBlLnBhcnNlRmlsZVN5bmM9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gayh0aGlzLnBhcnNlci5wYXJzZUZpbGUoZSwhMCx0KSl9LGoucHJvdG90eXBlLl9yZW5kZXJGaWxlPWZ1bmN0aW9uKHQscixuKXt2YXIgaTtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3N3aXRjaChlLmxhYmVsKXtjYXNlIDA6cmV0dXJuWzQsdGhpcy5fcGFyc2VGaWxlKHQsbi5zeW5jLG4ubG9va3VwVHlwZSldO2Nhc2UgMTpyZXR1cm4gaT1lLnNlbnQoKSxbNCx0aGlzLl9yZW5kZXIoaSxyLG4pXTtjYXNlIDI6cmV0dXJuWzIsZS5zZW50KCldfX0pfSxqLnByb3RvdHlwZS5yZW5kZXJGaWxlPWZ1bmN0aW9uKHQscixuKXtyZXR1cm4gYSh0aGlzLHZvaWQgMCx2b2lkIDAsZnVuY3Rpb24oKXtyZXR1cm4geCh0aGlzLGZ1bmN0aW9uKGUpe3JldHVyblsyLHcodGhpcy5fcmVuZGVyRmlsZSh0LHIsVChUKHt9LG4pLHtzeW5jOiExfSkpKV19KX0pfSxqLnByb3RvdHlwZS5yZW5kZXJGaWxlU3luYz1mdW5jdGlvbihlLHQscil7cmV0dXJuIGsodGhpcy5fcmVuZGVyRmlsZShlLHQsVChUKHt9LHIpLHtzeW5jOiEwfSkpKX0sai5wcm90b3R5cGUucmVuZGVyRmlsZVRvTm9kZVN0cmVhbT1mdW5jdGlvbihyLG4saSl7cmV0dXJuIGEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7dmFyIHQ7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LHRoaXMucGFyc2VGaWxlKHIpXTtjYXNlIDE6cmV0dXJuIHQ9ZS5zZW50KCksWzIsdGhpcy5yZW5kZXJUb05vZGVTdHJlYW0odCxuLGkpXX19KX0pfSxqLnByb3RvdHlwZS5fZXZhbFZhbHVlPWZ1bmN0aW9uKGUsdCl7ZT1uZXcgTChlLHRoaXMpLHQ9dCBpbnN0YW5jZW9mIFhyP3Q6bmV3IFhyKHQsdGhpcy5vcHRpb25zKTtyZXR1cm4gZS52YWx1ZSh0KX0sai5wcm90b3R5cGUuZXZhbFZhbHVlPWZ1bmN0aW9uKHQscil7cmV0dXJuIGEodGhpcyx2b2lkIDAsdm9pZCAwLGZ1bmN0aW9uKCl7cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtyZXR1cm5bMix3KHRoaXMuX2V2YWxWYWx1ZSh0LHIpKV19KX0pfSxqLnByb3RvdHlwZS5ldmFsVmFsdWVTeW5jPWZ1bmN0aW9uKGUsdCl7cmV0dXJuIGsodGhpcy5fZXZhbFZhbHVlKGUsdCkpfSxqLnByb3RvdHlwZS5yZWdpc3RlckZpbHRlcj1mdW5jdGlvbihlLHQpe3RoaXMuZmlsdGVyc1tlXT10fSxqLnByb3RvdHlwZS5yZWdpc3RlclRhZz1mdW5jdGlvbihlLHQpe2Z1bmN0aW9uIHIoZSx0LHIpe3I9bi5jYWxsKHRoaXMsZSx0LHIpfHx0aGlzO3JldHVybiBjKGkucGFyc2UpJiZpLnBhcnNlLmNhbGwocixlLHQpLHJ9dmFyIGksbjt0aGlzLnRhZ3NbZV09Yyh0KT90OihpPXQscyhyLG49cSksci5wcm90b3R5cGUucmVuZGVyPWZ1bmN0aW9uKHQscil7dmFyIG47cmV0dXJuIHgodGhpcyxmdW5jdGlvbihlKXtzd2l0Y2goZS5sYWJlbCl7Y2FzZSAwOnJldHVybls0LG5ldyBScih0aGlzLnRva2VuLmFyZ3MpLnJlbmRlcih0KV07Y2FzZSAxOnJldHVybiBuPWUuc2VudCgpLFs0LGkucmVuZGVyLmNhbGwodGhpcyx0LHIsbildO2Nhc2UgMjpyZXR1cm5bMixlLnNlbnQoKV19fSl9LHIpfSxqLnByb3RvdHlwZS5wbHVnaW49ZnVuY3Rpb24oZSl7cmV0dXJuIGUuY2FsbCh0aGlzLGopfSxqLnByb3RvdHlwZS5leHByZXNzPWZ1bmN0aW9uKCl7dmFyIHM9dGhpcyxvPSEwO3JldHVybiBmdW5jdGlvbihlLHQscil7dmFyIG4saTtvJiYobz0hMSxpPXdyKHRoaXMucm9vdCksKG49cy5vcHRpb25zLnJvb3QpLnVuc2hpZnQuYXBwbHkobix2KFtdLGQoaSksITEpKSwobj1zLm9wdGlvbnMubGF5b3V0cykudW5zaGlmdC5hcHBseShuLHYoW10sZChpKSwhMSkpLChuPXMub3B0aW9ucy5wYXJ0aWFscykudW5zaGlmdC5hcHBseShuLHYoW10sZChpKSwhMSkpKSxzLnJlbmRlckZpbGUoZSx0KS50aGVuKGZ1bmN0aW9uKGUpe3JldHVybiByKG51bGwsZSl9LHIpfX0saik7ZnVuY3Rpb24gaihlKXt2b2lkIDA9PT1lJiYoZT17fSk7dmFyIHI9dGhpczt0aGlzLnJlbmRlcmVyPW5ldyB0cix0aGlzLmZpbHRlcnM9e30sdGhpcy50YWdzPXt9LHRoaXMub3B0aW9ucz1icihlKSx0aGlzLnBhcnNlcj1uZXcgQ3IodGhpcyksSyh5aSxmdW5jdGlvbihlLHQpe3JldHVybiByLnJlZ2lzdGVyVGFnKHQsZSl9KSxLKHBuLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHIucmVnaXN0ZXJGaWx0ZXIodCxlKX0pfWwuQXNzZXJ0aW9uRXJyb3I9YmUsbC5Bc3NpZ25UYWc9dG4sbC5CbG9ja1RhZz1DbixsLkJyZWFrVGFnPW5pLGwuQ2FwdHVyZVRhZz1ubixsLkNhc2VUYWc9c24sbC5Db21tZW50VGFnPXlyLGwuQ29udGV4dD1YcixsLkNvbnRpbnVlVGFnPW9pLGwuQ3ljbGVUYWc9YW4sbC5EZWNyZW1lbnRUYWc9b24sbC5Ecm9wPW8sbC5FY2hvVGFnPWNpLGwuRXhwcmVzc2lvbj1ucixsLkZpbHRlcj1xcixsLkZvclRhZz1ybixsLkhhc2g9UnIsbC5JZlRhZz11bixsLkluY2x1ZGVUYWc9ZW4sbC5JbmNyZW1lbnRUYWc9cixsLklubGluZUNvbW1lbnRUYWc9dmksbC5MYXlvdXRUYWc9QW4sbC5MaXF1aWQ9bWksbC5MaXF1aWRFcnJvcj10ZSxsLkxpcXVpZFRhZz1waSxsLk91dHB1dD1OcixsLlBhcnNlRXJyb3I9YWUsbC5QYXJzZVN0cmVhbT14cixsLlJhd1RhZz1VbixsLlJlbmRlckVycm9yPWxlLGwuUmVuZGVyVGFnPU4sbC5UYWJsZXJvd1RhZz1abixsLlRhZz1xLGwuVGFnVG9rZW49bnQsbC5UaW1lem9uZURhdGU9WGUsbC5Ub2tlbj1lLGwuVG9rZW5pemF0aW9uRXJyb3I9aWUsbC5Ub2tlbml6ZXI9VHIsbC5UeXBlR3VhcmRzPWksbC5VbmRlZmluZWRWYXJpYWJsZUVycm9yPWZlLGwuVW5sZXNzVGFnPWVpLGwuVmFsdWU9TCxsLmFzc2VydD1fLGwuY3JlYXRlVHJpZT1QZSxsLmRlZmF1bHRPcGVyYXRvcnM9UmUsbC5kZWZhdWx0T3B0aW9ucz1tcixsLmV2YWxRdW90ZWRUb2tlbj1zcixsLmV2YWxUb2tlbj1SLGwuZmlsdGVycz1wbixsLmlzRmFsc3k9YXIsbC5pc1RydXRoeT1vcixsLnRhZ3M9eWksbC50b1Byb21pc2U9dyxsLnRvVmFsdWU9eSxsLnRvVmFsdWVTeW5jPWssbC52ZXJzaW9uPSIxMC4xMC4xIixPYmplY3QuZGVmaW5lUHJvcGVydHkobCwiX19lc01vZHVsZSIse3ZhbHVlOiEwfSl9KTsNCi8vIyBzb3VyY2VNYXBwaW5nVVJMPWxpcXVpZC5icm93c2VyLm1pbi5qcy5tYXA=";

        private string root;
        private ITemplateLoader? loader;

        public TemplateRenderer(string root, ITemplateLoader? loader)
        {
            this.root = root;
            this.loader = loader;
        }

        public object Render(TemplateLanguage language, string source, string path, ScriptObject[] objs)
        {
            path = new SafePath(path).Absolute;

            var lang = Scriban.Parsing.ScriptLang.Liquid;
            if (language == TemplateLanguage.Scriban)
            {
                lang = Scriban.Parsing.ScriptLang.Default;
            }

            var parserOptions = new Scriban.Parsing.ParserOptions()
            {
                ExpressionDepthLimit = 1000000,
                LiquidFunctionsToScriban = true,
                ParseFloatAsDecimal = false,
            };

            var lexerOptions = new Scriban.Parsing.LexerOptions()
            {
                FrontMatterMarker = "---",
                KeepTrivia = true,
                Lang = lang,
                Mode = Scriban.Parsing.ScriptMode.Default,
                StartPosition = new Scriban.Parsing.TextPosition(0, 0, 0),
            };

            var template = Template.Parse(source, path, parserOptions, lexerOptions);

            var context = new TemplateContext()
            {
                TemplateLoader = loader,
                LoopLimit = 1000000,
                LoopLimitQueryable = 1000000,
            };

            context.PushSourceFile(path);

            foreach (var obj in objs)
            {
                context.PushGlobal(obj);
            }

            return template.Render(context);
        }
    }
}
